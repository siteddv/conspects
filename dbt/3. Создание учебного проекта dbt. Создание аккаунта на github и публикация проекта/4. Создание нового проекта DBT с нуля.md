### üü¢ **–ß–∞—Å—Ç—å 4: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ DBT —Å –Ω—É–ª—è (7:00 - 12:00)**

---

#### üîπ **1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ DBT**

- **–ö–æ–º–∞–Ω–¥–∞:** `dbt init <–∏–º—è_–ø—Ä–æ–µ–∫—Ç–∞>`.
    - **–ü—Ä–∏–º–µ—Ä:** `dbt init dbt_course_practice`.
- **–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π DBT-–ø—Ä–æ–µ–∫—Ç —Å —á–∏—Å—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º.
- **–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã:**
    - –°–æ–∑–¥–∞—ë—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –∏ —Ñ–∞–π–ª–æ–≤:
        - –ü–∞–ø–∫–∏: `models`, `macros`, `seeds`, `snapshots`, `tests`, `analysis`.
        - –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: `dbt_project.yml` –∏ `profiles.yml`.
    - –í—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Å–∫–∞–∑–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: `Run dbt debug to validate the connection`.

---

#### üîπ **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**

- **–ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥—ã:** `dbt debug` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.
- **–û—à–∏–±–∫–∞:** –ï—Å–ª–∏ –ë–î –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:
    - `Connection to Service Local Host –±—ã–ª –Ω–µ—É—Å–ø–µ—à–Ω—ã–π –ø–æ—Ç–æ–º—É —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç`.
- **–†–µ—à–µ–Ω–∏–µ:**
    1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ DBeaver).
    2. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î:**
        - –ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –ø–æ —Å–ø–∏—Å–∫—É –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö ‚Üí `–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î`.
        - –ò–º—è: `dwh_flights` (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º).
    3. –ü–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å `dbt debug` ‚Äî —É—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ.

---

#### üîπ **3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–∞ `profiles.yml`**

- **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `~/.dbt/profiles.yml` (–¥–æ–º–∞—à–Ω—è—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è).
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
    
    ```yaml
    dbt_course_practice:
      target: dev
      outputs:
        dev:
          type: postgres
          host: localhost
          user: postgres
          password: <–ø–∞—Ä–æ–ª—å>
          port: 5432
          dbname: dwh_flights
          schema: intermediate
          threads: 4
    ```
    
- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
    - `type`: –¢–∏–ø –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, `postgres`).
    - `host`: –°–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, `localhost`).
    - `user` –∏ `password`: –î–∞–Ω–Ω—ã–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
    - `port`: –ü–æ—Ä—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (`5432` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ Postgres).
    - `schema`: –°—Ö–µ–º–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π (`intermediate`).
    - `threads`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 2-4 –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–æ—â–Ω–æ—Å—Ç–∏ –ü–ö).
- **–ó–∞–º–µ—á–∞–Ω–∏–µ:**
    - `profiles.yml` –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ Git –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–æ–ª–∏).
    - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π.

---

#### üîπ **4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –∏–∑ DBT**

- **–ö–æ–º–∞–Ω–¥–∞:** `dbt debug`.
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
    - –ï—Å–ª–∏ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω—ã, –ø—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.
    - –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:
        - –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∞—è –ë–î.
        - –û—à–∏–±–∫–∏ –≤ `profiles.yml` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–æ—Ä—Ç –∏–ª–∏ schema).

---

#### üîπ **5. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**

- **–§–∞–π–ª `dbt_project.yml`:**
    - –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª DBT-–ø—Ä–æ–µ–∫—Ç–∞.
    - –°–æ–¥–µ—Ä–∂–∏—Ç:
        - `name`: –ò–º—è –ø—Ä–æ–µ–∫—Ç–∞ (`dbt_course_practice`).
        - `profile`: –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å –≤ `profiles.yml`.
        - –ü—É—Ç–∏ –∫ –ø–∞–ø–∫–∞–º (`models`, `macros`, `seeds` –∏ —Ç.–¥.).
        - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π.
- **–§–∞–π–ª `README.md`:**
    - –î–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –µ–≥–æ —Ü–µ–ª–µ–π.
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–ø–∏—Å–∞—Ç—å:
        - –°—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î.
        - –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞.
        - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

---

#### üîπ **6. –ü–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ DBT**

- **–ö–æ–º–∞–Ω–¥–∞:** `dbt build`.
- **–¶–µ–ª—å:** –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å SQL-–º–æ–¥–µ–ª–∏ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏—Ö –≤ –ë–î.
- **–û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ:**
    - –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Ç–µ—Å—Ç—ã —Å –æ—à–∏–±–∫–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `not null`), –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö.
- **–ü—Ä–∏–º–µ—Ä –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
    - –í –ø–∞–ø–∫–µ `models/example`:
        - –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ `not null` –≤ —Ñ–∞–π–ª–∞—Ö `schema.yml`.
    - –£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É `example`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤ –±—É–¥—É—â–µ–º.

---

#### üîπ **7. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ –ë–î**

- **–°—Ö–µ–º–∞ `intermediate`:**
    - –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö DBT.
- **–î—Ä—É–≥–∏–µ —Å—Ö–µ–º—ã:**
    - `staging` ‚Äî –¥–ª—è –¥–∞–Ω–Ω—ã—Ö, –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
    - `mart` ‚Äî –¥–ª—è –≤–∏—Ç—Ä–∏–Ω –¥–∞–Ω–Ω—ã—Ö, –≥–æ—Ç–æ–≤—ã—Ö –∫ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ.

---

#### üîπ **8. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ç–æ–∫–æ–≤:**
    - `threads` –≤ `profiles.yml`:
        - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 2-4 –ø–æ—Ç–æ–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–æ—â–Ω–æ—Å—Ç–∏ –ü–ö.
    - –ë–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–æ–¥–µ–ª–∏.
- **–õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î:**
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `localhost` —É—Å–∫–æ—Ä—è–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä–∫—É.

---

### üü¢ **–ò—Ç–æ–≥–∏ —á–∞—Å—Ç–∏ 4:**

- **–ü–æ–Ω—è–ª–∏:** –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç DBT.
- **–ù–∞—É—á–∏–ª–∏—Å—å:** –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Postgres —á–µ—Ä–µ–∑ `profiles.yml`.
- **–ü—Ä–æ–≤–µ—Ä–∏–ª–∏:** –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –ø–µ—Ä–≤–æ–π —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.

---

–ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å **—á–∞—Å—Ç—å—é 5**? üòé