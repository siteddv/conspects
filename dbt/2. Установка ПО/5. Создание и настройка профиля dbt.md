# üü¢ [[–°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è dbt]]

### üîπ **1. –ß—Ç–æ —Ç–∞–∫–æ–µ `profiles.yml` –∏ –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω**

- **`profiles.yml`** ‚Äî —ç—Ç–æ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è dbt –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
    
    ```bash
    ~/.dbt/profiles.yml
    ```
    
- **–ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —Ö—Ä–∞–Ω–∏—Ç—å –≤ Git:**
    - –°–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å).
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–ª—è—Ç—å –≤ `.gitignore`.

---

### üîπ **2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ `profiles.yml`**

#### üìÑ **–¢–∏–ø–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```yaml
dbt_project:
  target: dev
  outputs:
    dev:
      type: postgres
      host: localhost
      user: pguser
      password: pgpassword
      port: 5432
      dbname: dbt_db
      schema: public
      threads: 4
      keepalives_idle: 0
    prod:
      type: postgres
      host: prod-db.example.com
      user: produser
      password: prodpassword
      port: 5432
      dbname: prod_db
      schema: public
      threads: 8
```

#### üîç **–ü–æ—è—Å–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**

- **`target:`**
    - –£–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (`dev` –∏–ª–∏ `prod`).
- **`type:`**
    - –¢–∏–ø –°–£–ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, `postgres`, `bigquery`, `clickhouse`).
- **`host:` –∏ `port:`**
    - –ê–¥—Ä–µ—Å –∏ –ø–æ—Ä—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
- **`user:` –∏ `password:`**
    - –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- **`schema:`**
    - –°—Ö–µ–º–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –º–æ–¥–µ–ª–∏ dbt.
- **`threads:`**
    - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤.

---

### üîπ **3. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `profiles.yml`**

#### üõ†Ô∏è **–®–∞–≥–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:**

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–æ–º–∞—à–Ω—é—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:
    
    ```bash
    cd ~
    ```
    
2. –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É `.dbt`, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç:
    
    ```bash
    mkdir -p .dbt
    ```
    
3. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `profiles.yml`:
    
    ```bash
    nano .dbt/profiles.yml
    ```
    

---

### üîπ **4. –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –°–£–ë–î**

#### üìÑ **PostgreSQL:**

```yaml
dbt_project:
  target: dev
  outputs:
    dev:
      type: postgres
      host: localhost
      user: pguser
      password: pgpassword
      port: 5432
      dbname: dbt_db
      schema: public
```

#### üìÑ **ClickHouse:**

```yaml
dbt_project:
  target: dev
  outputs:
    dev:
      type: clickhouse
      host: localhost
      user: default
      password: ''
      port: 8123
      schema: default
```

#### üìÑ **BigQuery:**

```yaml
dbt_project:
  target: dev
  outputs:
    dev:
      type: bigquery
      method: oauth
      project: my_project
      dataset: my_dataset
      threads: 4
```

---

### üîπ **5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ `profiles.yml`**

#### üõ†Ô∏è **–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**

```bash
dbt debug
```

- **–¢–∏–ø–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**
    - üü¢ **SUCCESS:** –ï—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–µ—Ä–Ω–∞.
    - üî¥ **ERROR:** –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∏–ª–∏ –¥–æ—Å—Ç—É–ø–µ.

#### üõ†Ô∏è **–ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫ –∏ —Ä–µ—à–µ–Ω–∏—è:**

- **–û—à–∏–±–∫–∞: `Invalid profile specified.`**
    - **–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∞ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –∏–ª–∏ —Ñ–∞–π–ª–∞.
    - **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–º–µ–Ω–∏ –ø—Ä–æ–µ–∫—Ç–∞ –≤ `dbt_project.yml` –∏ `profiles.yml`.
- **–û—à–∏–±–∫–∞: `Connection refused` –∏–ª–∏ `FATAL: password authentication failed`**
    - **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Ö–æ—Å—Ç.
    - **–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å `user`, `password` –∏ `host`.

---

### üîπ **6. –•—Ä–∞–Ω–µ–Ω–∏–µ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**

#### üì¶ **–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**

- –ò–∑–±–µ–≥–∞–µ—Ç —É—Ç–µ—á–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
- –£–ø—Ä–æ—â–∞–µ—Ç –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω.

#### üõ†Ô∏è **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```yaml
dbt_project:
  target: dev
  outputs:
    dev:
      type: postgres
      host: localhost
      user: "{{ env_var('DB_USER') }}"
      password: "{{ env_var('DB_PASSWORD') }}"
      dbname: dbt_db
```

#### üõ†Ô∏è **–ö–∞–∫ –∑–∞–¥–∞–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**

- **Linux / macOS:**
    
    ```bash
    export DB_USER=pguser
    export DB_PASSWORD=pgpassword
    ```
    
- **Windows (PowerShell):**
    
    ```bash
    $env:DB_USER="pguser"
    $env:DB_PASSWORD="pgpassword"
    ```
    

---

### üîπ **7. –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

#### üì¶ **–§–∞–π–ª `.env` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:**

```bash
DB_USER=pguser
DB_PASSWORD=pgpassword
```

#### üõ†Ô∏è **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ `.env` —á–µ—Ä–µ–∑ `dotenv` –≤ dbt:**

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç:
    
    ```bash
    pip install python-dotenv
    ```
    
2. –û–±–Ω–æ–≤–∏—Ç—å `profiles.yml`:
    
    ```yaml
    user: "{{ env_var('DB_USER') }}"
    password: "{{ env_var('DB_PASSWORD') }}"
    ```
    

---

### üîπ **8. –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å `profiles.yml`**

#### ‚ùå **–û—à–∏–±–∫–∞: `No profile named 'dbt_project' found.`**

- **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–º—è –ø—Ä–æ—Ñ–∏–ª—è –∏–ª–∏ –ø—É—Ç—å.
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è –ø—Ä–æ—Ñ–∏–ª—è –≤ `dbt_project.yml`:
    
    ```yaml
    profile: dbt_project
    ```
    

#### ‚ùå **–û—à–∏–±–∫–∞: `dbt debug` –Ω–µ –≤–∏–¥–∏—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.**

- **–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –±–∞–∑–æ–π –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
    
    ```bash
    docker ps
    ```
    

---

### üîπ **9. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–æ—Ñ–∏–ª–µ–π**

- **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π (`dev`, `test`, `prod`).**
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ –ø–∞—Ä–æ–ª–µ–π.**
- **–†–µ–≥—É–ª—è—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ `dbt debug` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.**

---

### üîπ **10. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ dbt –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**

#### üõ†Ô∏è **–ö–æ–º–∞–Ω–¥–∞:**

```bash
dbt debug
```

- **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
    - üü¢ **All checks passed!** ‚Äî –í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ.
    - üî¥ **Check failed:** ‚Äî –ï—Å—Ç—å –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å.

---

### üîπ **11. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è dbt —Å CI/CD**

#### üì¶ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GitHub Actions:**

- **–§–∞–π–ª `.github/workflows/dbt.yml`:**
    
    ```yaml
    name: CI for dbt
    on:
      push:
        branches: [main]
    jobs:
      build:
        runs-on: ubuntu-latest
        steps:
          - name: Checkout code
            uses: actions/checkout@v2
          - name: Set up Python
            uses: actions/setup-python@v2
            with:
              python-version: '3.9'
          - name: Install dbt
            run: |
              pip install dbt-postgres
          - name: Run dbt debug
            run: dbt debug
    ```
    
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º `push` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

---

### üìå **–ò—Ç–æ–≥–∏ –ø—è—Ç–æ–π —á–∞—Å—Ç–∏:**

- –°–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ñ–∞–π–ª `profiles.yml` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
- –ò–∑—É—á–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –°–£–ë–î.
- –û—Å–≤–æ–µ–Ω—ã —Å–ø–æ—Å–æ–±—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.

---

–ì–æ—Ç–æ–≤ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏: **[[–°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ dbt]]**? üòä