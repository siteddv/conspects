# üü¢ [[–°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ dbt]]

### üîπ **1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ dbt-–ø—Ä–æ–µ–∫—Ç–∞**

#### üì¶ **–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞:**

- **–ö–æ–º–∞–Ω–¥–∞:**
    
    ```bash
    dbt init my_dbt_project
    ```
    
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
    - –°–æ–∑–¥–∞—ë—Ç—Å—è –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –ø–∞–ø–∫–∞–º–∏:
        - `models/` ‚Äî SQL –º–æ–¥–µ–ª–∏.
        - `snapshots/` ‚Äî —Å–Ω–∞–ø—à–æ—Ç—ã —Ç–∞–±–ª–∏—Ü.
        - `macros/` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–∞–∫—Ä–æ—Å—ã –Ω–∞ Jinja.
        - `tests/` ‚Äî —Ç–µ—Å—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–µ–π –∏ –¥–∞–Ω–Ω—ã—Ö.
    - –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
        - `dbt_project.yml` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–æ–µ–∫—Ç–∞.
        - `packages.yml` ‚Äî —Å–ø–∏—Å–æ–∫ –≤–Ω–µ—à–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

---

### üîπ **2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–∞ `dbt_project.yml`**

#### üìÑ **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**

```yaml
name: my_dbt_project
version: 1.0.0
profile: dbt_project
config-version: 2

vars:
  environment: dev

models:
  my_dbt_project:
    +schema: public
    +materialized: view
```

#### üîç **–ü–æ—è—Å–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**

- **`name:`** ‚Äî –∏–º—è –ø—Ä–æ–µ–∫—Ç–∞ (–¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –≤ `profiles.yml`).
- **`profile:`** ‚Äî –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ (–∏–∑ `profiles.yml`).
- **`materialized:`** ‚Äî –∫–∞–∫ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –º–æ–¥–µ–ª–∏ (—Ç–∞–±–ª–∏—Ü—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ).
- **`vars:`** ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –º–∞–∫—Ä–æ—Å–æ–≤ –∏ –º–æ–¥–µ–ª–µ–π.

---

### üîπ **3. –°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–µ–π dbt**

#### üõ†Ô∏è **–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏:**

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É `models`:
    
    ```bash
    cd models
    ```
    
2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `my_first_model.sql`:
    
    ```sql
    -- models/my_first_model.sql
    select *
    from {{ ref('source_table') }}
    ```
    

#### üìÑ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–¥–∞:**

- **`ref('source_table')`** ‚Äî —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –º–æ–¥–µ–ª—å –∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É.
- **`select *`** ‚Äî –±–∞–∑–æ–≤—ã–π SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω dbt.

---

### üîπ **4. –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞: –∫–æ–º–∞–Ω–¥–∞ `dbt build`**

#### üõ†Ô∏è **–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å–±–æ—Ä–∫–∏:**

```bash
dbt build
```

- **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
    - –°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç `dbt run` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π.
    - –ó–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã (`dbt test`).
    - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–Ω–∞–ø—à–æ—Ç—ã (`dbt snapshot`).
    - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (`dbt docs generate`).

#### üîç **–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

- **–û—à–∏–±–∫–∞: `Profile not found.`**
    - **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø—Ä–æ—Ñ–∏–ª—è –≤ `dbt_project.yml`.
    - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å `profile:` –≤ –∫–æ–Ω—Ñ–∏–≥–µ.

---

### üîπ **5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π dbt**

#### üõ†Ô∏è **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤:**

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É `tests` –∏ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `my_test.yml`:
    
    ```yaml
    version: 2
    
    models:
      - name: my_first_model
        tests:
          - unique:
              column_name: id
          - not_null:
              column_name: id
    ```
    

#### üîç **–ü–æ—è—Å–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**

- **`unique:`** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ.
- **`not_null:`** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ `NULL`.
- **`version: 2`** ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤ –≤ dbt.

---

### üîπ **6. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤: –∫–æ–º–∞–Ω–¥–∞ `dbt test`**

#### üõ†Ô∏è **–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

```bash
dbt test
```

- **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
    - üü¢ **PASS:** –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ.
    - üî¥ **FAIL:** –¢–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—à–ª–∏ ‚Äî –±—É–¥–µ—Ç —É–∫–∞–∑–∞–Ω —Å—Ç–æ–ª–±–µ—Ü –∏ —Å—Ç—Ä–æ–∫–∞ —Å –æ—à–∏–±–∫–æ–π.

#### üìä **–û—Ç—á—ë—Ç –ø–æ —Ç–µ—Å—Ç–∞–º:**

- **–§–∞–π–ª—ã —Å –ª–æ–≥–∞–º–∏:**
    - `target/run_results.json` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤.
    - `target/manifest.json` ‚Äî –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞.

---

### üîπ **7. –¢–∏–ø—ã –º–æ–¥–µ–ª–µ–π –≤ dbt: —Ç–∞–±–ª–∏—Ü—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏**

#### üì¶ **–¢–∏–ø—ã –º–æ–¥–µ–ª–µ–π:**

- **`view` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
    - –•—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ SQL-–∑–∞–ø—Ä–æ—Å, –¥–∞–Ω–Ω—ã–µ –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è.
- **`table:`**
    
    ```yaml
    +materialized: table
    ```
    
    - –•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏, –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–∏ –∫–∞–∂–¥–æ–º `dbt run`.
- **`incremental:`**
    
    ```yaml
    +materialized: incremental
    ```
    
    - –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —É—Å–ª–æ–≤–∏—é `unique_key`.

---

### üîπ **8. –ü—Ä–∏–º–µ—Ä –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏**

#### üìÑ **–§–∞–π–ª `models/incremental_model.sql`:**

```sql
{{ config(
    materialized='incremental',
    unique_key='id'
) }}

select *
from source_table
where updated_at > (select max(updated_at) from {{ this }})
```

#### üîç **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

- **`unique_key:`** ‚Äî –∫–ª—é—á –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫.
- **`{{ this }}`** ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ç–µ–∫—É—â—É—é –º–æ–¥–µ–ª—å.
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ë—ã—Å—Ç—Ä–µ–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π.

---

### üîπ **9. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–µ–π –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: `dbt docs`**

#### üõ†Ô∏è **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**

```bash
dbt docs generate
```

- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∑–¥–∞—ë—Ç `index.html` –≤ –ø–∞–ø–∫–µ `target/` —Å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–æ–¥–µ–ª–µ–π.

#### üõ†Ô∏è **–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**

```bash
dbt docs serve
```

- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ö–µ–º –∏ —Å–≤—è–∑–µ–π.

---

### üîπ **10. –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞**

- **–û—à–∏–±–∫–∞: `ref` –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –º–æ–¥–µ–ª—å.**
    
    - **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π –ø—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `dbt build`.
    - **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç–∏ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `dbt run`.
- **–û—à–∏–±–∫–∞: `unique` –∏–ª–∏ `not_null` —Ç–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω.**
    
    - **–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –±–∞–∑–µ.
    - **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –ø–æ—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ.

---

### üîπ **11. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ dbt-–ø—Ä–æ–µ–∫—Ç–∞–º**

- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `incremental` –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü.**
- **–†–∞–∑–¥–µ–ª—è–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–¥–º–æ–¥–µ–ª–∏.**
- **–†–µ–≥—É–ª—è—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ `dbt clean` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞:**
    
    ```bash
    dbt clean
    ```
    

---

### üîπ **12. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ: –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**

#### üõ†Ô∏è **–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

```bash
dbt run --models incremental_model
```

- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.
- **–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
    - **–û—à–∏–±–∫–∞: `primary key` –Ω–∞—Ä—É—à–µ–Ω.**
        - **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å `unique_key`.

---

### üìå **–ò—Ç–æ–≥–∏ —à–µ—Å—Ç–æ–π —á–∞—Å—Ç–∏:**

- –°–æ–∑–¥–∞–Ω –∏ —Å–æ–±—Ä–∞–Ω dbt-–ø—Ä–æ–µ–∫—Ç —Å –º–æ–¥–µ–ª—è–º–∏ –∏ —Ç–µ—Å—Ç–∞–º–∏.
- –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Ç–µ—Å—Ç—ã –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∏ `not_null`.
- –ò–∑—É—á–µ–Ω—ã –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ —Å–ø–æ—Å–æ–±—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

---

–ì–æ—Ç–æ–≤ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏: **[[–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞–∫—Ä–æ—Å–æ–≤ –≤ dbt]]**? üòä