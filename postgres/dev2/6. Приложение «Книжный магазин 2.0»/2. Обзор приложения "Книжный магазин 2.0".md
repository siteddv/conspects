### Часть 2: Обзор приложения "Книжный магазин 2.0" (3:25 - 13:39)

#### Основные изменения по сравнению с версией 1.0:
1. **Расширение функционала**:
   - Увеличение аудитории, количества книг и покупателей.
   - Добавление новых возможностей для интернет-магазина и админки.

2. **Новые возможности интернет-магазина**:
   - **Поиск книг**: Пользователи могут искать книги по различным параметрам, включая название, авторов и аннотации.
     - Пример: Поиск книг по запросу "базы данных" находит как книги с точным совпадением названия, так и связанные материалы.
   - **Детальная информация о книгах**:
     - Обложка, рейтинг (звёзды), количество страниц, формат издания, стоимость.
     - Возможность голосования за книгу (увеличение или уменьшение рейтинга).
   - **Корзина**:
     - Регистрация обязательна для использования корзины.
     - Пользователи могут добавлять книги в корзину, изменять количество, удалять книги и совершать покупки.
   - **Сортировка**:
     - Книги можно сортировать по цене (по возрастанию или убыванию).

3. **Функционал админки**:
   - **Заказ книг у поставщиков**:
     - Возможность заказывать дополнительные экземпляры книг.
     - Указание отпускной цены от поставщика.
   - **Установка розничной цены**:
     - Администратор может устанавливать розничную цену на книги.
     - Цена может меняться с течением времени, что реализовано через интервалы действия цен.
   - **Фоновые задачи**:
     - Возможность запускать длительные задачи (например, генерация отчётов) и проверять их результаты позже.
     - Пример: Задача "Приветствие" успешно выполняется и возвращает результаты.

4. **Интерфейс приложения**:
   - **Информационная панель**:
     - Отображает вызываемые функции, параметры, время выполнения запросов и взаимодействие с базой данных.
     - Время выполнения состоит из двух частей:
       - Время отклика базы данных.
       - Общее время, включающее работу приложения.
   - **Подключение к базе данных**:
     - Приложение подключается к основному серверу PostgreSQL через порт `5432`.
     - В дальнейшем будет использоваться пул соединений по умолчанию.
   - **Трассировка**:
     - Возможность включения трассировки для пользователей.

#### Особенности реализации:
1. **Поиск с учётом морфологии**:
   - Поиск учитывает различные формы слов (например, "базы данных" находит книги с названием "основы базу данных").
   - Это достигается через использование текстового поиска с учётом морфологии.

2. **Голосование за книги**:
   - Пользователи могут увеличивать или уменьшать рейтинг книги.
   - Голоса сохраняются в базе данных и влияют на общий рейтинг.

3. **Асинхронная загрузка обложек**:
   - Для оптимизации производительности обложки книг загружаются асинхронно после отображения списка книг.

4. **Ограничения корзины**:
   - Корзина доступна только зарегистрированным пользователям.
   - Каждое действие с корзиной (добавление, удаление, покупка) выполняется в отдельной транзакции.
   - Проверка наличия книг на складе происходит только в момент покупки.

#### Пример работы с приложением:
1. **Регистрация и вход**:
   - Пользователь регистрируется через функцию `register_user`, передавая имя и адрес электронной почты.
   - После регистрации пользователь может войти в систему через функцию `login`, которая создаёт сеанс с уникальным токеном.
   - Токен используется для всех последующих действий, требующих аутентификации.

2. **Добавление книг в корзину**:
   - Пользователь может добавить книгу в корзину через функцию `add_to_cart`, указывая идентификатор книги и количество.
   - Если книга уже есть в корзине, количество обновляется.

3. **Покупка книг**:
   - Функция `checkout` проверяет наличие книг на складе и выполняет покупку.
   - Если каких-то книг недостаточно, транзакция откатывается, и покупка не завершается.

4. **Фоновые задачи**:
   - Администратор может запускать фоновые задачи через функцию `run_program`.
   - Статус выполнения задачи можно проверить через функцию `get_task_result`.

---

### Подготовка к следующей части:
В следующей части мы рассмотрим схему данных приложения, включая ER-диаграмму, структуру таблиц и их взаимосвязи. Хотите продолжить?