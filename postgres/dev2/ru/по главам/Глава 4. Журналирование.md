# Глава 4. Журналирование

## Содержание

- [[1. Буферный кэш]] [1. Буферный кэш](../полный/4. Журналирование/1. Буферный кэш.md)
- [[2. Работа с буферным кэшем]] [2. Работа с буферным кэшем](../полный/4. Журналирование/2. Работа с буферным кэшем.md)
- [[3. Временные таблицы]] [3. Временные таблицы](../полный/4. Журналирование/3. Временные таблицы.md)
- [[4. Журнал предзаписи (WAL)]] [4. Журнал предзаписи (WAL)](../полный/4. Журналирование/4. Журнал предзаписи (WAL).md)
- [[5. Восстановление после сбоя]] [5. Восстановление после сбоя](../полный/4. Журналирование/5. Восстановление после сбоя.md)
- [[6. Режимы журналирования]] [6. Режимы журналирования](../полный/4. Журналирование/6. Режимы журналирования.md)
- [[7. Практическая часть]] [7. Практическая часть](../полный/4. Журналирование/7. Практическая часть.md)

---

## Буферный кэш

Буферный кэш представляет собой область оперативной памяти, где хранятся страницы данных. Страницы читаются с диска в буферный кэш без преобразования. Это позволяет значительно сократить количество прямых обращений к дисковой подсистеме, что критически важно из-за существенной разницы в скорости доступа между оперативной памятью и дисками.

Механизм работы буферного кэша: при поступлении пользовательского запроса система сначала проверяет наличие нужных данных в собственном кэше PostgreSQL. Если данные отсутствуют, происходит обращение к кэшу операционной системы, и только при их отсутствии выполняется чтение с диска.

## Журнал предзаписи (WAL)

Журнал предзаписи (WAL) является критически важным компонентом системы, обеспечивающим надежность хранения данных. Его основной принцип заключается в том, что любые изменения данных сначала фиксируются в WAL, и только потом применяются к самим данным в буферном кэше.

Работа WAL организована таким образом, что в журнал записываются не сами измененные страницы, а инструкции, описывающие произведенные изменения. При восстановлении после сбоя система последовательно применяет записи WAL, восстанавливая согласованное состояние базы данных.

## Восстановление после сбоя

Если PostgreSQL внезапно завершился (сбой ОС, перезагрузка), при запуске он читает WAL-файлы, повторяет незавершенные операции и гарантирует, что данные останутся целыми. Это обеспечивает надежность данных даже при аварийном завершении работы системы.

## Режимы журналирования

PostgreSQL предоставляет гибкие возможности настройки режимов записи данных: синхронная запись (synchronous commit) обеспечивает максимальную надежность, но снижает скорость работы; асинхронная запись ускоряет работу, но создает риск потери данных при сбое.

**Подробнее:** [[4. Журналирование]] [4. Журналирование](../полный/4. Журналирование/1. Буферный кэш.md)

