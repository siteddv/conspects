### Часть 1: Введение в работу с большими объектами

#### 1. Обзор типов данных в приложениях
- **Основные типы данных**: В большинстве приложений используются относительно короткие типы данных:
  - Числа
  - Строки (десятки или сотни символов)
  - Даты
  - Логические типы

#### 2. Необходимость работы с большими объектами
- **Примеры больших объектов**:
  - Файлы различных типов (картинки, видео, мультимедиа)
  - Большие документы (PDF и т.д.)
- **Особенности**: Иногда возникает необходимость работать с большими объектами, которые значительно превышают стандартные размеры.

#### 3. Основные варианты хранения больших объектов
- **Хранение в файловой системе**:
  - **Принцип**: Файлы хранятся отдельно, а в базе данных используется ссылка на эти файлы.
  - **Преимущества**:
    - Быстрее, так как не используются механизмы WAL (Write-Ahead Logging) и буферный кэш.
    - Размер базы данных не увеличивается.
  - **Недостатки**:
    - Отсутствие транзакционной работы и управления доступом средствами СУБД.
    - Риск потери согласованности данных (например, запись файла без соответствующей ссылки в таблице).
    - Усложнение архитектуры системы (необходимость дополнительного резервного копирования файлов).

- **Хранение внутри базы данных**:
  - **Типы данных**:
    - **bytea**: Для двоичных данных.
    - **text**: Для символьных данных.
  - **Механизм TOAST**:
    - **Цель**: Хранение атрибутов большой длины, которые не помещаются на одной странице данных.
    - **Принцип работы**:
      - Создание служебной таблицы для хранения фрагментов длинных атрибутов.
      - Возможность сжатия данных перед выносом в служебную таблицу.
      - Ограничение размера данных: до 1 ГБ.
    - **Стратегии хранения**:
      - **extended**: Использует сжатие данных.
      - **main**: Переносится в последнюю очередь, также использует сжатие.
      - **external**: Без сжатия, подходит для уже сжатых данных.
      - **plain**: Только для столбцов фиксированной ширины, всегда остаются в основной таблице.

#### 4. Подсистема больших объектов (Large Objects)
- **Интерфейс**: Отдельный интерфейс для работы с большими объектами.
- **Преимущества**:
  - Размер значения может достигать 4 ТБ.
  - Возможность потокового чтения и записи отдельных фрагментов.
- **Недостатки**:
  - Увеличение размера базы данных.
  - Медленнее, чем работа с файловой системой.
  - Ограничение на общее количество больших объектов (идентификатор типа OID).

#### 5. Практические задания
- **Задачи**:
  - Добавление столбца для хранения изображений книг в таблицу `books`.
  - Создание функции `get_image` для получения изображения по идентификатору книги.
  - Сравнение скорости выполнения запросов с использованием `SELECT *` и выборочного запроса.
  - Эксперименты с изменением небольших фрагментов данных в столбце типа `bytea` и анализ влияния на буферный кэш.

Эта часть конспекта охватывает основные концепции и варианты хранения больших объектов, их преимущества и недостатки, а также практические задания для закрепления материала.