### **–ü–æ–¥—Ä–æ–±–Ω—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç –≤–∏–¥–µ–æ (–ß–∞—Å—Ç—å 4: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã –≤ PostgreSQL)**

---

## **1. –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –≤ PostgreSQL**

–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –æ–±—ä—è—Å–Ω—è–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å **—Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL**, —Å–ª–µ–¥—É—è –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏.

- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **bookstore**.
- –í –Ω–µ–π —Å–æ–∑–¥–∞—é—Ç—Å—è **—á–µ—Ç—ã—Ä–µ —Ç–∞–±–ª–∏—Ü—ã**:
    1. **–ö–Ω–∏–≥–∏ (Books)**
    2. **–ê–≤—Ç–æ—Ä—ã (Authors)**
    3. **–ê–≤—Ç–æ—Ä—Å—Ç–≤–æ (Authorship, —Å–≤—è–∑—å ¬´–º–Ω–æ–≥–∏–µ –∫–æ –º–Ω–æ–≥–∏–º¬ª)**
    4. **–û–ø–µ—Ä–∞—Ü–∏–∏ (Operations)**

–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è **–ø—É—Ç—å –ø–æ–∏—Å–∫–∞ —Å—Ö–µ–º—ã (search_path)**, —á—Ç–æ–±—ã –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –≤–Ω—É—Ç—Ä–∏ —Å—Ö–µ–º—ã **bookstore**.

üìå **–ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**:

```sql
SET search_path TO bookstore;
```

---

## **2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ PostgreSQL**

### üîπ **–¢–∞–±–ª–∏—Ü–∞ –∫–Ω–∏–≥ (Books)**

```sql
CREATE TABLE books (
    book_id SERIAL PRIMARY KEY,
    title TEXT NOT NULL
);
```

‚úÖ **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**:

- **book_id** ‚Äì –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è).
- **title** ‚Äì –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å NULL).
- **TEXT** –≤–º–µ—Å—Ç–æ VARCHAR, —Ç–∞–∫ –∫–∞–∫ PostgreSQL **–Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–ª–∏–Ω—É** –∏ —ç—Ç–æ –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ.

---

### üîπ **–¢–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ—Ä–æ–≤ (Authors)**

```sql
CREATE TABLE authors (
    author_id SERIAL PRIMARY KEY,
    last_name TEXT NOT NULL,
    first_name TEXT NOT NULL,
    middle_name TEXT
);
```

‚úÖ **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**:

- **last_name** –∏ **first_name** ‚Äì –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã.
- **middle_name** (–æ—Ç—á–µ—Å—Ç–≤–æ) ‚Äì –º–æ–∂–µ—Ç –±—ã—Ç—å NULL, —Ç–∞–∫ –∫–∞–∫ –Ω–µ —É –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –æ–Ω–æ –µ—Å—Ç—å.

---

### üîπ **–¢–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ—Ä—Å—Ç–≤–∞ (Authorship, —Å–≤—è–∑—å ¬´–º–Ω–æ–≥–∏–µ –∫–æ –º–Ω–æ–≥–∏–º¬ª)**

```sql
CREATE TABLE authorship (
    book_id INTEGER NOT NULL REFERENCES books(book_id) ON DELETE CASCADE,
    author_id INTEGER NOT NULL REFERENCES authors(author_id) ON DELETE CASCADE,
    author_order INTEGER NOT NULL,
    PRIMARY KEY (book_id, author_id)
);
```

‚úÖ **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**:

- **book_id** –∏ **author_id** ‚Äì —Å–æ—Å—Ç–∞–≤–Ω–æ–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á.
- **author_order** ‚Äì –ø–æ—Ä—è–¥–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤ (–µ—Å–ª–∏ –≤–∞–∂–Ω–æ, –∫—Ç–æ —É–∫–∞–∑–∞–Ω –ø–µ—Ä–≤—ã–º).
- **ON DELETE CASCADE** ‚Äì –µ—Å–ª–∏ —É–¥–∞–ª—è–µ—Ç—Å—è –∫–Ω–∏–≥–∞, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —Å–≤—è–∑–∏ —Å –∞–≤—Ç–æ—Ä–∞–º–∏.

---

### üîπ **–¢–∞–±–ª–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ü–∏–π (Operations)**

```sql
CREATE TABLE operations (
    operation_id SERIAL PRIMARY KEY,
    book_id INTEGER NOT NULL REFERENCES books(book_id) ON DELETE CASCADE,
    quantity_change INTEGER NOT NULL,
    operation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

‚úÖ **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**:

- **quantity_change** ‚Äì –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Å–∫–ª–∞–¥–µ (–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ ‚Üí +, –ø—Ä–æ–¥–∞–∂–∞ ‚Üí -).
- **operation_date** ‚Äì –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–µ–∫—É—â–µ–π –¥–∞—Ç–æ–π.
- **ON DELETE CASCADE** ‚Äì –µ—Å–ª–∏ —É–¥–∞–ª—è–µ—Ç—Å—è –∫–Ω–∏–≥–∞, –µ—ë –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∂–µ —É–¥–∞–ª—è—é—Ç—Å—è.

---

## **3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ (SEQUENCE –∏ SERIAL)**

–í PostgreSQL **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ ID** —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ **SEQUENCE**.

- –¢–∏–ø **SERIAL** ‚Äî —É–¥–æ–±–Ω–∞—è –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è **SEQUENCE**.
- –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã **SEQUENCE**:
    
    ```sql
    SELECT nextval('books_book_id_seq');
    ```
    
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ **–æ–±–Ω—É–ª–∏—Ç—å** –∏ –Ω–∞—á–∞—Ç—å –Ω—É–º–µ—Ä–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ:
    
    ```sql
    ALTER SEQUENCE books_book_id_seq RESTART WITH 1;
    ```
    

---

## **4. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤**

–ß—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –≤—ã–±–æ—Ä–∫–∏, —Å–æ–∑–¥–∞—é—Ç—Å—è **–∏–Ω–¥–µ–∫—Å—ã**.

### üîπ **–ü—Ä–æ—Å—Ç–æ–π –∏–Ω–¥–µ–∫—Å (–¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ñ–∞–º–∏–ª–∏–∏ –∞–≤—Ç–æ—Ä–∞)**

```sql
CREATE INDEX idx_authors_last_name ON authors(last_name);
```

üìå **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å**:

```sql
SELECT * FROM authors WHERE last_name = '–¢–æ–ª—Å—Ç–æ–π';
```

### üîπ **–°–ª–æ–∂–Ω—ã–π –∏–Ω–¥–µ–∫—Å (–∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π)**

```sql
CREATE INDEX idx_books_title_author ON books(title);
```

üìå **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∏—Å–∫ –∫–Ω–∏–≥ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é**.

---

## **5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã**

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–º–∞–Ω–¥–æ–π:

```sql
\d books
\d authors
\d authorship
\d operations
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```plaintext
         –¢–∞–±–ª–∏—Ü–∞ "bookstore.books"
 –ö–æ–ª–æ–Ω–∫–∞      |       –¢–∏–ø        | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
--------------+-----------------+-----------------
 book_id      | SERIAL          | PRIMARY KEY
 title        | TEXT NOT NULL   |
```

‚úÖ **–í—ã–≤–æ–¥**: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—é.

---

### **‚è≠ –°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å: –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º**

–ï—Å–ª–∏ –≤—Å—ë –æ–∫, –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç–≤–µ—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä—ë–º –ø—è—Ç—É—é —á–∞—Å—Ç—å: **–ö–∞–∫ –∫–ª–∏–µ–Ω—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –±–∞–∑–æ–π —á–µ—Ä–µ–∑ API, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (views) –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã**. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏, –∏ —è –ø—Ä–æ–¥–æ–ª–∂—É.