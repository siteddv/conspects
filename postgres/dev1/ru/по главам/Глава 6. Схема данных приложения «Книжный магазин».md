# Глава 6. Схема данных приложения «Книжный магазин»

## Содержание

- [[1. Введение и обзор проекта]] [1. Введение и обзор проекта](../полный/6. Схема данных приложения «Книжный магазин»/1. Введение и обзор проекта.md)
- [[2. Разработка схемы данных]] [2. Разработка схемы данных](../полный/6. Схема данных приложения «Книжный магазин»/2. Разработка схемы данных.md)
- [[3. Нормализация данных и построение схемы БД]] [3. Нормализация данных и построение схемы БД](../полный/6. Схема данных приложения «Книжный магазин»/3. Нормализация данных и построение схемы БД.md)
- [[4. Реализация схемы в PostgreSQL]] [4. Реализация схемы в PostgreSQL](../полный/6. Схема данных приложения «Книжный магазин»/4. Реализация схемы в PostgreSQL.md)
- [[5. Организация интерфейса между клиентом и сервером]] [5. Организация интерфейса между клиентом и сервером](../полный/6. Схема данных приложения «Книжный магазин»/5. Организация интерфейса между клиентом и сервером.md)
- [[6. Практическая часть. создание БД и объектов]] [6. Практическая часть. создание БД и объектов](../полный/6. Схема данных приложения «Книжный магазин»/6. Практическая часть. создание БД и объектов.md)

---

## Введение и обзор проекта

Курс начинается с изучения структуры данных для проекта «Книжный магазин» и организации интерфейса между клиентской и серверной частями. Приложение состоит из двух основных компонентов: клиентская часть (магазина) — пользовательский интерфейс для поиска и покупки книг, и административный интерфейс — инструменты для управления книгами, авторами и складскими запасами.

Клиентская часть содержит строку поиска, позволяющую искать книги по автору, названию или наличию на складе. У каждой книги есть кнопка «Купить», которая сразу списывает книгу со склада. Административный интерфейс предоставляет функции просмотра и редактирования списка авторов, добавления новых книг с указанием авторов и управления каталогом и складскими запасами.

## Разработка схемы данных

После демонстрации функционала приложения переходим к проектированию схемы данных. База данных должна поддерживать работу приложения, обеспечивая структурированное хранение информации. Для этого используется модель «Сущность-Связь» (Entity-Relationship, ER).

ER-модель помогает графически представить структуру базы данных, состоящую из сущностей и связей между ними. Основные элементы модели: сущности (основные объекты предметной области, например, «Книга», «Автор»), атрибуты (свойства сущностей, например, название книги, имя автора) и связи (отношения между сущностями, например, «Книга» может быть написана несколькими «Авторами»).

Нельзя использовать одну таблицу для всех данных, так как это вызывает дублирование данных, неэффективность обновления и трудности с уникальностью авторов.

## Нормализация данных и построение схемы БД

Цель нормализации — устранить избыточность данных и избежать проблем с целостностью. Вместо одной таблицы с дублирующимися данными лучше создать несколько связанных таблиц.

Шаг 1: Отделение операций от книг. Операции (покупка, поступление) выделяются в отдельную таблицу, а в таблице книг остаются только название и авторы. Связь «Один-ко-многим»: одна книга может участвовать в нескольких операциях, каждая операция относится только к одной книге.

Шаг 2: Отделение авторов. Авторы выделяются в отдельную таблицу. Связь «Многие-ко-многим»: одна книга может иметь несколько авторов, один автор может написать несколько книг. Для хранения таких связей создается промежуточная таблица.

Итоговая структура базы данных включает четыре таблицы: Книги (Books) — содержит названия книг, Авторы (Authors) — список авторов с ФИО, Авторство (Authorship) — связывает книги и авторов (многие ко многим) и Операции (Operations) — хранит покупки и поступления книг.

## Реализация схемы в PostgreSQL

База данных называется `bookstore`. В ней создаются четыре таблицы: Книги (Books), Авторы (Authors), Авторство (Authorship) и Операции (Operations). Перед созданием таблиц настраивается путь поиска схемы (search_path), чтобы все объекты находились внутри схемы `bookstore`.

В PostgreSQL автоматическое увеличение ID реализуется через SEQUENCE. Тип SERIAL — удобная обёртка для SEQUENCE. Чтобы ускорить выборки, создаются индексы на часто используемых полях.

## Организация интерфейса между клиентом и сервером

Существуют два основных подхода к организации взаимодействия: прямой доступ к таблицам (клиентское приложение самостоятельно делает SQL-запросы к таблицам) и API на стороне базы данных (клиент использует представления (views), функции и триггеры).

Использование представлений (Views) для клиентского интерфейса позволяет клиенту получать данные без прямого доступа к таблицам. Представления могут объединять данные из нескольких таблиц, скрывая сложность структуры базы данных от клиента.

**Подробнее:** [[6. Схема данных приложения «Книжный магазин»]] [6. Схема данных приложения «Книжный магазин»](../полный/6. Схема данных приложения «Книжный магазин»/резюме.md)

