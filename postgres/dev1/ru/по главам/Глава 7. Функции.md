# Глава 7. Функции

## Содержание

- [[1. Введение в тему функций]] [1. Введение в тему функций](../полный/7.  Функции/1. Введение в тему функций.md)
- [[2. Определение функций в SQL (на примере PostgreSQL)]] [2. Определение функций в SQL (на примере PostgreSQL)](../полный/7.  Функции/2. Определение функций в SQL (на примере PostgreSQL).md)
- [[3. Параметры функций и их использование]] [3. Параметры функций и их использование](../полный/7.  Функции/3. Параметры функций и их использование.md)
- [[4. Категории изменчивости функций (Volatility Categories)]] [4. Категории изменчивости функций (Volatility Categories)](../полный/7.  Функции/4. Категории изменчивости функций (Volatility Categories).md)
- [[5. Оптимизация выполнения запросов с учетом категорий изменчивости]] [5. Оптимизация выполнения запросов с учетом категорий изменчивости](../полный/7.  Функции/5. Оптимизация выполнения запросов с учетом категорий изменчивости.md)
- [[6. Практические задания]] [6. Практические задания](../полный/7.  Функции/6. Практические задания.md)

---

## Введение в функции

Функции являются одной из ключевых концепций в работе с базами данных. В контексте PostgreSQL функции представляют собой мощный инструмент для организации кода и реализации бизнес-логики на стороне сервера.

Функция в PostgreSQL характеризуется несколькими ключевыми элементами: имя функции (уникальный идентификатор), набор параметров (входных и выходных), возвращаемое значение и тело функции, содержащее логику выполнения.

Особенности функций на стороне сервера: возможность инкапсулировать бизнес-логику, снижение накладных расходов при повторяющихся операциях, улучшение читаемости SQL-запросов, сокрытие сложных вычислений за интерфейсом функции, возможность изменения состояния базы данных и динамическое поведение, зависящее от данных в таблицах.

## Категории изменчивости функций

PostgreSQL различает три категории изменчивости функций:

VOLATILE (изменяемые): могут возвращать разные значения при одинаковых входных данных, зависят от изменяемых данных, времени, случайных чисел, выполняются каждый раз заново. Пример: `random()`, `now()`.

STABLE (стабильные): не изменяют данные в базе, могут считывать данные, результат стабилен в рамках одного SQL-запроса. Пример: `COUNT(*)`.

IMMUTABLE (неизменяемые): всегда возвращают одинаковый результат для одинаковых входных данных, не зависят от данных в базе, могут быть вычислены заранее. Пример: математические операции.

## Создание и использование функций

Создание функций осуществляется через `CREATE FUNCTION`. Функции могут иметь входные параметры (IN), выходные параметры (OUT) и двунаправленные параметры (INOUT). Параметры по умолчанию — входные (IN).

Оптимизация выполнения запросов с учетом категорий изменчивости позволяет планировщику запросов принимать более эффективные решения о том, когда и как выполнять функции.

**Подробнее:** [[7. Функции]] [7. Функции](../полный/7.  Функции/резюме.md)

