### **üìå –ü–æ–¥—Ä–æ–±–Ω—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç —Å–µ–¥—å–º–æ–π —á–∞—Å—Ç–∏: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∏ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ**

---

## **7Ô∏è‚É£ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∏ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ**

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∏ **—Ñ–∏–∑–∏—á–µ—Å–∫—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL**, –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –∑–∞–∫—Ä–µ–ø–∏—Ç—å –∑–Ω–∞–Ω–∏—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ.

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ:

- –†–∞–∑–±–µ—Ä—ë–º **–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º–∏.
- –ü–æ–¥–≤–µ–¥—ë–º **–∏—Ç–æ–≥** –ø–æ –∏–∑—É—á–µ–Ω–Ω—ã–º —Ç–µ–º–∞–º.

---

### **üîπ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –†–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º–∏**

**–ó–∞–¥–∞—á–∞:**

1. –°–æ–∑–¥–∞—Ç—å **–Ω–æ–≤–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**.
2. –°–æ–∑–¥–∞—Ç—å **–Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** –∏ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –µ—ë –≤ —ç—Ç–æ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.
3. –°–æ–∑–¥–∞—Ç—å **—Ç–∞–±–ª–∏—Ü—É** –≤ —ç—Ç–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
4. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å **–≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –µ—ë —Ñ–∞–π–ª—ã**.
5. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É **–≤ –¥—Ä—É–≥–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**.
6. –ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–æ–≤ —Ç–∞–±–ª–∏—Ü—ã –∏ –µ—ë —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

---

### **1Ô∏è‚É£ –°–æ–∑–¥–∞—ë–º –Ω–æ–≤–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**

–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º **–Ω–æ–≤–æ–≥–æ —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞** –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å **–∫–∞—Ç–∞–ª–æ–≥ –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ**.

üìå **–°–æ–∑–¥–∞—ë–º –∫–∞—Ç–∞–ª–æ–≥ (Linux):**

```sh
mkdir -p /mnt/fast_ssd/tablespace_data
chown postgres:postgres /mnt/fast_ssd/tablespace_data
```

üìå **–°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤ PostgreSQL:**

```sql
CREATE TABLESPACE fast_tablespace LOCATION '/mnt/fast_ssd/tablespace_data';
```

üìå **–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–æ:**

```sql
SELECT spcname, pg_tablespace_location(oid) FROM pg_tablespace;
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
 spcname         | pg_tablespace_location
----------------+----------------------
 pg_default     |
 pg_global      |
 fast_tablespace | /mnt/fast_ssd/tablespace_data
```

---

### **2Ô∏è‚É£ –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å —Ç–∞–±–ª–∏—á–Ω—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º**

```sql
CREATE DATABASE my_fast_db TABLESPACE fast_tablespace;
```

üìå **–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞:**

```sql
SELECT datname, dattablespace FROM pg_database;
```

–í—ã–≤–æ–¥:

```
 datname    | dattablespace
------------+---------------
 postgres   | 1663 (pg_default)
 my_fast_db | 20000 (fast_tablespace)
```

---

### **3Ô∏è‚É£ –°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É –≤ –Ω–æ–≤–æ–º —Ç–∞–±–ª–∏—á–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ**

```sql
\c my_fast_db  -- –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –≤ –±–∞–∑—É
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    details TEXT
);
```

üìå **–ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤ –∫–∞–∫–æ–º —Ç–∞–±–ª–∏—á–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞:**

```sql
SELECT relname, reltablespace FROM pg_class WHERE relname = 'orders';
```

–ï—Å–ª–∏ `reltablespace = 0`, –∑–Ω–∞—á–∏—Ç —Ç–∞–±–ª–∏—Ü–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ **—Ç–∞–±–ª–∏—á–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –±–∞–∑—ã** (fast_tablespace).

---

### **4Ô∏è‚É£ –ù–∞—Ö–æ–¥–∏–º —Ñ–∞–π–ª—ã —Ç–∞–±–ª–∏—Ü—ã –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ**

üìå **–ü–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —Ç–∞–±–ª–∏—Ü—ã:**

```sql
SELECT pg_relation_filepath('orders');
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
 pg_tblspc/20000/PG_14_202107181/16384/32768
```

‚Üí –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —Ñ–∞–π–ª—ã —Ç–∞–±–ª–∏—Ü—ã **–Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—á–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ fast_tablespace**.

üìå **–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª—ã –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ:**

```sh
ls -lh /mnt/fast_ssd/tablespace_data/PG_14_202107181/16384/
```

–í—ã–≤–æ–¥:

```
-rw------- 1 postgres postgres 8.0M  orders
-rw------- 1 postgres postgres 32K   orders_fsm
-rw------- 1 postgres postgres 16K   orders_vm
```

---

### **5Ô∏è‚É£ –ü–µ—Ä–µ–Ω–æ—Å —Ç–∞–±–ª–∏—Ü—ã –≤ –¥—Ä—É–≥–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**

–ü–µ—Ä–µ–º–µ—Å—Ç–∏–º —Ç–∞–±–ª–∏—Ü—É `orders` –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ `pg_default`:

```sql
ALTER TABLE orders SET TABLESPACE pg_default;
```

üìå **–¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–π –ø—É—Ç—å —Ñ–∞–π–ª–∞:**

```sql
SELECT pg_relation_filepath('orders');
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
 base/16384/32768
```

–¢–µ–ø–µ—Ä—å —Ç–∞–±–ª–∏—Ü–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è **–≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ PostgreSQL**.

---

### **6Ô∏è‚É£ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä—ã —Ç–∞–±–ª–∏—Ü—ã**

üìå **–ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã (–≤–∫–ª—é—á–∞—è –∏–Ω–¥–µ–∫—Å—ã):**

```sql
SELECT pg_size_pretty(pg_total_relation_size('orders'));
```

üìå **–°–º–æ—Ç—Ä–∏–º –æ—Ç–¥–µ–ª—å–Ω–æ —Ä–∞–∑–º–µ—Ä—ã Forks:**

```sql
SELECT 
    pg_size_pretty(pg_relation_size('orders', 'main')) AS main_fork,
    pg_size_pretty(pg_relation_size('orders', 'fsm')) AS fsm_fork,
    pg_size_pretty(pg_relation_size('orders', 'vm')) AS vm_fork;
```

üìå **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TOAST (–µ—Å–ª–∏ –µ—Å—Ç—å –±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è):**

```sql
SELECT relname FROM pg_class WHERE oid = (
    SELECT reltoastrelid FROM pg_class WHERE relname = 'orders'
);
```

–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω—É–ª –∏–º—è TOAST-—Ç–∞–±–ª–∏—Ü—ã ‚Üí —É —Ç–∞–±–ª–∏—Ü—ã `orders` –µ—Å—Ç—å –±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è, –≤—ã–Ω–µ—Å–µ–Ω–Ω—ã–µ –≤ TOAST.

---

### **üîπ –ò—Ç–æ–≥–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏**

–ú—ã –Ω–∞—É—á–∏–ª–∏—Å—å: ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å **–Ω–æ–≤–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**.  
‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å **–±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω—è—â—É—é—Å—è –≤ –¥—Ä—É–≥–æ–º —Ç–∞–±–ª–∏—á–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ**.  
‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å **—Ç–∞–±–ª–∏—Ü—ã –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –∏—Ö —Ñ–∞–π–ª—ã** –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.  
‚úÖ **–ü–µ—Ä–µ–º–µ—â–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –º–µ–∂–¥—É —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º–∏**.  
‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å **—Ä–∞–∑–º–µ—Ä—ã —Ç–∞–±–ª–∏—Ü, FSM, VM –∏ TOAST**.

---

### **üîπ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∫—É—Ä—Å–∞ –ø–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL**

–¢–µ–ø–µ—Ä—å –º—ã **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–æ–±—Ä–∞–ª–∏** —Ñ–∏–∑–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL!

üìå **–ì–ª–∞–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:**

1. **–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞—Ö** ‚Äì —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ñ–∞–π–ª—ã –ë–î.
2. **–¢–∞–±–ª–∏—Ü—ã —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —Å—Ç—Ä–∞–Ω–∏—Ü –ø–æ 8 KB** ‚Äì —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è.
3. **–§–∞–π–ª—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –º–æ–≥—É—Ç –≤–∫–ª—é—á–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Å–ª–æ–∏ (forks)**:
    - **Main** ‚Äì –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
    - **FSM** ‚Äì —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ.
    - **VM** ‚Äì –∫–∞—Ä—Ç–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏.
    - **TOAST** ‚Äì —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
4. **–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö** –º–µ—Å—Ç–æ **–Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É** ‚Äì –Ω—É–∂–µ–Ω `VACUUM`.
5. **TOAST-–¥–∞–Ω–Ω—ã–µ** –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω–∏ –Ω—É–∂–Ω—ã –≤ –∑–∞–ø—Ä–æ—Å–µ**.
6. **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å**, –≤—ã–±–∏—Ä–∞—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏ –∏–Ω–¥–µ–∫—Å—ã.

üí° **–ö–∞–∫ —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ?**

- –ï—Å–ª–∏ —É –≤–∞—Å **–∞—Ä—Ö–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**, —Ö—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤ **–æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–∞–±–ª–∏—á–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ** –Ω–∞ HDD.
- –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è, —Ö—Ä–∞–Ω–∏—Ç–µ –∏—Ö **–Ω–∞ SSD**.
- –ï—Å–ª–∏ —É –≤–∞—Å **–º–Ω–æ–≥–æ –¥–ª–∏–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (TEXT, JSONB, BYTEA)**, –ø–æ–º–Ω–∏—Ç–µ, —á—Ç–æ PostgreSQL **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TOAST**.

---

üéâ **–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –µ—Å—Ç—å –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç –ø–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL!** üöÄ

