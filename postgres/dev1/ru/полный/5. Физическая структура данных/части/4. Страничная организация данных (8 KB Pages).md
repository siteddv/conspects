### **üìå –ü–æ–¥—Ä–æ–±–Ω—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç —á–µ—Ç–≤—ë—Ä—Ç–æ–π —á–∞—Å—Ç–∏: –°—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL (8 KB Pages)**

---

## **4Ô∏è‚É£ –°—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL (8 KB Pages)**

–¢–µ–ø–µ—Ä—å —Ä–∞–∑–±–µ—Ä—ë–º, **–∫–∞–∫ PostgreSQL —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–æ–≤**. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º:

- –ö–∞–∫ —Ç–∞–±–ª–∏—Ü—ã –¥–µ–ª—è—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
- –ö–∞–∫ PostgreSQL —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏.
- –ß—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–∞–Ω–∏—Ü.

---

### **üîπ –ö–∞–∫ PostgreSQL —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–∞—Ö?**

- –î–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ –∏–Ω–¥–µ–∫—Å–∞ **–Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∏–¥–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫**.
- PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å—Ç—Ä–∞–Ω–∏—á–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é**: —Ñ–∞–π–ª **—Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –±–ª–æ–∫–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (8 KB)**.
- –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç **–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø** –∫ –¥–∞–Ω–Ω—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫—ç—à–µ–º.

üìå **–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:**

> –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–æ–ª–∂–Ω—ã **—É–º–µ—â–∞—Ç—å—Å—è –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–æ–º 8 KB**.

---

### **üîπ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**

–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª PostgreSQL (–±—É–¥—å —Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –∏–ª–∏ –∏–Ω–¥–µ–∫—Å) **—Ä–∞–∑–±–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã** (`pages`), –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç **—Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã**.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ —Ç–∞–±–ª–∏—Ü—ã –≤ PostgreSQL:**

```
+-------------------------+
|      –°—Ç—Ä–∞–Ω–∏—Ü–∞ 0 (8 KB)  |
+-------------------------+
|      –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 (8 KB)  |
+-------------------------+
|      –°—Ç—Ä–∞–Ω–∏—Ü–∞ 2 (8 KB)  |
+-------------------------+
|          ...            |
+-------------------------+
|      –°—Ç—Ä–∞–Ω–∏—Ü–∞ N (8 KB)  |
+-------------------------+
```

üí° **–ü—Ä–∏–º–µ—Ä:** –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –∑–∞–Ω–∏–º–∞–µ—Ç **1 –ì–ë**, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –Ω–µ–π **~131 072 —Å—Ç—Ä–∞–Ω–∏—Ü** –ø–æ 8 KB –∫–∞–∂–¥–∞—è.

---

### **üîπ –ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ PostgreSQL?**

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ PostgreSQL –∏–º–µ–µ—Ç **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É**, —Å–æ—Å—Ç–æ—è—â—É—é –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å—Ç–µ–π:

```
+-------------------------------+
| –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (Header)   |  24 –±–∞–π—Ç–∞
+-------------------------------+
| –¢–∞–±–ª–∏—Ü–∞ —Å–º–µ—â–µ–Ω–∏–π (Item IDs)   |  –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä
+-------------------------------+
| –î–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫ (Tuples)         |  –û—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
+-------------------------------+
| –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ               |
+-------------------------------+
| –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ        |  (–≤ –∏–Ω–¥–µ–∫—Å–µ)
+-------------------------------+
```

#### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**

1. **–ó–∞–≥–æ–ª–æ–≤–æ–∫ (Header)** ‚Äì 24 –±–∞–π—Ç–∞
    - –°–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: –Ω–æ–º–µ—Ä, —Ñ–ª–∞–≥–∏, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–≤–æ–±–æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.
2. **–¢–∞–±–ª–∏—Ü–∞ —Å–º–µ—â–µ–Ω–∏–π (Item IDs)**
    - –£–∫–∞–∑—ã–≤–∞–µ—Ç, –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∑–∞–ø–∏—Å–∏ –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
3. **–°—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã (Tuples)**
    - –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã, –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
4. **–°–≤–æ–±–æ–¥–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
5. **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** (–µ—Å–ª–∏ —ç—Ç–æ –∏–Ω–¥–µ–∫—Å)
    - –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ B-–¥–µ—Ä–µ–≤—å—è—Ö –∑–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

---

### **üîπ –ö–∞–∫ PostgreSQL –≤—Å—Ç–∞–≤–ª—è–µ—Ç –∏ —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ?**

- **–ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏** PostgreSQL –∏—â–µ—Ç **—Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö**.
- –ï—Å–ª–∏ –≤ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ **–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞**, —Å–æ–∑–¥–∞—ë—Ç—Å—è **–Ω–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**.
- **–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫–∏** –º–µ—Å—Ç–æ **–Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É** ‚Äì –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å—Ç—Ä–æ–∫–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ "–º—ë—Ä—Ç–≤–∞—è".
- **–û—á–∏—Å—Ç–∫–∞ "–º—ë—Ä—Ç–≤—ã—Ö" —Å—Ç—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `VACUUM`**.

---

### **üîπ –ö–∞–∫ –Ω–∞–π—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ?**

–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `pageinspect`:

```sql
SELECT * FROM heap_page_items(get_raw_page('my_table', 0));
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç **–¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–∞–±–ª–∏—Ü—ã**.

---

### **üîπ –ö–∞–∫ PostgreSQL —Ö—Ä–∞–Ω–∏—Ç –±–æ–ª—å—à–∏–µ —Å—Ç—Ä–æ–∫–∏?**

> **–ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –±–æ–ª—å—à–µ 8 KB, –æ–Ω–∞ –Ω–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –æ–¥–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—É.**

PostgreSQL –ø—Ä–∏–º–µ–Ω—è–µ—Ç **–¥–≤–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏**:

6. **–°–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö** (LZ4, PGLZ) ‚Äì –µ—Å–ª–∏ —É–¥–∞—ë—Ç—Å—è —Å–∂–∞—Ç—å —Å—Ç—Ä–æ–∫—É –¥–æ 8 KB, –æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –æ–¥–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—É.
7. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TOAST** ‚Äì –µ—Å–ª–∏ —Å–∂–∞—Ç–∏–µ –Ω–µ –ø–æ–º–æ–≥–ª–æ, —Å—Ç—Ä–æ–∫–∞ **–≤—ã–Ω–æ—Å–∏—Ç—Å—è –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é TOAST-—Ç–∞–±–ª–∏—Ü—É**.

**TOAST = "The Oversized-Attribute Storage Technique"**  
TOAST-—Ç–∞–±–ª–∏—Ü–∞ —Ö—Ä–∞–Ω–∏—Ç **–¥–ª–∏–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã**, –∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ **—Å—Å—ã–ª–∫–∞ –Ω–∞ TOAST**.

üí° **–ö–∞–∫ —É–≤–∏–¥–µ—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ TOAST?**

```sql
SELECT reltoastrelid FROM pg_class WHERE relname = 'my_table';
```

–ï—Å–ª–∏ `reltoastrelid > 0`, –∑–Ω–∞—á–∏—Ç —É —Ç–∞–±–ª–∏—Ü—ã –µ—Å—Ç—å TOAST.

---

### **üîπ –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è?**

- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø–∞–º—è—Ç—å—é** ‚Äì PostgreSQL –∑–∞–≥—Ä—É–∂–∞–µ—Ç **—Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –±—É—Ñ–µ—Ä–Ω—ã–π –ø—É–ª** –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫.
- **–ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö** ‚Äì —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å **–ø–∞–∫–µ—Ç–∞–º–∏ –ø–æ 8 KB** –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –ø–æ –æ–¥–Ω–æ–π.
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤** ‚Äì –∏–Ω–¥–µ–∫—Å—ã —Ç–æ–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø–æ–∏—Å–∫.

---

### **üîπ –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã?**

- –†–∞–∑–º–µ—Ä **–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äì 8 KB**, –Ω–æ –µ–≥–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å **–ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ PostgreSQL**.
- –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã: **8 KB, 16 KB, 32 KB**.
- –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å **–æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏**.

üí° **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã?**

```sql
SHOW block_size;
```

---

### **üîπ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ç–≤—ë—Ä—Ç–æ–π —á–∞—Å—Ç–∏**

- PostgreSQL —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ **—Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö —Ä–∞–∑–º–µ—Ä–æ–º 8 KB**.
- –ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **–∑–∞–≥–æ–ª–æ–≤–∫–∞, —Å–º–µ—â–µ–Ω–∏–π, —Å—Ç—Ä–æ–∫ –∏ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞**.
- **–°—Ç—Ä–æ–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–∞–Ω–∏—Ü**, –∞ –µ—Å–ª–∏ –æ–Ω–∏ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ ‚Äì PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **TOAST**.
- –°—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç—å **—Ü–µ–ª–∏–∫–æ–º**, —á—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö.
- **–£–¥–∞–ª—ë–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç –º–µ—Å—Ç–æ —Å—Ä–∞–∑—É**, –∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `VACUUM`.

---

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ **–ø—è—Ç–æ–π —á–∞—Å—Ç–∏** ‚Äì **—Å–ª–æ–∏ (Forks) –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL**! üöÄ

