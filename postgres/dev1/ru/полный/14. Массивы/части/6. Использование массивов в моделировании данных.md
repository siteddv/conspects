### **–ö–æ–Ω—Å–ø–µ–∫—Ç. –ß–∞—Å—Ç—å 6: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**

–í —ç—Ç–æ–π —á–∞—Å—Ç–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –º–∞—Å—Å–∏–≤—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ. –°—Ä–∞–≤–Ω–∏–º **—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—É—é —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å** –∏ **–º–æ–¥–µ–ª—å —Å –º–∞—Å—Å–∏–≤–∞–º–∏**, –æ–±—Å—É–¥–∏–º –∏—Ö **–ø–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã**, –∞ —Ç–∞–∫–∂–µ —Ä–∞–∑–±–µ—Ä–µ–º –ø—Ä–∏–º–µ—Ä —Å —Ç–µ–≥–∞–º–∏ –≤ –±–ª–æ–≥–∞—Ö.

---

## **1. –î–≤–∞ –ø–æ–¥—Ö–æ–¥–∞ –∫ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö**

–ö–æ–≥–¥–∞ –Ω–∞–º –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å **—Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**, –Ω–∞–ø—Ä–∏–º–µ—Ä, **—Ç–µ–≥–∏ —Å—Ç–∞—Ç–µ–π –≤ –±–ª–æ–≥–µ**, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–¥–≤–∞ –ø–æ–¥—Ö–æ–¥–∞**:

1. **–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å**
    
    - –°–æ–∑–¥–∞–µ—Ç—Å—è **–æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `posts`).
    - –°–æ–∑–¥–∞–µ—Ç—Å—è **—Ç–∞–±–ª–∏—Ü–∞ —Ç–µ–≥–æ–≤** (`tags`).
    - –°–æ–∑–¥–∞–µ—Ç—Å—è **—Å–≤—è–∑—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞** (`post_tags`).
    - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `JOIN`-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤**
    
    - –í —Ç–∞–±–ª–∏—Ü–µ `posts` —Å–æ–∑–¥–∞–µ—Ç—Å—è **—Å—Ç–æ–ª–±–µ—Ü-–º–∞—Å—Å–∏–≤** `tags TEXT[]`.
    - –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º –ø–æ–ª–µ, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö `JOIN`.

---

## **2. –ü–æ–¥—Ö–æ–¥ 1: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å**

### **2.1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü**

```sql
CREATE TABLE posts (
    id SERIAL PRIMARY KEY,
    title TEXT NOT NULL
);

CREATE TABLE tags (
    id SERIAL PRIMARY KEY,
    name TEXT UNIQUE NOT NULL
);

CREATE TABLE post_tags (
    post_id INT REFERENCES posts(id),
    tag_id INT REFERENCES tags(id),
    PRIMARY KEY (post_id, tag_id)
);
```

### **2.2. –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**

```sql
INSERT INTO posts (title) VALUES ('Post about PostgreSQL');
INSERT INTO tags (name) VALUES ('SQL'), ('Database'), ('PostgreSQL');

INSERT INTO post_tags (post_id, tag_id) VALUES
(1, 1), (1, 2), (1, 3);
```

### **2.3. –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ–≥–æ–≤ –¥–ª—è –ø–æ—Å—Ç–∞**

```sql
SELECT p.title, t.name 
FROM posts p
JOIN post_tags pt ON p.id = pt.post_id
JOIN tags t ON pt.tag_id = t.id
WHERE p.id = 1;
```

**–í—ã–≤–æ–¥:**

```
title                 | name
----------------------|-----------
Post about PostgreSQL | SQL
Post about PostgreSQL | Database
Post about PostgreSQL | PostgreSQL
```

üìå **–ü–ª—é—Å—ã —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏**:

- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏** (FK, `ON DELETE CASCADE`).
- –¢–µ–≥–∏ –º–æ–∂–Ω–æ **–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤.
- –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å **–±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö**.

‚ùå **–ú–∏–Ω—É—Å—ã**:

- –ù—É–∂–Ω–æ **—Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã** –∏ `JOIN`-–∑–∞–ø—Ä–æ—Å—ã.
- –£—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è **–≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö**.

---

## **3. –ü–æ–¥—Ö–æ–¥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤**

### **3.1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã**

```sql
CREATE TABLE posts (
    id SERIAL PRIMARY KEY,
    title TEXT NOT NULL,
    tags TEXT[]  -- –•—Ä–∞–Ω–∏–º —Ç–µ–≥–∏ –ø—Ä—è–º–æ –≤ –º–∞—Å—Å–∏–≤–µ
);
```

### **3.2. –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**

```sql
INSERT INTO posts (title, tags) 
VALUES ('Post about PostgreSQL', ARRAY['SQL', 'Database', 'PostgreSQL']);
```

### **3.3. –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–≥–æ–≤**

```sql
SELECT title, unnest(tags) FROM posts WHERE id = 1;
```

**–í—ã–≤–æ–¥:**

```
title                 | unnest
----------------------|-----------
Post about PostgreSQL | SQL
Post about PostgreSQL | Database
Post about PostgreSQL | PostgreSQL
```

üìå **–ü–ª—é—Å—ã –º–∞—Å—Å–∏–≤–∞ –≤ —Å—Ç–æ–ª–±—Ü–µ**:

- **–ü—Ä–æ—Å—Ç–∞—è —Å—Ö–µ–º–∞** ‚Äì —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞.
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ `JOIN`-–∞—Ö.
- –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞ –¥–ª—è **–ø—Ä–æ—Å—Ç—ã—Ö –≤—ã–±–æ—Ä–æ–∫**.

‚ùå **–ú–∏–Ω—É—Å—ã**:

- **–ù–µ–ª—å–∑—è –∑–∞–¥–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á** –Ω–∞ `tags[]`.
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** (—Ç–µ–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ –æ—Ç–¥–µ–ª—å–Ω–æ).
- –°–ª–æ–∂–Ω–µ–µ –∏–∑–º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª–∏—Ç—å –æ–¥–∏–Ω —Ç–µ–≥ –∏–∑ –º–∞—Å—Å–∏–≤–∞).

---

## **4. –ü–æ–∏—Å–∫ –ø–æ—Å—Ç–æ–≤ –ø–æ —Ç–µ–≥—É**

üìå **–†–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**

```sql
SELECT p.title 
FROM posts p
JOIN post_tags pt ON p.id = pt.post_id
JOIN tags t ON pt.tag_id = t.id
WHERE t.name = 'PostgreSQL';
```

üìå **–ü–æ–∏—Å–∫ –≤ –º–∞—Å—Å–∏–≤–µ:**

```sql
SELECT title FROM posts WHERE 'PostgreSQL' = ANY(tags);
```

**–í—ã–≤–æ–¥:**

```
title
----------------------
Post about PostgreSQL
```

üîπ **–û–ø–µ—Ä–∞—Ç–æ—Ä `ANY(tags)` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –º–∞—Å—Å–∏–≤–µ.**

---

## **5. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–æ–≤**

**–û–±—ã—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** —Å –º–∞—Å—Å–∏–≤–∞–º–∏, –Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **GIN-–∏–Ω–¥–µ–∫—Å—ã**.

```sql
CREATE INDEX idx_tags ON posts USING GIN (tags);
```

–¢–µ–ø–µ—Ä—å **–ø–æ–∏—Å–∫ –ø–æ —Ç–µ–≥–∞–º** (`ANY(tags)`) –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ.

---

## **6. –ö–∞–∫ –ª—É—á—à–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ?**

|–ö—Ä–∏—Ç–µ—Ä–∏–π|–†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å|–ú–∞—Å—Å–∏–≤ –≤ —Å—Ç–æ–ª–±—Ü–µ|
|---|---|---|
|–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Å—Ö–µ–º—ã|‚ùå (3 —Ç–∞–±–ª–∏—Ü—ã)|‚úÖ (1 —Ç–∞–±–ª–∏—Ü–∞)|
|–ë—ã—Å—Ç—Ä–æ–¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –≤—ã–±–æ—Ä–æ–∫|‚ùå (JOIN)|‚úÖ (1 —Ç–∞–±–ª–∏—Ü–∞)|
|–ü–æ–∏—Å–∫ –ø–æ —Ç–µ–≥—É|‚úÖ (–ò–Ω–¥–µ–∫—Å –Ω–∞ FK)|‚úÖ (GIN-–∏–Ω–¥–µ–∫—Å)|
|–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏|‚úÖ (FK)|‚ùå (–ù–µ—Ç FK)|
|–ì–∏–±–∫–æ—Å—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö|‚úÖ (–£–¥–∞–ª–µ–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ)|‚ùå (–°–ª–æ–∂–Ω–µ–µ)|

### üîπ **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤—ã?**

- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ **–Ω–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —á–∞—Å—Ç–æ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏).
- –ï—Å–ª–∏ –º–∞—Å—Å–∏–≤ **–Ω–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π** (–¥–æ **100-200 —ç–ª–µ–º–µ–Ω—Ç–æ–≤**).
- –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ **–ø—Ä–æ—Å—Ç–∞—è —Å—Ö–µ–º–∞** –±–µ–∑ `JOIN`.

### üîπ **–ö–æ–≥–¥–∞ –ª—É—á—à–µ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å?**

- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ **–∏–∑–º–µ–Ω—è—é—Ç—Å—è** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–∞—Å—Ç–æ —É–¥–∞–ª—è—é—Ç—Å—è –∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è).
- –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è **—É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–∏–Ω —Ç–µ–≥ –Ω–∞ –≤—Å–µ—Ö).
- –ï—Å–ª–∏ –Ω—É–∂–Ω—ã **—Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏**.

---

## **7. –ò—Ç–æ–≥**

‚úÖ **–ú–∞—Å—Å–∏–≤—ã –º–æ–≥—É—Ç –∑–∞–º–µ–Ω–∏—Ç—å `JOIN`, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —É–¥–æ–±–Ω—ã.**  
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `ANY(tags)` –∏ `GIN`-–∏–Ω–¥–µ–∫—Å–∞ –¥–µ–ª–∞–µ—Ç –ø–æ–∏—Å–∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º.  
‚úÖ –í —Å–ª–æ–∂–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö **–ª—É—á—à–µ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è —Å—Ö–µ–º–∞**, –Ω–æ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º–∞—Å—Å–∏–≤—ã –ø–æ–¥—Ö–æ–¥—è—Ç.

---

üëâ –í —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ —Ä–∞–∑–±–µ—Ä–µ–º **—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–∏–≥ —Å –º–∞—Å—Å–∏–≤–æ–º –∞–≤—Ç–æ—Ä–æ–≤**. –ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å? üöÄ

