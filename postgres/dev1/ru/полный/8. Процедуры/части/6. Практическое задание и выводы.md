### **–ü–µ—Ä–µ—Å–∫–∞–∑ 6-–π —á–∞—Å—Ç–∏: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∏ –≤—ã–≤–æ–¥—ã**

---

### **1. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ**

–í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –Ω—É–∂–Ω–æ:

1. **–£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –∞–≤—Ç–æ—Ä–æ–≤.**
2. **–°–æ–∑–¥–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏**, —á—Ç–æ–±—ã –≤ –±—É–¥—É—â–µ–º **–¥—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ –ø–æ—è–≤–ª—è–ª–∏—Å—å**.

üìå **–¶–µ–ª—å:**

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏**.
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** (`UNIQUE`, `EXCLUDE`, `TRIGGER` –∏ –¥—Ä.) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

---

### **2. –≠—Ç–∞–ø 1: –£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**

–î–ª—è –Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ–º **–ø—Ä–æ—Ü–µ–¥—É—Ä—É**, –∫–æ—Ç–æ—Ä–∞—è –∏—â–µ—Ç **–ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∞–≤—Ç–æ—Ä–æ–≤** –∏ —É–¥–∞–ª—è–µ—Ç –∏—Ö.

üîπ **–ü—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã `authors`:**

```sql
CREATE TABLE authors (
    id SERIAL PRIMARY KEY,
    name TEXT NOT NULL
);
```

üîπ **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã `remove_duplicates`**:

```sql
CREATE PROCEDURE remove_duplicates()
LANGUAGE SQL
AS $$
    DELETE FROM authors
    WHERE id NOT IN (
        SELECT MIN(id) FROM authors GROUP BY name
    );
$$;
```

üîπ **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `GROUP BY name`, —á—Ç–æ–±—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã.
- `MIN(id)` –≤—ã–±–∏—Ä–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –∑–∞–ø–∏—Å—å** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞.
- –û—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ **—É–¥–∞–ª—è—é—Ç—Å—è**.

üîπ **–í—ã–∑–æ–≤ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã:**

```sql
CALL remove_duplicates();
```

üìå –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ **–æ—Å—Ç–∞–Ω—É—Ç—Å—è —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∞–≤—Ç–æ—Ä—ã**.

---

### **3. –≠—Ç–∞–ø 2: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª–µ–Ω—ã, –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –∏—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ.

#### ‚úÖ **–í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `UNIQUE`**

```sql
ALTER TABLE authors ADD CONSTRAINT unique_author_name UNIQUE (name);
```

üìå **–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ–±–∞–≤–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç PostgreSQL –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É.**

---

#### ‚úÖ **–í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `EXCLUDE`**

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è **–±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞**, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `EXCLUDE`.

```sql
ALTER TABLE authors ADD CONSTRAINT no_duplicate_authors
EXCLUDE USING BTREE (name WITH =);
```

üìå **–≠—Ç–æ –∞–Ω–∞–ª–æ–≥ `UNIQUE`, –Ω–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ–ª–µ–µ –≥–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —É—Å–ª–æ–≤–∏—è.**

---

#### ‚úÖ **–í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `BEFORE INSERT TRIGGER`**

–ï—Å–ª–∏ –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å `UNIQUE`, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ç—Ä–∏–≥–≥–µ—Ä**, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∞–≤—Ç–æ—Ä.

üîπ **–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞:**

```sql
CREATE OR REPLACE FUNCTION prevent_duplicates()
RETURNS TRIGGER AS $$
BEGIN
    IF EXISTS (SELECT 1 FROM authors WHERE name = NEW.name) THEN
        RETURN NULL;  -- –û—Ç–º–µ–Ω–∏—Ç—å –≤—Å—Ç–∞–≤–∫—É
    END IF;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

üîπ **–ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Ç—Ä–∏–≥–≥–µ—Ä –∫ —Ç–∞–±–ª–∏—Ü–µ `authors`:**

```sql
CREATE TRIGGER prevent_duplicate_insert
BEFORE INSERT ON authors
FOR EACH ROW EXECUTE FUNCTION prevent_duplicates();
```

üìå –¢–µ–ø–µ—Ä—å PostgreSQL **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã** –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ.

---

### **4. –ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–¥ —Ä–µ—à–µ–Ω–∏—è**

```sql
-- –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
CREATE PROCEDURE remove_duplicates()
LANGUAGE SQL
AS $$
    DELETE FROM authors
    WHERE id NOT IN (
        SELECT MIN(id) FROM authors GROUP BY name
    );
$$;

CALL remove_duplicates();

-- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –±—É–¥—É—â–µ–º
ALTER TABLE authors ADD CONSTRAINT unique_author_name UNIQUE (name);
```

---

### **5. –í—ã–≤–æ–¥—ã**

‚úÖ **–ü—Ä–æ—Ü–µ–¥—É—Ä—ã —É–¥–æ–±–Ω—ã –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.**  
‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (`UNIQUE`, `EXCLUDE`, `TRIGGER`) –ø–æ–º–æ–≥–∞—é—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã.**  
‚úÖ **–¢—Ä–∏–≥–≥–µ—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å—Ç–∞–≤–∫–∞–º–∏, –Ω–æ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏.**  
‚úÖ **PostgreSQL –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏, –∏ –≤—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á.**

---

üî• **–¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –µ—Å—Ç—å –ø–æ–ª–Ω—ã–π –ø–æ–¥—Ä–æ–±–Ω—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç –≤—Å–µ–≥–æ –≤–∏–¥–µ–æ!**  
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ **–¥–æ–±–∞–≤–∏—Ç—å —á—Ç–æ-—Ç–æ –∏–ª–∏ —É—Ç–æ—á–Ω–∏—Ç—å**, –≥–æ–≤–æ—Ä–∏! üöÄ

