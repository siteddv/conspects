### –ü–æ–¥—Ä–æ–±–Ω—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç –ø–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL

PostgreSQL ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –°–£–ë–î —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≥–∏–±–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏. –û–¥–Ω–æ–π –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π PostgreSQL —è–≤–ª—è–µ—Ç—Å—è –µ—ë —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–æ–º, —Ç–∞–∫ –∏ –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —É—Ä–æ–≤–Ω–µ. –í —ç—Ç–æ–º –∫–æ–Ω—Å–ø–µ–∫—Ç–µ –º—ã –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä—ë–º –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL, –Ω–∞—á–∏–Ω–∞—è –æ—Ç —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—è –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö (TOAST).

---

## 1. **–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö**

PostgreSQL –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–≤–∞ —É—Ä–æ–≤–Ω—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö: **–ª–æ–≥–∏—á–µ—Å–∫–∏–π** –∏ **—Ñ–∏–∑–∏—á–µ—Å–∫–∏–π**.

- **–õ–æ–≥–∏—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è** –≤–∫–ª—é—á–∞–µ—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Å—Ö–µ–º—ã, —Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –≠—Ç–æ —Ç–æ, —Å —á–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–µ—Ä–µ–∑ SQL-–∑–∞–ø—Ä–æ—Å—ã.
- **–§–∏–∑–∏—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≥–¥–µ –∏ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ. –≠—Ç–æ—Ç —É—Ä–æ–≤–µ–Ω—å –≤–∞–∂–µ–Ω –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º.

–û—Å–Ω–æ–≤–Ω–æ–π –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å: **–≥–¥–µ –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ?**

---

### 1.1. **–¢–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (Tablespaces)**

**–¢–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ** ‚Äî —ç—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å—É—â–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è —É–∫–∞–∑—ã–≤–∞–µ—Ç, –≤ –∫–∞–∫–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –¢–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–æ–∑–≤–æ–ª—è—é—Ç:

1. **–ì–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö**:
   - –†–∞–∑–º–µ—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –¥–∏—Å–∫–∞—Ö.
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å —É—á—ë—Ç–æ–º —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–∏—Å–∫–æ–≤.
2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–æ–∫**:
   - –ê—Ä—Ö–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –¥–∏—Å–∫–∞—Ö (HDD).
   - "–ì–æ—Ä—è—á–∏–µ" –¥–∞–Ω–Ω—ã–µ ‚Äî –Ω–∞ –±—ã—Å—Ç—Ä—ã—Ö SSD.
3. **–û–±–ª–µ–≥—á–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ PostgreSQL**.

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤ PostgreSQL —Å–æ–∑–¥–∞—é—Ç—Å—è **–¥–≤–∞ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞**:
- **`pg_global`**: —Ö—Ä–∞–Ω–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫–æ –≤—Å–µ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö.
- **`pg_default`**: –æ—Å–Ω–æ–≤–Ω–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –æ–±—ä–µ–∫—Ç—ã, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –¥—Ä—É–≥–æ–µ.

---

### 1.2. **–§–∏–∑–∏—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–∞–π–ª—ã PostgreSQL**

–ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–∞, PostgreSQL –¥–æ–ª–∂–µ–Ω –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, **–≤ –∫–∞–∫–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã** —Ö—Ä–∞–Ω–∏—Ç—å –µ—ë –¥–∞–Ω–Ω—ã–µ. –§–∏–∑–∏—á–µ—Å–∫–∏ –¥–∞–Ω–Ω—ã–µ PostgreSQL —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **–∫–∞—Ç–∞–ª–æ–≥–∞—Ö –Ω–∞ –¥–∏—Å–∫–µ**, –∞ —Ç–æ—á–Ω–µ–µ:
- –í–Ω—É—Ç—Ä–∏ –∫–∞—Ç–∞–ª–æ–≥–∞ **–¥–∞–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ PostgreSQL** (–æ–±—ã—á–Ω–æ `/var/lib/postgresql/data` –∏–ª–∏ `/pgdata`).
- –í –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞—Ö, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ä–∞–∑–ª–∏—á–Ω—ã–º –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö –æ–±—ä–µ–∫—Ç–∞–º.

üí° **–í–∞–∂–Ω–æ:** –ö–∞—Ç–∞–ª–æ–≥ **–Ω–µ –¥–µ–ª–∏—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –ø–æ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö** ‚Äì –æ–±—ä–µ–∫—Ç—ã —Ä–∞–∑–Ω—ã—Ö –±–∞–∑ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ —Ä–∞–∑–Ω—ã–º —Ç–∞–±–ª–∏—á–Ω—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º!

---

### 1.3. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL**

–î–∞–Ω–Ω—ã–µ –≤ PostgreSQL –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π:
4. **–¢–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞** (`tablespaces`) ‚Äì —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.
5. **–ö–∞—Ç–∞–ª–æ–≥–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö** ‚Äì –¥–ª—è –∫–∞–∂–¥–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞—ë—Ç—Å—è –∫–∞—Ç–∞–ª–æ–≥ –≤–Ω—É—Ç—Ä–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.
6. **–§–∞–π–ª—ã —Ç–∞–±–ª–∏—Ü –∏ –∏–Ω–¥–µ–∫—Å–æ–≤** ‚Äì –∫–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏ –∏–Ω–¥–µ–∫—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π **–Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤**, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ.

#### üìÅ **–§–∏–∑–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**

–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ PostgreSQL:
```
/pgdata/ (–∫–∞—Ç–∞–ª–æ–≥ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞ PostgreSQL)
‚îú‚îÄ‚îÄ base/ (–∫–∞—Ç–∞–ª–æ–≥ —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
‚îÇ   ‚îú‚îÄ‚îÄ 16384/ (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–¥–Ω–æ–π –∏–∑ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 32768 (—Ñ–∞–π–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 32768.1 (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 32768_fsm (–∫–∞—Ä—Ç–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 32768_vm (–∫–∞—Ä—Ç–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 16384 (—Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–∞)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pg_filenode.map (—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ 16385/ (–∫–∞—Ç–∞–ª–æ–≥ –¥—Ä—É–≥–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
‚îú‚îÄ‚îÄ global/ (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –æ–±—â–∏–µ –¥–ª—è –≤—Å–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞)
‚îÇ   ‚îú‚îÄ‚îÄ pg_control (–æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–∞)
‚îÇ   ‚îú‚îÄ‚îÄ pg_database (—Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö)
‚îÇ   ‚îú‚îÄ‚îÄ 1262 (–≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç)
‚îú‚îÄ‚îÄ pg_tblspc/ (–∫–∞—Ç–∞–ª–æ–≥ –¥–ª—è —Å–∏–º–≤–æ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞)
‚îÇ   ‚îú‚îÄ‚îÄ 20000 -> /mnt/fast_ssd/data/ (–ø—Ä–∏–º–µ—Ä —Å–∏–º–ª–∏–Ω–∫–∞ –Ω–∞ –≤–Ω–µ—à–Ω–∏–π –¥–∏—Å–∫)
```

üí° **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- –í –∫–∞—Ç–∞–ª–æ–≥–µ `base/` –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ñ–∞–π–ª—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏ **–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**.
- `pg_tblspc/` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∏–º–≤–æ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ **–≤–Ω–µ—à–Ω–∏–µ —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞**.
- –§–∞–π–ª `pg_database` —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö.

---

### 1.4. **–°–ª–æ–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**

–í PostgreSQL –∫–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç (—Ç–∞–±–ª–∏—Ü–∞, –∏–Ω–¥–µ–∫—Å, –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏ —Ç. –¥.) —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤ (forks)**, —á—Ç–æ–±—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –¥–∏—Å–∫–æ–º:
7. **Main fork** ‚Äì –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ –∏–Ω–¥–µ–∫—Å–∞.
8. **Free Space Map (FSM)** ‚Äì –∫–∞—Ä—Ç–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.
9. **Visibility Map (VM)** ‚Äì –∫–∞—Ä—Ç–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.
10. **TOAST** ‚Äì —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è **–æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π**, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É.

---

## 2. **–¢–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (Tablespaces)**

### 2.1. **–ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞?**

**–¢–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ (tablespace)** ‚Äì —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º PostgreSQL, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, **–≤ –∫–∞–∫–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã** —Ö—Ä–∞–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã, –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ —Ç. –¥.).

–ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, **—Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ ‚Äì —ç—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å–ª–æ–π –Ω–∞–¥ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –¥–∞–Ω–Ω—ã—Ö**.

---

### 2.2. **–ó–∞—á–µ–º –Ω—É–∂–Ω—ã —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞?**

–¢–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–æ–∑–≤–æ–ª—è—é—Ç:
11. **–ì–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö**:
   - –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤, —É–∫–∞–∑—ã–≤–∞—è, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ.
   - PostgreSQL –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ—â–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –º–µ–∂–¥—É —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º–∏.
12. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –¥–∏—Å–∫–∞–º–∏**:
   - –•—Ä–∞–Ω–∏—Ç—å **–∞—Ä—Ö–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –Ω–∞ **–º–µ–¥–ª–µ–Ω–Ω—ã—Ö HDD** (–¥–µ—à—ë–≤—ã–π –æ–±—ä—ë–º).
   - –•—Ä–∞–Ω–∏—Ç—å **–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –Ω–∞ **–±—ã—Å—Ç—Ä—ã—Ö SSD** (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å).
13. **–ü–æ–≤—ã—Å–∏—Ç—å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏**:
   - –î–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å **–º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –¥–∏—Å–∫–∞–º–∏**, —Å–Ω–∏–∂–∞—è –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É.
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–∏—Å–∫–∏ –¥–ª—è –∏–Ω–¥–µ–∫—Å–æ–≤** –∏–ª–∏ **–¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**.
14. **–û–±–ª–µ–≥—á–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏—é**:
   - –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ **–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ** –≤ –¥—Ä—É–≥–æ–µ –º–µ—Å—Ç–æ –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ–π –ë–î.
   - –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ PostgreSQL –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ **—É–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥**, –Ω–µ –∫–æ–ø–∏—Ä—É—è —Ñ–∞–π–ª—ã.

---

### 2.3. **–ö–∞–∫–∏–µ —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ PostgreSQL?**

–°—Ä–∞–∑—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PostgreSQL —Å–æ–∑–¥–∞—ë—Ç **–¥–≤–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞**:
15. **`pg_global`**:
   - –•—Ä–∞–Ω–∏—Ç **–æ–±—â–∏–µ –æ–±—ä–µ–∫—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∞**, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–æ –≤—Å–µ—Ö –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö.
   - –ù–∞–ø—Ä–∏–º–µ—Ä: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–∑–∞—Ö (`pg_database`), —Å—Ö–µ–º–∞—Ö (`pg_namespace`), –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö (`pg_roles`).
   - –†–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ:
     ```
     /pgdata/global/
     ```
16. **`pg_default`**:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –±–∞–∑.
   - –í–∫–ª—é—á–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã, –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.
   - –†–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ:
     ```
     /pgdata/base/
     ```

üìå **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –∏–Ω–¥–µ–∫—Å—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `pg_default`, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –¥—Ä—É–≥–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.**

---

### 2.4. **–ö–∞–∫ PostgreSQL –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ?**

–ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏–ª–∏ –∏–Ω–¥–µ–∫—Å, PostgreSQL –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ **–ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É**:
17. –ï—Å–ª–∏ –≤ `CREATE TABLE` —É–∫–∞–∑–∞–Ω–æ `TABLESPACE`, –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –≤ **—É–∫–∞–∑–∞–Ω–Ω–æ–º** –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.
18. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Äì PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
19. –ï—Å–ª–∏ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ –∑–∞–¥–∞–Ω–æ ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `pg_default`.

---

## 3. **–§–∏–∑–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ PostgreSQL**

### 3.1. **–ì–¥–µ –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ñ–∞–π–ª—ã PostgreSQL?**

–í—Å–µ –¥–∞–Ω–Ω—ã–µ PostgreSQL —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **–∫–∞—Ç–∞–ª–æ–≥–µ –∫–ª–∞—Å—Ç–µ—Ä–∞**. –≠—Ç–æ **–æ—Å–Ω–æ–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è**, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö, —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

üóÇ **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø—É—Ç–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö PostgreSQL (–∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å–∏—Å—Ç–µ–º—ã):**
- **Linux (Debian/Ubuntu):** `/var/lib/postgresql/<–≤–µ—Ä—Å–∏—è>/main/`
- **Linux (CentOS/RHEL):** `/var/lib/pgsql/<–≤–µ—Ä—Å–∏—è>/data/`
- **Windows:** `C:\Program Files\PostgreSQL\<–≤–µ—Ä—Å–∏—è>\data\`
- **Docker:** `/var/lib/postgresql/data/`

–ü—É—Ç—å –∫ –∫–∞—Ç–∞–ª–æ–≥—É –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥–æ–π:
```sql
SHOW data_directory;
```

---

### 3.2. **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ PostgreSQL**

–í–Ω—É—Ç—Ä–∏ –∫–∞—Ç–∞–ª–æ–≥–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL (`PGDATA`) —Ö—Ä–∞–Ω—è—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
```
/pgdata/	# –ö–∞—Ç–∞–ª–æ–≥ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞ PostgreSQL
‚îú‚îÄ‚îÄ base/	# –ö–∞—Ç–∞–ª–æ–≥ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö (pg_default)
‚îÇ   ‚îú‚îÄ‚îÄ 16384/	# –ö–∞—Ç–∞–ª–æ–≥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 32768	# –§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 32768.1	# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ >1 –ì–ë)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 32768_fsm	# –ö–∞—Ä—Ç–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (Free Space Map)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 32768_vm	# –ö–∞—Ä—Ç–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ (Visibility Map)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 16384	# –§–∞–π–ª –∏–Ω–¥–µ–∫—Å–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pg_filenode.map # –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ 16385/	# –î—Ä—É–≥–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ global/	# –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ pg_control	# –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ pg_database	# –§–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ 1262	# –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç
‚îú‚îÄ‚îÄ pg_wal/	# –õ–æ–≥ —Ñ–∞–π–ª–æ–≤ WAL (–∂—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
‚îú‚îÄ‚îÄ pg_tblspc/	# –°–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
‚îÇ   ‚îú‚îÄ‚îÄ 20000 -> /mnt/ssd_tablespace/  # –ü—Ä–∏–º–µ—Ä —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
```

---

### 3.3. **–ö–∞—Ç–∞–ª–æ–≥ `base/` ‚Äì –æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö**

–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `base/` PostgreSQL —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ `pg_default`.  
–ó–¥–µ—Å—å –µ—Å—Ç—å **–ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥ –¥–ª—è –∫–∞–∂–¥–æ–π –±–∞–∑—ã**, **–∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —á–∏—Å–ª–æ–≤—ã–º ID**.

üí° **–ö–∞–∫ —É–∑–Ω–∞—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö?**
```sql
SELECT oid, datname FROM pg_database;
```

–ü—Ä–∏–º–µ—Ä:
```
 oid  |   datname
------+	
 16384 | my_database
 16385 | test_db
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ–∞–π–ª—ã –±–∞–∑—ã `my_database` –≤ –∫–∞—Ç–∞–ª–æ–≥–µ:
```
/pgdata/base/16384/
```

---

### 3.4. **–§–∞–π–ª—ã —Ç–∞–±–ª–∏—Ü –∏ –∏–Ω–¥–µ–∫—Å–æ–≤**

–ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏ –∏–Ω–¥–µ–∫—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π **–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤)** –≤ –∫–∞—Ç–∞–ª–æ–≥–µ —Å–≤–æ–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

#### **–§–∞–π–ª—ã —Ç–∞–±–ª–∏—Ü—ã**
- PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ñ–∞–π–ª–æ–≤—ã–µ —É–∑–ª—ã (filenode)** –¥–ª—è –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤.
- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç **–≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã**.
- –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç **1 –ì–ë**, —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å `.1`, `.2` –∏ —Ç. –¥.

**–ü—Ä–∏–º–µ—Ä:**
```
/pgdata/base/16384/
‚îú‚îÄ‚îÄ 32768	# –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü—ã
‚îú‚îÄ‚îÄ 32768.1	# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª (>1 –ì–ë)
‚îú‚îÄ‚îÄ 32768.2	# –ï—â—ë –æ–¥–∏–Ω —Ñ–∞–π–ª (>2 –ì–ë)
‚îú‚îÄ‚îÄ 32768_fsm     # –ö–∞—Ä—Ç–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
‚îú‚îÄ‚îÄ 32768_vm      # –ö–∞—Ä—Ç–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏
```

#### **–§–∞–π–ª—ã –∏–Ω–¥–µ–∫—Å–æ–≤**
- –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –∏–Ω–¥–µ–∫—Å–æ–≤ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `pg_class.relfilenode`.
- –ò–Ω–¥–µ–∫—Å—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π **–æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã** –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —á—Ç–æ –∏ —Ç–∞–±–ª–∏—Ü–∞.

üí° **–ö–∞–∫ —É–∑–Ω–∞—Ç—å –∏–º—è —Ñ–∞–π–ª–∞ —Ç–∞–±–ª–∏—Ü—ã?**
```sql
SELECT relname, relfilenode FROM pg_class WHERE relname = 'my_table';
```

–ü—Ä–∏–º–µ—Ä:
```
 relname  | relfilenode
	+	
 my_table | 32768
```

–§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü—ã `my_table` ‚Üí `/pgdata/base/16384/32768`

---

### 3.5. **–ö–∞–∫ PostgreSQL —Ö—Ä–∞–Ω–∏—Ç —Ñ–∞–π–ª—ã –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤?**

–ö–æ–≥–¥–∞ –º—ã —Å–æ–∑–¥–∞—ë–º **–Ω–æ–≤–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**, –æ–Ω–æ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `base/`, –∞ —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤ **—Å–≤–æ—ë–º –∫–∞—Ç–∞–ª–æ–≥–µ**.

üí° **–ü—Ä–∏–º–µ—Ä —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞:**
20. –°–æ–∑–¥–∞—ë–º –Ω–æ–≤–æ–µ —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ:
    ```sql
    CREATE TABLESPACE fast_tablespace LOCATION '/mnt/ssd_tablespace';
    ```
21. PostgreSQL –¥–æ–±–∞–≤–ª—è–µ—Ç **—Å–∏–º–≤–æ–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É** –≤ `pg_tblspc/`:
    ```
    /pgdata/pg_tblspc/20000 -> /mnt/ssd_tablespace/
    ```
22. –í–Ω—É—Ç—Ä–∏ `/mnt/ssd_tablespace/` —Å–æ–∑–¥–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã:
    ```
    /mnt/ssd_tablespace/
    ‚îú‚îÄ‚îÄ PG_14_202107181
    ‚îÇ   ‚îú‚îÄ‚îÄ 16384/  # –ö–∞—Ç–∞–ª–æ–≥ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ –µ—ë OID)
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 32768  # –§–∞–π–ª —Ç–∞–±–ª–∏—Ü—ã
    ```

---

### 3.6. **–°–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (`pg_tblspc/`)**

–§–∞–π–ª—ã –≤ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞—Ö PostgreSQL **–Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é** –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –¥–∞–Ω–Ω—ã—Ö (`PGDATA`).  
–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ PostgreSQL —Å–æ–∑–¥–∞—ë—Ç **—Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏** –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `pg_tblspc/`.

üìå **–ü—Ä–∏–º–µ—Ä:**
```sh
ls -l /pgdata/pg_tblspc/
```

–í—ã–≤–æ–¥:
```
lrwxrwxrwx 1 postgres postgres 32 Feb 10 10:00 20000 -> /mnt/ssd_tablespace/
```

–ì–¥–µ:
- `20000` ‚Äì **OID —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞**.
- –≠—Ç–æ —Å—Å—ã–ª–∫–∞ –Ω–∞ **—Ä–µ–∞–ª—å–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞ –¥—Ä—É–≥–æ–º –¥–∏—Å–∫–µ**.

üí° **–ö–∞–∫ —É–∑–Ω–∞—Ç—å –ø—É—Ç—å –∫ —Ç–∞–±–ª–∏—á–Ω–æ–º—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É?**
```sql
SELECT spcname, pg_tablespace_location(oid) FROM pg_tablespace;
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
 spcname	| pg_tablespace_location
	+	
 pg_default   |
 pg_global    |
 fast_tablespace | /mnt/ssd_tablespace
```

---

### 3.7. **–ö–∞–∫ –Ω–∞–π—Ç–∏ –≤—Å–µ —Ñ–∞–π–ª—ã, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ —Ç–∞–±–ª–∏—Ü–µ?**

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é:
```sql
SELECT pg_relation_filepath('my_table');
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
 base/16384/32768
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `my_table` —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `/pgdata/base/16384/32768`.

---

## 4. **–°—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL (8 KB Pages)**

### 4.1. **–ö–∞–∫ PostgreSQL —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–∞—Ö?**

- –î–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ –∏–Ω–¥–µ–∫—Å–∞ **–Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∏–¥–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫**.
- PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å—Ç—Ä–∞–Ω–∏—á–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é**: —Ñ–∞–π–ª **—Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –±–ª–æ–∫–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (8 KB)**.
- –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç **–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø** –∫ –¥–∞–Ω–Ω—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫—ç—à–µ–º.

üìå **–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:**
> –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–æ–ª–∂–Ω—ã **—É–º–µ—â–∞—Ç—å—Å—è –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–æ–º 8 KB**.

---

### 4.2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**

–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª PostgreSQL (–±—É–¥—å —Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –∏–ª–∏ –∏–Ω–¥–µ–∫—Å) **—Ä–∞–∑–±–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã** (`pages`), –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç **—Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã**.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ —Ç–∞–±–ª–∏—Ü—ã –≤ PostgreSQL:**
```
+	+
|      –°—Ç—Ä–∞–Ω–∏—Ü–∞ 0 (8 KB)  |
+	+
|      –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 (8 KB)  |
+	+
|      –°—Ç—Ä–∞–Ω–∏—Ü–∞ 2 (8 KB)  |
+	+
|	|
+	+
|      –°—Ç—Ä–∞–Ω–∏—Ü–∞ N (8 KB)  |
+	+
```

üí° **–ü—Ä–∏–º–µ—Ä:** –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –∑–∞–Ω–∏–º–∞–µ—Ç **1 –ì–ë**, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –Ω–µ–π **~131 072 —Å—Ç—Ä–∞–Ω–∏—Ü** –ø–æ 8 KB –∫–∞–∂–¥–∞—è.

---

### 4.3. **–ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ PostgreSQL?**

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ PostgreSQL –∏–º–µ–µ—Ç **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É**, —Å–æ—Å—Ç–æ—è—â—É—é –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å—Ç–µ–π:
```
+	+
| –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (Header)   |  24 –±–∞–π—Ç–∞
+	+
| –¢–∞–±–ª–∏—Ü–∞ —Å–º–µ—â–µ–Ω–∏–π (Item IDs)   |  –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä
+	+
| –î–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫ (Tuples)	|  –û—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
+	+
| –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ	|
+	+
| –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ	|  (–≤ –∏–Ω–¥–µ–∫—Å–µ)
+	+
```

#### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
23. **–ó–∞–≥–æ–ª–æ–≤–æ–∫ (Header)** ‚Äì 24 –±–∞–π—Ç–∞
    - –°–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: –Ω–æ–º–µ—Ä, —Ñ–ª–∞–≥–∏, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–≤–æ–±–æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.
24. **–¢–∞–±–ª–∏—Ü–∞ —Å–º–µ—â–µ–Ω–∏–π (Item IDs)**
    - –£–∫–∞–∑—ã–≤–∞–µ—Ç, –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∑–∞–ø–∏—Å–∏ –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
25. **–°—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã (Tuples)**
    - –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã, –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
26. **–°–≤–æ–±–æ–¥–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
27. **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** (–µ—Å–ª–∏ —ç—Ç–æ –∏–Ω–¥–µ–∫—Å)
    - –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ B-–¥–µ—Ä–µ–≤—å—è—Ö –∑–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

---

### 4.4. **–ö–∞–∫ PostgreSQL –≤—Å—Ç–∞–≤–ª—è–µ—Ç –∏ —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ?**

- **–ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏** PostgreSQL –∏—â–µ—Ç **—Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö**.
- –ï—Å–ª–∏ –≤ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ **–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞**, —Å–æ–∑–¥–∞—ë—Ç—Å—è **–Ω–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**.
- **–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫–∏** –º–µ—Å—Ç–æ **–Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É** ‚Äì –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å—Ç—Ä–æ–∫–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ "–º—ë—Ä—Ç–≤–∞—è".
- **–û—á–∏—Å—Ç–∫–∞ "–º—ë—Ä—Ç–≤—ã—Ö" —Å—Ç—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `VACUUM`**.

---

### 4.5. **–ö–∞–∫ –Ω–∞–π—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ?**

–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `pageinspect`:
```sql
SELECT * FROM heap_page_items(get_raw_page('my_table', 0));
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç **–¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–∞–±–ª–∏—Ü—ã**.

---

### 4.6. **–ö–∞–∫ PostgreSQL —Ö—Ä–∞–Ω–∏—Ç –±–æ–ª—å—à–∏–µ —Å—Ç—Ä–æ–∫–∏?**

> **–ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –±–æ–ª—å—à–µ 8 KB, –æ–Ω–∞ –Ω–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –æ–¥–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—É.**
PostgreSQL –ø—Ä–∏–º–µ–Ω—è–µ—Ç **–¥–≤–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏**:
28. **–°–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö** (LZ4, PGLZ) ‚Äì –µ—Å–ª–∏ —É–¥–∞—ë—Ç—Å—è —Å–∂–∞—Ç—å —Å—Ç—Ä–æ–∫—É –¥–æ 8 KB, –æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –æ–¥–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—É.
29. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TOAST** ‚Äì –µ—Å–ª–∏ —Å–∂–∞—Ç–∏–µ –Ω–µ –ø–æ–º–æ–≥–ª–æ, —Å—Ç—Ä–æ–∫–∞ **–≤—ã–Ω–æ—Å–∏—Ç—Å—è –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é TOAST-—Ç–∞–±–ª–∏—Ü—É**.

**TOAST = "The Oversized-Attribute Storage Technique"**  
TOAST-—Ç–∞–±–ª–∏—Ü–∞ —Ö—Ä–∞–Ω–∏—Ç **–¥–ª–∏–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã**, –∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ **—Å—Å—ã–ª–∫–∞ –Ω–∞ TOAST**.

üí° **–ö–∞–∫ —É–≤–∏–¥–µ—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ TOAST?**
```sql
SELECT reltoastrelid FROM pg_class WHERE relname = 'my_table';
```

–ï—Å–ª–∏ `reltoastrelid > 0`, –∑–Ω–∞—á–∏—Ç —É —Ç–∞–±–ª–∏—Ü—ã –µ—Å—Ç—å TOAST.

---

### 4.7. **–ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è?**

- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø–∞–º—è—Ç—å—é** ‚Äì PostgreSQL –∑–∞–≥—Ä—É–∂–∞–µ—Ç **—Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –±—É—Ñ–µ—Ä–Ω—ã–π –ø—É–ª** –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫.
- **–ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö** ‚Äì —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å **–ø–∞–∫–µ—Ç–∞–º–∏ –ø–æ 8 KB** –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –ø–æ –æ–¥–Ω–æ–π.
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤** ‚Äì –∏–Ω–¥–µ–∫—Å—ã —Ç–æ–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø–æ–∏—Å–∫.

---

### 4.8. **–ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã?**

- –†–∞–∑–º–µ—Ä **–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äì 8 KB**, –Ω–æ –µ–≥–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å **–ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ PostgreSQL**.
- –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã: **8 KB, 16 KB, 32 KB**.
- –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å **–æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏**.

üí° **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã?**
```sql
SHOW block_size;
```

---

## 5. **–°–ª–æ–∏ (Forks) –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL**

### 5.1. **–ß—Ç–æ —Ç–∞–∫–æ–µ Forks –≤ PostgreSQL?**

**Fork (–°–ª–æ–π) ‚Äì —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å (—Ñ–∞–π–ª), —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ –∏–Ω–¥–µ–∫—Å–∞**.  
–ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç (—Ç–∞–±–ª–∏—Ü–∞ –∏–ª–∏ –∏–Ω–¥–µ–∫—Å) –≤ PostgreSQL **–º–æ–∂–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤**, –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç:
- **–æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (Main fork),
- **–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–æ–∫** (Visibility Map fork),
- **–∫–∞—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞** (Free Space Map fork).

üí° **–ü—Ä–∏–º–µ—Ä —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã `orders` –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ:**
```
/pgdata/base/16384/
‚îú‚îÄ‚îÄ 32768	# –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Ç–∞–±–ª–∏—Ü—ã (Main Fork)
‚îú‚îÄ‚îÄ 32768_fsm      # –ö–∞—Ä—Ç–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ (Free Space Map)
‚îú‚îÄ‚îÄ 32768_vm	# –ö–∞—Ä—Ç–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–æ–∫ (Visibility Map)
```

---

### 5.2. **–í–∏–¥—ã Forks –≤ PostgreSQL**

|Fork (–°–ª–æ–π)|–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ|
|---|---|
|**Main fork**|–û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ –∏–Ω–¥–µ–∫—Å–∞|
|**Free Space Map (FSM)**|–ö–∞—Ä—Ç–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞|
|**Visibility Map (VM)**|–ö–∞—Ä—Ç–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–æ–∫|
|**INIT fork** (—Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω–¥–µ–∫—Å–æ–≤)|–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏|

---

### 5.3. **1. Main fork ‚Äì –û—Å–Ω–æ–≤–Ω–æ–π —Å–ª–æ–π –¥–∞–Ω–Ω—ã—Ö**

**–•—Ä–∞–Ω–∏—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∞–±–ª–∏—Ü–µ** (—Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–æ–∫–∏).

üìå **–ì–ª–∞–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏–ª–∏ –∏–Ω–¥–µ–∫—Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–º–µ–µ—Ç —ç—Ç–æ—Ç —Ñ–∞–π–ª.
- –•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ **—Å—Ç—Ä–∞–Ω–∏—Ü –ø–æ 8 KB**.
- –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç **1 –ì–ë**, PostgreSQL —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª—ã `.1`, `.2`, `.3` –∏ —Ç. –¥.

üí° **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã –≤ Main Fork?**
```sql
SELECT pg_relation_size('orders', 'main');
```

---

### 5.4. **2. Free Space Map (FSM) ‚Äì –ö–∞—Ä—Ç–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞**

**–ü–æ–∑–≤–æ–ª—è–µ—Ç PostgreSQL –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ**.

üìå **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
- –ö–æ–≥–¥–∞ —Å—Ç—Ä–æ–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è, –µ—ë –º–µ—Å—Ç–æ –æ—Å—Ç–∞—ë—Ç—Å—è **–∑–∞–Ω—è—Ç—ã–º** (–¥–æ `VACUUM`).
- FSM —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫–∞–∫–∏–µ **—Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–º–µ—é—Ç —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ**.
- –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç PostgreSQL –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç—å **–∫—É–¥–∞ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏**, –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—è –∫–∞–∂–¥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ä—É—á–Ω—É—é.

üí° **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä FSM-—Ñ–∞–π–ª–∞?**
```sql
SELECT pg_relation_size('orders', 'fsm');
```

---

### 5.5. **3. Visibility Map (VM) ‚Äì –ö–∞—Ä—Ç–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–æ–∫**

**–ü–æ–º–æ–≥–∞–µ—Ç —É—Å–∫–æ—Ä–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è –∏ `VACUUM`**.

üìå **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
- VM —Ö—Ä–∞–Ω–∏—Ç **—Ñ–ª–∞–≥–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü**, —É–∫–∞–∑—ã–≤–∞—è, –µ—Å—Ç—å –ª–∏ –≤ –Ω–∏—Ö **—É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Å—Ç—Ä–æ–∫–∏**.
- –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ **"—á–∏—Å—Ç–∞—è"**, `VACUUM` –µ—ë **–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç**.
- –≠—Ç–æ **—É—Å–∫–æ—Ä—è–µ—Ç `VACUUM`**, –ø–æ—Å–∫–æ–ª—å–∫—É PostgreSQL –Ω–µ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –≤–µ—Å—å —Ñ–∞–π–ª.

üí° **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä VM-—Ñ–∞–π–ª–∞?**
```sql
SELECT pg_relation_size('orders', 'vm');
```

---

### 5.6. **4. INIT Fork (–¢–æ–ª—å–∫–æ –¥–ª—è –∏–Ω–¥–µ–∫—Å–æ–≤)**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PostgreSQL **—Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω–¥–µ–∫—Å–æ–≤**.

üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ INIT Fork**:
- –ü–æ–º–æ–≥–∞–µ—Ç –±—ã—Å—Ç—Ä–æ **–ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã** –ø—Ä–∏ —Å–±–æ–µ –∏–ª–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏.
- –°–æ–¥–µ—Ä–∂–∏—Ç **–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞**, —á—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ.

---

### 5.7. **–ö–∞–∫ –Ω–∞–π—Ç–∏ –≤—Å–µ Forks —Ç–∞–±–ª–∏—Ü—ã?**

–í PostgreSQL –º–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö —Å–ª–æ—è—Ö (forks) —Ç–∞–±–ª–∏—Ü—ã —Å –ø–æ–º–æ—â—å—é:
```sql
SELECT pg_relation_size('orders', 'main') AS main_fork,
	pg_relation_size('orders', 'fsm') AS fsm_fork,
	pg_relation_size('orders', 'vm') AS vm_fork;
```

---

### 5.8. **–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã Forks**

üí° **–°—Ü–µ–Ω–∞—Ä–∏–π:**
30. –°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É –∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–µ—ë –¥–∞–Ω–Ω—ã–µ:
    ```sql
    CREATE TABLE orders (id SERIAL, details TEXT);
    INSERT INTO orders (details) SELECT 'order_' || generate_series(1, 100000);
    ```
31. –ü—Ä–æ–≤–µ—Ä—è–µ–º **—Ä–∞–∑–º–µ—Ä—ã —Ä–∞–∑–Ω—ã—Ö —Å–ª–æ—ë–≤**:
    ```sql
    SELECT pg_relation_size('orders', 'main') AS main,
	pg_relation_size('orders', 'fsm') AS fsm,
	pg_relation_size('orders', 'vm') AS vm;
    ```
32. **–£–¥–∞–ª—è–µ–º 50% —Å—Ç—Ä–æ–∫ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ FSM**:
    ```sql
    DELETE FROM orders WHERE id % 2 = 0;
    ```
33. **–ó–∞–ø—É—Å–∫–∞–µ–º `VACUUM` –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º Visibility Map**:
    ```sql
    VACUUM ANALYZE orders;
    ```

---

## 6. **TOAST (The Oversized-Attribute Storage Technique) ‚Äì —Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL**

PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å—Ç—Ä–∞–Ω–∏—á–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö**, –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä **8 KB**. –ù–æ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã **–ø—Ä–µ–≤—ã—à–∞–µ—Ç —ç—Ç–æ—Ç —Ä–∞–∑–º–µ—Ä**?  
‚Üí **–î–ª—è —ç—Ç–æ–≥–æ PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TOAST**.

---

### 6.1. **–ß—Ç–æ —Ç–∞–∫–æ–µ TOAST?**

**TOAST (The Oversized-Attribute Storage Technique)** ‚Äì —ç—Ç–æ **–º–µ—Ö–∞–Ω–∏–∑–º —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π**, –∫–æ—Ç–æ—Ä—ã–µ **–Ω–µ –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É (8 KB)**.

üìå **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
34. PostgreSQL –ø—ã—Ç–∞–µ—Ç—Å—è **—É–º–µ—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É –≤ 8 KB**.
35. –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ **—Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–∞—è**, —Å–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ—Ç—Å—è **—Å–∂–∞—Ç—å** –¥–∞–Ω–Ω—ã–µ (`PGLZ`-—Å–∂–∞—Ç–∏–µ).
36. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤—Å—ë –µ—â—ë **–±–æ–ª—å—à–µ 8 KB**, PostgreSQL **–≤—ã–Ω–æ—Å–∏—Ç –∏—Ö –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é TOAST-—Ç–∞–±–ª–∏—Ü—É**.
37. –í –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –æ—Å—Ç–∞—ë—Ç—Å—è **—Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∞ –Ω–∞ TOAST-—Ç–∞–±–ª–∏—Ü—É**.

---

### 6.2. **–ö–æ–≥–¥–∞ PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TOAST?**

PostgreSQL **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç TOAST-—Ç–∞–±–ª–∏—Ü—É**, –µ—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å —Å—Ç–æ–ª–±—Ü—ã:
- **TEXT**
- **BYTEA**
- **JSONB**
- **VARCHAR**
- **ARRAY**
- **XML**
- **HSTORE**

üí° **TOAST –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- `INTEGER`
- `BIGINT`
- `BOOLEAN`
- `REAL`
- `TIMESTAMP` (–ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ **–≤—Å–µ–≥–¥–∞ —É–º–µ—â–∞—é—Ç—Å—è –≤ 8 KB**)

---

### 6.3. **–ö–∞–∫ PostgreSQL —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ TOAST?**

–ö–æ–≥–¥–∞ —Å—Ç—Ä–æ–∫–∞ **—Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–∞—è**, PostgreSQL **—Ä–∞–∑–±–∏–≤–∞–µ—Ç –µ—ë –Ω–∞ —á–∞–Ω–∫–∏ (2 KB –∫–∞–∂–¥–∞—è)** –∏ —Ö—Ä–∞–Ω–∏—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π TOAST-—Ç–∞–±–ª–∏—Ü–µ.

–ü—Ä–∏–º–µ—Ä —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ–ª—å—à–æ–≥–æ —Ç–µ–∫—Å—Ç–∞:
```
+	+	+
| –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ | TOAST-—Ç–∞–±–ª–∏—Ü–∞ |
+	+	+
| ID  | TEXT     | TOAST OID	|
|---- |	|	|
| 1   | <—Å—Å—ã–ª–∫–∞> | 16384	|
+	+	+
+	+	+
| TOAST-—Ç–∞–±–ª–∏—Ü–∞    |	|
+	+	+
| OID  | –ß–∞–Ω–∫ # | –î–∞–Ω–Ω—ã–µ	|
|----  |	|	|
| 16384 |  1    | "Hello "	|
| 16384 |  2    | "World!"	|
+	+	+
```

---

### 6.4. **–ö–∞–∫ —É–∑–Ω–∞—Ç—å, –µ—Å—Ç—å –ª–∏ TOAST-—Ç–∞–±–ª–∏—Ü–∞ —É —Ç–∞–±–ª–∏—Ü—ã?**

–ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —É —Ç–∞–±–ª–∏—Ü—ã TOAST:
```sql
SELECT reltoastrelid FROM pg_class WHERE relname = 'my_table';
```

–ï—Å–ª–∏ **`reltoastrelid > 0`**, —É —Ç–∞–±–ª–∏—Ü—ã –µ—Å—Ç—å TOAST-—Ç–∞–±–ª–∏—Ü–∞.

üí° **–ö–∞–∫ —É–∑–Ω–∞—Ç—å –∏–º—è TOAST-—Ç–∞–±–ª–∏—Ü—ã?**
```sql
SELECT relname FROM pg_class WHERE oid = (
    SELECT reltoastrelid FROM pg_class WHERE relname = 'my_table'
);
```

---

### 6.5. **–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã TOAST**

38. **–°–æ–∑–¥–∞–¥–∏–º —Ç–∞–±–ª–∏—Ü—É —Å –¥–ª–∏–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º:**
    ```sql
    CREATE TABLE articles (
	id SERIAL PRIMARY KEY,
	content TEXT
    );
    ```
39. **–î–æ–±–∞–≤–∏–º –¥–∞–Ω–Ω—ã–µ –≤ TOAST:**
    ```sql
    INSERT INTO articles (content) VALUES (repeat('A', 10000));
    ```
40. **–ü—Ä–æ–≤–µ—Ä–∏–º, —Å–æ–∑–¥–∞–ª–∞—Å—å –ª–∏ TOAST-—Ç–∞–±–ª–∏—Ü–∞:**
    ```sql
    SELECT relname FROM pg_class WHERE oid = (
	SELECT reltoastrelid FROM pg_class WHERE relname = 'articles'
    );
    ```
    ‚Üí –í—ã–≤–µ–¥–µ—Ç –∏–º—è TOAST-—Ç–∞–±–ª–∏—Ü—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä `pg_toast_16384`.
41. **–ü–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ TOAST:**
    ```sql
    SELECT * FROM pg_toast.pg_toast_16384;
    ```
    ‚Üí –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ —á–∞–Ω–∫–∏ (2 KB).

---

### 6.6. **–ö–∞–∫ PostgreSQL –∑–∞–≥—Ä—É–∂–∞–µ—Ç TOAST-–¥–∞–Ω–Ω—ã–µ?**

42. **–ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –º–∞–ª–µ–Ω—å–∫–∞—è** ‚Üí –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã.
43. **–ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –±–æ–ª—å—à–∞—è** ‚Üí PostgreSQL –¥–µ–ª–∞–µ—Ç JOIN —Å TOAST-—Ç–∞–±–ª–∏—Ü–µ–π.
44. **–ï—Å–ª–∏ `SELECT *` –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç TOAST-—Å—Ç–æ–ª–±—Ü—ã** ‚Üí PostgreSQL –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç TOAST.

üí° **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**  
–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—É **–Ω–µ –Ω—É–∂–Ω—ã –±–æ–ª—å—à–∏–µ –ø–æ–ª—è**, –ª—É—á—à–µ –∏—Ö **–Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å**!

‚ùå **–ü–ª–æ—Ö–æ–π –ø—Ä–∏–º–µ—Ä:**
```sql
SELECT * FROM articles;
```

‚úÖ **–õ—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:**
```sql
SELECT id FROM articles;
```

---

### 6.7. **–°–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ TOAST**

PostgreSQL **–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∂–∏–º–∞–µ—Ç –±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ TOAST.  
–û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **PGLZ (PostgreSQL LZ)** ‚Äì –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å–∂–∞—Ç–∏—è.

üí° **–ö–∞–∫ –æ—Ç–∫–ª—é—á–∏—Ç—å —Å–∂–∞—Ç–∏–µ TOAST?**
```sql
ALTER TABLE articles ALTER COLUMN content SET STORAGE EXTERNAL;
```

–¢–µ–ø–µ—Ä—å PostgreSQL **–Ω–µ –±—É–¥–µ—Ç —Å–∂–∏–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ** –ø–µ—Ä–µ–¥ –∏—Ö –ø–µ—Ä–µ–Ω–æ—Å–æ–º –≤ TOAST.

---

### 6.8. **–ö–∞–∫ TOAST –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å?**

|–§–∞–∫—Ç–æ—Ä|–í–ª–∏—è–Ω–∏–µ|
|---|---|
|**–ó–∞–ø—Ä–æ—Å `SELECT *`**|–ú–µ–¥–ª–µ–Ω–Ω–µ–µ, –µ—Å–ª–∏ –µ—Å—Ç—å TOAST|
|**–ó–∞–ø—Ä–æ—Å —Å `WHERE content LIKE '%text%'`**|TOAST –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é|
|**`UPDATE` —Å—Ç—Ä–æ–∫–∏ —Å TOAST-–¥–∞–Ω–Ω—ã–º–∏**|–î—É–±–ª–∏—Ä—É–µ—Ç TOAST-–¥–∞–Ω–Ω—ã–µ, —É–≤–µ–ª–∏—á–∏–≤–∞—è —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã|
|**–°–∂–∞—Ç–∏–µ TOAST**|–≠–∫–æ–Ω–æ–º–∏—Ç –º–µ—Å—Ç–æ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç CPU|

---

### 6.9. **–ö–∞–∫ —É–ø—Ä–∞–≤–ª—è—Ç—å TOAST?**

45. **–û—Ç–∫–ª—é—á–∏—Ç—å TOAST (—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ):**
    ```sql
    ALTER TABLE articles ALTER COLUMN content SET STORAGE PLAIN;
    ```
46. **–†–∞–∑—Ä–µ—à–∏—Ç—å TOAST, –Ω–æ –±–µ–∑ —Å–∂–∞—Ç–∏—è:**
    ```sql
    ALTER TABLE articles ALTER COLUMN content SET STORAGE EXTERNAL;
    ```
47. **–í–∫–ª—é—á–∏—Ç—å —Å–∂–∞—Ç–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
    ```sql
    ALTER TABLE articles ALTER COLUMN content SET STORAGE EXTENDED;
    ```

---

## 