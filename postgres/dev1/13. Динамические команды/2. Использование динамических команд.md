### **–ö–æ–Ω—Å–ø–µ–∫—Ç: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö SQL-–∫–æ–º–∞–Ω–¥**

#### **1. –û–±—ã—á–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã vs. –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SQL-–∑–∞–ø—Ä–æ—Å—ã**

–û–±—ã—á–Ω–æ SQL-–∑–∞–ø—Ä–æ—Å—ã –ø–∏—à—É—Ç—Å—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏, —Ç.–µ. –∑–∞—Ä–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω–∞ –∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```sql
SELECT * FROM users WHERE age > 25;
```

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö SQL-–∫–æ–º–∞–Ω–¥ –∑–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ª–µ—Ç—É –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏:

```sql
EXECUTE format('SELECT * FROM %I WHERE age > %s', 'users', 25);
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å —á–∞—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å–ª–æ–≤–∏–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.

#### **2. –ì–¥–µ –º–æ–≥—É—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SQL-–∑–∞–ø—Ä–æ—Å—ã?**

##### üìå **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤**

- –í –∫—Ä—É–ø–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –∏–ª–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–∏—Å—Ç–µ–º–µ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å SQL-–∫–æ–º–∞–Ω–¥—ã –≤ —Ç–∞–±–ª–∏—Ü–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∏—Ö –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

##### üìå **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (`JOIN`)**

- –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è, —Ñ–æ—Ä–º–∏—Ä—É—é—â–∞—è SQL-–∑–∞–ø—Ä–æ—Å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

```sql
CREATE FUNCTION get_users(min_age INT, include_address BOOLEAN) RETURNS SETOF users AS $$
DECLARE
    query TEXT;
BEGIN
    query := 'SELECT * FROM users';
    
    IF min_age IS NOT NULL THEN
        query := query || ' WHERE age > ' || min_age;
    END IF;
    
    IF include_address THEN
        query := query || ' JOIN addresses ON users.id = addresses.user_id';
    END IF;

    RETURN QUERY EXECUTE query;
END;
$$ LANGUAGE plpgsql;
```

- –ó–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (`min_age`, `include_address`).
- –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ –Ω–µ–ª—å–∑—è –∑–∞—Ä–∞–Ω–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–ø—Ä–æ—Å–∞.

##### üìå **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –†–∞–±–æ—Ç–∞ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –∏–º–µ–Ω–∞–º–∏ —Ç–∞–±–ª–∏—Ü –∏ —Å—Ç–æ–ª–±—Ü–æ–≤**

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å –∏–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü –∏–ª–∏ —Å—Ç–æ–ª–±—Ü–æ–≤:

```sql
EXECUTE format('SELECT %I FROM %I', column_name, table_name);
```

üîπ **–ü—Ä–∏–º–µ—Ä:** –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ä–∞–∑–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º (`users_2023`, `users_2024`), —Ç–æ –±–µ–∑ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ SQL —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.

##### üìå **–°—Ü–µ–Ω–∞—Ä–∏–π 4: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á–µ—Ç–æ–≤**

- –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–∑–¥–∞–Ω–∏–µ "–º–∞—Ç—Ä–∏—á–Ω—ã—Ö" –æ—Ç—á–µ—Ç–æ–≤, –≥–¥–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
- –ú–æ–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å `GROUP BY`, `PIVOT` –∏ –¥—Ä—É–≥–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

---

### **–í—ã–≤–æ–¥**

–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SQL-–∫–æ–º–∞–Ω–¥—ã –ø–æ–ª–µ–∑–Ω—ã, –∫–æ–≥–¥–∞:  
‚úÖ –ù—É–∂–Ω–æ –º–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É SQL-–∑–∞–ø—Ä–æ—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.  
‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏–ª–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏.  
‚úÖ –ù–∞–¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∫–æ–º–∞–Ω–¥.

–ù–æ ‚ö†Ô∏è **–∏—Ö –Ω–µ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–º, –≥–¥–µ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —Å–ª–æ–∂–Ω–µ–µ –≤ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–∏ –∏ –º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã.

---

üëâ **–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–∞–Ω–¥.** –ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å?