### **–ö–æ–Ω—Å–ø–µ–∫—Ç: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–∞–Ω–¥**

–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è SQL-–∏–Ω—ä–µ–∫—Ü–∏–π –∏ —Å–ø–æ—Å–æ–±–æ–≤ –∑–∞—â–∏—Ç—ã –≤–∞–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, **–∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SQL-–∑–∞–ø—Ä–æ—Å—ã**. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º:  
‚úÖ –ö–∞–∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å –∏–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü –∏ —Å—Ç–æ–ª–±—Ü–æ–≤.  
‚úÖ –ö–∞–∫ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∏ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.  
‚úÖ –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ `FORMAT()`, `quote_ident()`, `quote_literal()`.

---

## **1. –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–º—ë–Ω —Ç–∞–±–ª–∏—Ü –∏ —Å—Ç–æ–ª–±—Ü–æ–≤**

–ö–æ–≥–¥–∞ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ —Å—Ç–æ–ª–±—Ü–∞ **–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ –∑–∞—Ä–∞–Ω–µ–µ**, –µ–≥–æ **–Ω–µ–ª—å–∑—è** –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä —á–µ—Ä–µ–∑ `USING`.  
–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `quote_ident()` –∏–ª–∏ `FORMAT('%I')`.

‚úÖ **–ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–º–µ–Ω–∏ —Ç–∞–±–ª–∏—Ü—ã:**

```sql
DO $$ 
DECLARE 
    table_name TEXT := 'users';
    query TEXT;
BEGIN 
    query := 'SELECT * FROM ' || quote_ident(table_name);
    EXECUTE query;
END $$;
```

üìå **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `quote_ident()`?**

- `quote_ident('users')` ‚Üí `users`
- `quote_ident('users; DROP TABLE users;')` ‚Üí `"users; DROP TABLE users;"`  
    **–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ—Ä–∞–±–æ—á–∏–º.**

---

‚úÖ **–¢–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ —á–µ—Ä–µ–∑ `FORMAT('%I')`:**

```sql
DO $$ 
DECLARE 
    table_name TEXT := 'users';
BEGIN 
    EXECUTE FORMAT('SELECT * FROM %I', table_name);
END $$;
```

üìå **–ü–æ—á–µ–º—É `FORMAT('%I')` —É–¥–æ–±–Ω–µ–µ?**

- –ö–æ–¥ —á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—â–µ.
- –ù–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ–±—ä–µ–¥–∏–Ω—è—Ç—å —Å—Ç—Ä–æ–∫–∏ (`||`).

---

## **2. –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ SQL-–∑–∞–ø—Ä–æ—Å—ã**

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± (—É—è–∑–≤–∏–º—ã–π)**:

```sql
DO $$ 
DECLARE 
    user_name TEXT := 'Oleg';
    query TEXT;
BEGIN 
    query := 'SELECT * FROM users WHERE name = ''' || user_name || '''';
    EXECUTE query;
END $$;
```

üìå **–ü—Ä–æ–±–ª–µ–º–∞**: SQL-–∏–Ω—ä–µ–∫—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–∞.

---

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `USING`**

```sql
DO $$ 
DECLARE 
    user_name TEXT := 'Oleg';
BEGIN 
    EXECUTE 'SELECT * FROM users WHERE name = $1' USING user_name;
END $$;
```

üìå **–ü–æ—á–µ–º—É —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ?**

- `USING` —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –¥–µ–ª–∞—è SQL-–∏–Ω—ä–µ–∫—Ü–∏—é –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–π.
- PostgreSQL –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ SQL-–∑–∞–ø—Ä–æ—Å.

---

‚úÖ **–ï—Å–ª–∏ `USING` –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –ø—Ä–∏–º–µ–Ω—è–µ–º `quote_literal()`**

```sql
DO $$ 
DECLARE 
    user_name TEXT := 'Oleg';
    query TEXT;
BEGIN 
    query := 'SELECT * FROM users WHERE name = ' || quote_literal(user_name);
    EXECUTE query;
END $$;
```

üìå **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `quote_literal()`?**

- `quote_literal('Oleg')` ‚Üí `'Oleg'`
- `quote_literal('Oleg''; DROP TABLE users; --')` ‚Üí `'''Oleg''''; DROP TABLE users; --'''`  
    üîπ **–õ—é–±–∞—è SQL-–∏–Ω—ä–µ–∫—Ü–∏—è –±—É–¥–µ—Ç –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∞ –≤ –æ–±—ã—á–Ω—É—é —Å—Ç—Ä–æ–∫—É.**

---

## **3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `FORMAT()` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è SQL**

### **üìå –ü—Ä–∏–º–µ—Ä: –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–º–µ–Ω–∏ —Ç–∞–±–ª–∏—Ü—ã –∏ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**

```sql
DO $$ 
DECLARE 
    table_name TEXT := 'users';
    user_name TEXT := 'Oleg';
BEGIN 
    EXECUTE FORMAT('SELECT * FROM %I WHERE name = %L', table_name, user_name);
END $$;
```

üìå **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**

- `%I` (`quote_ident()`) –∑–∞—â–∏—â–∞–µ—Ç **–∏–º—è —Ç–∞–±–ª–∏—Ü—ã**.
- `%L` (`quote_literal()`) –∑–∞—â–∏—â–∞–µ—Ç **–∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏**.

üîπ **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç `FORMAT()`?**

|–í—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ|–í—ã—Ö–æ–¥|
|---|---|
|`FORMAT('%I', 'users')`|`users`|
|`FORMAT('%L', 'Oleg')`|`'Oleg'`|
|`FORMAT('%L', 'Oleg''; DROP TABLE users;')`|`'''Oleg''; DROP TABLE users;'''`|

üî• **–í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç!**

---

## **4. –ò—Ç–æ–≥: –ö–∞–∫ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SQL-–∫–æ–º–∞–Ω–¥—ã?**

|–ó–∞–¥–∞—á–∞|–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚ùå|–ü—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ|
|---|---|---|
|**–ü–µ—Ä–µ–¥–∞—á–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ `WHERE`**|`'SELECT * FROM users WHERE name = '||
|**–ü–µ—Ä–µ–¥–∞—á–∞ –∏–º—ë–Ω —Ç–∞–±–ª–∏—Ü**|`'SELECT * FROM '||
|**–ü–µ—Ä–µ–¥–∞—á–∞ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**|`'SELECT * FROM users WHERE name = '||

---

## **–í—ã–≤–æ–¥**

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π `USING`, `quote_ident()`, `quote_literal()`, `FORMAT()`.**  
‚úÖ **–ù–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–π —Å—Ç—Ä–æ–∫–∏ –≤—Ä—É—á–Ω—É—é!**  
‚úÖ **–¢–∞–∫ –∫–æ–¥ –±—É–¥–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–º, –∑–∞—â–∏—â—ë–Ω–Ω—ã–º –∏ –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ–º—ã–º.**

---

üëâ **–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è (—Ñ—É–Ω–∫—Ü–∏—è `get_catalog()`, –º–∞—Ç—Ä–∏—á–Ω—ã–π –æ—Ç—á—ë—Ç).** –ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å?