### **–ü–æ–¥—Ä–æ–±–Ω—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏: –û–±—ä—è–≤–ª–µ–Ω–∏–µ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫—É—Ä—Å–æ—Ä–æ–≤**

---

### **2.1. –ö–∞–∫ –æ–±—ä—è–≤–ª—è—Ç—å –∫—É—Ä—Å–æ—Ä—ã –≤ PL/pgSQL?**

–í PL/pgSQL –∫—É—Ä—Å–æ—Ä—ã –æ–±—ä—è–≤–ª—è—é—Ç—Å—è **–≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π, –ø—Ä–æ—Ü–µ–¥—É—Ä –∏–ª–∏ –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –±–ª–æ–∫–æ–≤**. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `CURSOR` –∏–ª–∏ `REFCURSOR`.

#### **–û–±—â–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ—Ä–∞:**

```sql
DECLARE –∏–º—è_–∫—É—Ä—Å–æ—Ä–∞ CURSOR FOR –∑–∞–ø—Ä–æ—Å;
```

–ì–¥–µ:

- `–∏–º—è_–∫—É—Ä—Å–æ—Ä–∞` ‚Äî –∏–º—è –∫—É—Ä—Å–æ—Ä–∞, —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å.
- `CURSOR` ‚Äî –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ, –æ–±–æ–∑–Ω–∞—á–∞—é—â–µ–µ, —á—Ç–æ –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è –∫—É—Ä—Å–æ—Ä.
- `FOR –∑–∞–ø—Ä–æ—Å` ‚Äî SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫—É—Ä—Å–æ—Ä–∞.

–ü—Ä–∏–º–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ—Ä–∞:

```sql
DECLARE my_cursor CURSOR FOR SELECT * FROM employees WHERE department = 'IT';
```

üí° **–ü–æ—Å–ª–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ—Ä –ø–æ–∫–∞ –Ω–µ –æ—Ç–∫—Ä—ã—Ç.** –ï–≥–æ –Ω—É–∂–Ω–æ **–æ—Ç–∫—Ä—ã—Ç—å –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º**.

---

### **2.2. –†–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –∏ –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –∫—É—Ä—Å–æ—Ä–∞–º–∏**

–í PL/pgSQL –∫—É—Ä—Å–æ—Ä—ã –¥–µ–ª—è—Ç—Å—è –Ω–∞ –¥–≤–∞ —Ç–∏–ø–∞:

1. **–°–≤—è–∑–∞–Ω–Ω—ã–µ –∫—É—Ä—Å–æ—Ä—ã** (`BOUND CURSOR`)
    
    - –ö—É—Ä—Å–æ—Ä **—Å—Ä–∞–∑—É** –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É SQL-–∑–∞–ø—Ä–æ—Å—É.
    - –ï–≥–æ **–Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** —Å —Ä–∞–∑–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ ‚Äî –æ–Ω —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω.
    - –£–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–±–æ—Ç—É, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –∏–∑–≤–µ—Å—Ç–µ–Ω –∑–∞—Ä–∞–Ω–µ–µ.
2. **–ù–µ—Å–≤—è–∑–∞–Ω–Ω—ã–µ –∫—É—Ä—Å–æ—Ä—ã** (`UNBOUND CURSOR`)
    
    - –≠—Ç–æ –∫—É—Ä—Å–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ä—è–≤–ª—è—é—Ç—Å—è **–±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞** –∏ —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è —Å –Ω–∏–º **–ø–æ–∑–∂–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏**.
    - –ü–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ SQL-–∑–∞–ø—Ä–æ—Å–∞–º–∏.
    - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π.

üìå **–ü—Ä–∏–º–µ—Ä —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∫—É—Ä—Å–æ—Ä–∞:**

```sql
DECLARE emp_cursor CURSOR FOR SELECT id, name FROM employees WHERE department = 'HR';
```

üìå **–ü—Ä–∏–º–µ—Ä –Ω–µ—Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∫—É—Ä—Å–æ—Ä–∞:**

```sql
DECLARE dynamic_cursor REFCURSOR;
```

–ó–∞—Ç–µ–º –≤ –∫–æ–¥–µ –µ–≥–æ –º–æ–∂–Ω–æ –ø—Ä–∏–≤—è–∑–∞—Ç—å –∫ –∑–∞–ø—Ä–æ—Å—É:

```sql
OPEN dynamic_cursor FOR SELECT * FROM employees WHERE department = 'Finance';
```

---

### **2.3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∏–ø–∞ `REFCURSOR`**

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `REFCURSOR` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å **–∏–º—è –∫—É—Ä—Å–æ—Ä–∞** –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –µ–≥–æ –∫–ª–∏–µ–Ω—Ç—É.  
üìå **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `REFCURSOR`:**

```sql
DECLARE emp_cursor REFCURSOR;
BEGIN
    OPEN emp_cursor FOR SELECT * FROM employees WHERE department = 'HR';
END;
```

üí° **–û—Ç–ª–∏—á–∏–µ `REFCURSOR` –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ `CURSOR` –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∑–∞–ø—Ä–æ—Å—É –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏**. –û–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç **—Å —Ä–∞–∑–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏**.

---

### **2.4. –ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∫—É—Ä—Å–æ—Ä—ã**

–í PL/pgSQL –∫—É—Ä—Å–æ—Ä—ã **–º–æ–≥—É—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**. –≠—Ç–æ —É–¥–æ–±–Ω–æ, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º.

üìå **–ü—Ä–∏–º–µ—Ä –∫—É—Ä—Å–æ—Ä–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º:**

```sql
DECLARE emp_cursor CURSOR (dept_name TEXT) FOR
    SELECT id, name FROM employees WHERE department = dept_name;
```

–ó–∞—Ç–µ–º, –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –∫—É—Ä—Å–æ—Ä–∞, **—É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞**:

```sql
OPEN emp_cursor('IT');
```

üí° **–ö—É—Ä—Å–æ—Ä—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏!**

---

### **2.5. –û—Ç–∫—Ä—ã—Ç–∏–µ –∫—É—Ä—Å–æ—Ä–æ–≤**

–ü–æ—Å–ª–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ—Ä–∞ –µ–≥–æ **–Ω—É–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å** –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.

üìå **–û—Ç–∫—Ä—ã—Ç–∏–µ –∫—É—Ä—Å–æ—Ä–∞:**

```sql
OPEN emp_cursor;
```

üìå **–û—Ç–∫—Ä—ã—Ç–∏–µ `REFCURSOR` —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∏–º–µ–Ω–µ–º:**

```sql
OPEN dynamic_cursor FOR SELECT * FROM employees WHERE department = 'Sales';
```

–ö–æ–≥–¥–∞ –∫—É—Ä—Å–æ—Ä –æ—Ç–∫—Ä—ã—Ç, –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å **—á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (`FETCH`)** –∏–ª–∏ **–ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –µ–≥–æ –∫–ª–∏–µ–Ω—Ç—É**.

---

### **2.6. –í—ã–≤–æ–¥ –ø–æ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏**

- **–ö—É—Ä—Å–æ—Ä—ã –æ–±—ä—è–≤–ª—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `DECLARE`**, –Ω–æ –∏—Ö **–Ω—É–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º**.
- **–°–≤—è–∑–∞–Ω–Ω—ã–µ –∫—É—Ä—Å–æ—Ä—ã** —Å—Ä–∞–∑—É –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∑–∞–ø—Ä–æ—Å—É, **–Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã–µ –∫—É—Ä—Å–æ—Ä—ã (`REFCURSOR`)** –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏.
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å **–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫—É—Ä—Å–æ—Ä—ã**, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –±–æ–ª–µ–µ –≥–∏–±–∫–∏–º–∏.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `REFCURSOR` –ø–æ–∑–≤–æ–ª—è–µ—Ç **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å–∞–º–∏** –∏ **–ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫—É—Ä—Å–æ—Ä—ã –∫–ª–∏–µ–Ω—Ç—É**.

---

üëâ **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –†–∞–∑–±–∏—Ä–∞–µ–º **—Ç—Ä–µ—Ç—å—é —á–∞—Å—Ç—å: "–û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫—É—Ä—Å–æ—Ä–∞–º–∏"**?