### **–ü–æ–¥—Ä–æ–±–Ω—ã–π –∫–æ–Ω—Å–ø–µ–∫—Ç —Ç—Ä–µ—Ç—å–µ–π —á–∞—Å—Ç–∏: –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫—É—Ä—Å–æ—Ä–∞–º–∏**

---

### **3.1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫—É—Ä—Å–æ—Ä–∞ (`FETCH`)**

–ü–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫—É—Ä—Å–æ—Ä–∞ –º–æ–∂–Ω–æ **–∏–∑–≤–ª–µ–∫–∞—Ç—å –¥–∞–Ω–Ω—ã–µ** –ø–æ—Å—Ç—Ä–æ—á–Ω–æ.  
–î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ **`FETCH`**, –∫–æ—Ç–æ—Ä–∞—è –±–µ—Ä–µ—Ç **—Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É** –∏–∑ –∫—É—Ä—Å–æ—Ä–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ—ë –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.

üìå **–ü—Ä–æ—Å—Ç–µ–π—à–∏–π –ø—Ä–∏–º–µ—Ä:**

```sql
DECLARE emp_cursor CURSOR FOR SELECT id, name FROM employees WHERE department = 'HR';
DECLARE emp_record RECORD;

BEGIN
    OPEN emp_cursor;
    FETCH emp_cursor INTO emp_record;
    RAISE NOTICE 'ID: %, Name: %', emp_record.id, emp_record.name;
    CLOSE emp_cursor;
END;
```

üîπ **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**

1. **–û—Ç–∫—Ä—ã–≤–∞–µ–º –∫—É—Ä—Å–æ—Ä.**
2. **–ò–∑–≤–ª–µ–∫–∞–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É** —Å –ø–æ–º–æ—â—å—é `FETCH`.
3. **–°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `emp_record`** (—Ç–∏–ø–∞ `RECORD`, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–ø—Ä–æ—Å–∞).
4. **–í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ.**
5. **–ó–∞–∫—Ä—ã–≤–∞–µ–º –∫—É—Ä—Å–æ—Ä.**

üìå **–ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –¥–ª—è `FETCH` (–≤ PL/pgSQL —Ç–æ–ª—å–∫–æ `1`, –∞ –≤ —á–∏—Å—Ç–æ–º SQL –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ):**

```sql
FETCH NEXT FROM emp_cursor INTO emp_record; -- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É
FETCH FIRST FROM emp_cursor INTO emp_record; -- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É
```

---

### **3.2. –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø–æ –∫—É—Ä—Å–æ—Ä—É (`MOVE`)**

–ö—É—Ä—Å–æ—Ä —Ö—Ä–∞–Ω–∏—Ç **—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–æ–∫—É**. –ú–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —ç—Ç–∏–º —É–∫–∞–∑–∞—Ç–µ–ª–µ–º —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã **`MOVE`**, –∫–æ—Ç–æ—Ä–∞—è **–ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –∫—É—Ä—Å–æ—Ä**, –Ω–æ **–Ω–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ**.

üìå **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `MOVE`:**

```sql
MOVE NEXT FROM emp_cursor; -- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É
MOVE PRIOR FROM emp_cursor; -- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–æ–∫—É
MOVE LAST FROM emp_cursor; -- –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–µ
MOVE FIRST FROM emp_cursor; -- –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ
MOVE 5 FROM emp_cursor; -- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å—Å—è –Ω–∞ 5 —Å—Ç—Ä–æ–∫ –≤–ø–µ—Ä–µ–¥
```

üí° **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω `MOVE`?**

- –ò–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ **–ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –ø–æ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö** –±–µ–∑ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
- –ü–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ **–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫** –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–∫–æ–π.

---

### **3.3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –∫—É—Ä—Å–æ—Ä–∞ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö**

**–í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å:** –∫—É—Ä—Å–æ—Ä—ã **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**.  
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –∫—É—Ä—Å–æ—Ä **–æ—Å—Ç–∞–≤–∞–ª—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**, –µ–≥–æ **–Ω—É–∂–Ω–æ –æ–±—ä—è–≤–∏—Ç—å —Å `WITH HOLD`**.

üìå **–ü—Ä–∏–º–µ—Ä:**

```sql
DECLARE emp_cursor CURSOR WITH HOLD FOR SELECT * FROM employees;
BEGIN
    OPEN emp_cursor;
    -- –ö—É—Ä—Å–æ—Ä –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º –¥–∞–∂–µ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    COMMIT;
END;
```

üîπ **–ß—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?**

- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫—É—Ä—Å–æ—Ä—ã –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ `COMMIT` –∏–ª–∏ `ROLLBACK`**.
- –ï—Å–ª–∏ –∫—É—Ä—Å–æ—Ä –æ–±—ä—è–≤–ª–µ–Ω —Å `WITH HOLD`, –æ–Ω –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º –∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

üí° **–ì–¥–µ —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–æ?**

- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –∫–ª–∏–µ–Ω—Ç –º–æ–≥ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫—É—Ä—Å–æ—Ä–æ–º –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
- –ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–±—É–µ—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**.

---

### **3.4. –ó–∞–∫—Ä—ã—Ç–∏–µ –∫—É—Ä—Å–æ—Ä–æ–≤ (`CLOSE`)**

–ü–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã —Å –∫—É—Ä—Å–æ—Ä–æ–º **–µ–≥–æ –Ω—É–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å**, —á—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã.

üìå **–ü—Ä–∏–º–µ—Ä –∑–∞–∫—Ä—ã—Ç–∏—è –∫—É—Ä—Å–æ—Ä–∞:**

```sql
CLOSE emp_cursor;
```

üìå **–ï—Å–ª–∏ –∫—É—Ä—Å–æ—Ä –±—ã–ª –æ–±—ä—è–≤–ª–µ–Ω –∫–∞–∫ `REFCURSOR`, —Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ç–∞–∫:**

```sql
CLOSE emp_cursor_name;
```

---

### **3.5. –í—ã–≤–æ–¥ –ø–æ —Ç—Ä–µ—Ç—å–µ–π —á–∞—Å—Ç–∏**

- `FETCH` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫** –∏–∑ –∫—É—Ä—Å–æ—Ä–∞.
- `MOVE` –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –ø–æ –∫—É—Ä—Å–æ—Ä—É **–±–µ–∑ –≤—ã–±–æ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö**.
- –ö—É—Ä—Å–æ—Ä—ã **–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**, –Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `WITH HOLD`, —á—Ç–æ–±—ã –æ–Ω–∏ –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏.
- **–ó–∞–∫—Ä—ã–≤–∞—Ç—å –∫—É—Ä—Å–æ—Ä—ã (`CLOSE`) –≤–∞–∂–Ω–æ** –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤.

---

üëâ **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –†–∞–∑–±–∏—Ä–∞–µ–º **—á–µ—Ç–≤–µ—Ä—Ç—É—é —á–∞—Å—Ç—å: "–†–∞–±–æ—Ç–∞ —Å –∫—É—Ä—Å–æ—Ä–∞–º–∏ –≤ —Ü–∏–∫–ª–∞—Ö"**?