### **–ö–æ–Ω—Å–ø–µ–∫—Ç. –ß–∞—Å—Ç—å 5: –§—É–Ω–∫—Ü–∏–∏ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º —á–∏—Å–ª–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (`VARIADIC`)**

–í —ç—Ç–æ–π —á–∞—Å—Ç–∏ —Ä–∞–∑–±–µ—Ä–µ–º, –∫–∞–∫ –º–∞—Å—Å–∏–≤—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å **—Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º —á–∏—Å–ª–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –≤ PostgreSQL, –≤–∫–ª—é—á–∞—è **–ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**.

---

## **1. –ß—Ç–æ —Ç–∞–∫–æ–µ `VARIADIC` –∏ –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω?**

–û–±—ã—á–Ω–æ, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ**:

```sql
CREATE FUNCTION sum_two_numbers(a INT, b INT) RETURNS INT AS $$
BEGIN
    RETURN a + b;
END $$ LANGUAGE plpgsql;
```

- –¢–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç **—Ä–æ–≤–Ω–æ –¥–≤–∞** –∞—Ä–≥—É–º–µ–Ω—Ç–∞.

–ù–æ —á—Ç–æ –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å **–ª—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ** —á–∏—Å–µ–ª?  
–î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `VARIADIC`, –∫–æ—Ç–æ—Ä—ã–π **–æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –º–∞—Å—Å–∏–≤**.

---

## **2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `VARIADIC` –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö**

–§—É–Ω–∫—Ü–∏—è, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è —Ç–∞–∫:

```sql
CREATE FUNCTION sum_numbers(VARIADIC arr INT[]) RETURNS INT AS $$
DECLARE
    total INT := 0;
    num INT;
BEGIN
    FOREACH num IN ARRAY arr LOOP
        total := total + num;
    END LOOP;
    RETURN total;
END $$ LANGUAGE plpgsql;
```

- `VARIADIC arr INT[]` ‚Äì –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –º–∞—Å—Å–∏–≤ `arr`.
- `FOREACH num IN ARRAY arr LOOP` ‚Äì –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞.
- `total := total + num;` ‚Äì –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç —Å—É–º–º—É –≤—Å–µ—Ö —á–∏—Å–µ–ª.

### **–ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞:**

```sql
SELECT sum_numbers(10, 20, 30, 40);
-- –í—ã–≤–µ–¥–µ—Ç: 100
```

```sql
SELECT sum_numbers(5, 15);
-- –í—ã–≤–µ–¥–µ—Ç: 20
```

üìå **–í–∞–∂–Ω–æ:**  
–ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å **–º–∞—Å—Å–∏–≤ –Ω–∞–ø—Ä—è–º—É—é**, –µ–≥–æ –Ω—É–∂–Ω–æ –æ–±–µ—Ä–Ω—É—Ç—å –≤ `VARIADIC`:

```sql
SELECT sum_numbers(VARIADIC ARRAY[1, 2, 3, 4]);
-- –í—ã–≤–µ–¥–µ—Ç: 10
```

–ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ **–±–µ–∑ `VARIADIC`**, PostgreSQL –≤–æ—Å–ø—Ä–∏–º–µ—Ç –µ–≥–æ –∫–∞–∫ **–æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç**:

```sql
SELECT sum_numbers(ARRAY[1, 2, 3, 4]);  
-- –û—à–∏–±–∫–∞: —Ç–∏–ø integer[] –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç integer
```

---

## **3. –ü–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å `VARIADIC`**

–ï—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è, —Ä–∞–±–æ—Ç–∞—é—â–∞—è —Å **—Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö**, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–µ —Ç–∏–ø—ã** (`ANYELEMENT`, `ANYARRAY`).

### **–ü—Ä–∏–º–µ—Ä: –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ä–µ–¥–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤**

```sql
CREATE FUNCTION max_variadic(VARIADIC arr ANYARRAY) RETURNS ANYELEMENT AS $$
DECLARE
    max_val ALIAS FOR arr[1]; -- –ü–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –∫–∞–∫ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    num ANYELEMENT;
BEGIN
    FOREACH num IN ARRAY arr LOOP
        IF num > max_val THEN
            max_val := num;
        END IF;
    END LOOP;
    RETURN max_val;
END $$ LANGUAGE plpgsql;
```

- **`ANYARRAY`** ‚Äì –º–∞—Å—Å–∏–≤ –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ **–ª—é–±–æ–≥–æ —Ç–∏–ø–∞**.
- **`ANYELEMENT`** ‚Äì —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ (—Ç–∏–ø –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏).
- **–ü–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `max_val`** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.

### **–ü—Ä–∏–º–µ—Ä—ã –≤—ã–∑–æ–≤–∞:**

```sql
SELECT max_variadic(10, 20, 30, 5);
-- –í—ã–≤–µ–¥–µ—Ç: 30
```

```sql
SELECT max_variadic('apple', 'banana', 'cherry');
-- –í—ã–≤–µ–¥–µ—Ç: cherry (–ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É)
```

```sql
SELECT max_variadic(VARIADIC ARRAY[2.5, 3.7, 1.2]);
-- –í—ã–≤–µ–¥–µ—Ç: 3.7
```

---

## **4. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ `VARIADIC` –∏ –æ–±—ã—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**

–ú–æ–∂–Ω–æ –æ–±—ä—è–≤–ª—è—Ç—å **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –ø–µ—Ä–µ–¥ `VARIADIC`:

```sql
CREATE FUNCTION concat_strings(separator TEXT, VARIADIC words TEXT[]) RETURNS TEXT AS $$
BEGIN
    RETURN array_to_string(words, separator);
END $$ LANGUAGE plpgsql;
```

- –ü–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `separator` **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π**.
- `VARIADIC words TEXT[]` **—Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –º–∞—Å—Å–∏–≤**.

### **–ü—Ä–∏–º–µ—Ä—ã –≤—ã–∑–æ–≤–∞:**

```sql
SELECT concat_strings(', ', 'apple', 'banana', 'cherry');
-- –í—ã–≤–µ–¥–µ—Ç: apple, banana, cherry
```

```sql
SELECT concat_strings(' - ', 'one', 'two', 'three');
-- –í—ã–≤–µ–¥–µ—Ç: one - two - three
```

---

## **5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `VARIADIC` –≤ `RETURN TABLE`**

–§—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç **–≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π**, –∏—Å–ø–æ–ª—å–∑—É—è `VARIADIC` –∏ `RETURNS TABLE`.

### **–ü—Ä–∏–º–µ—Ä: –†–∞–∑–±–∏–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ –º–∞—Å—Å–∏–≤ –∏ –≤–æ–∑–≤—Ä–∞—Ç –∫–∞–∫ —Ç–∞–±–ª–∏—Ü—ã**

```sql
CREATE FUNCTION split_string(separator TEXT, input TEXT) 
RETURNS TABLE(word TEXT) AS $$
BEGIN
    RETURN QUERY 
    SELECT unnest(string_to_array(input, separator));
END $$ LANGUAGE plpgsql;
```

### **–ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞:**

```sql
SELECT * FROM split_string(',', 'apple,banana,cherry');
```

**–í—ã–≤–æ–¥:**

```
word
------
apple
banana
cherry
```

---

## **6. –ò—Ç–æ–≥**

- `VARIADIC` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å **–ª—é–±–æ–µ —á–∏—Å–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**.
- –í—Å–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã `VARIADIC` **—Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤**.
- `FOREACH` —É–¥–æ–±–µ–Ω –¥–ª—è **–ø–µ—Ä–µ–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞**.
- –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å **–ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** —Å `ANYARRAY` –∏ `ANYELEMENT`.
- `VARIADIC` –º–æ–∂–Ω–æ **–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å –æ–±—ã—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏**.

---

üëâ –í —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ —Ä–∞–∑–±–µ—Ä–µ–º **–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**, –≤–∫–ª—é—á–∞—è **–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏** –∏ —Ä–∞–±–æ—Ç—É —Å —Ç–µ–≥–∞–º–∏ –≤ –±–ª–æ–≥–∞—Ö. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º? üöÄ