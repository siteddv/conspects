–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ **–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**.  
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç —Ç—Ä–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è:  
1Ô∏è‚É£ **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏** –≤ –∏—Å—Ç–æ—á–Ω–∏–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –µ—ë –ø–æ—è–≤–ª–µ–Ω–∏—è –≤ `Core`-—Å–ª–æ–µ.  
2Ô∏è‚É£ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏** –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–ª–∏—Å—å.  
3Ô∏è‚É£ **–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏** –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –æ–Ω–∞ –±–æ–ª—å—à–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ `Core`-—Å–ª–æ–µ.

---

### **üîç –¢–µ—Å—Ç 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏**

**–î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –≤ `public.inventory` (–∏—Å—Ç–æ—á–Ω–∏–∫):**

```sql
INSERT INTO public.inventory (inventory_id, film_id, store_id, last_update)
VALUES (9999, 5, 2, CURRENT_TIMESTAMP);
```

- –ù–æ–≤—ã–π **`inventory_id = 9999`**, **`film_id = 5`**, **`store_id = 2`**.

**–ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∑–∞–≥—Ä—É–∑–∫–∏ –≤ `Staging`:**

```sql
CALL staging.load_inventory();
```

**–ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∑–∞–≥—Ä—É–∑–∫–∏ –≤ `Core`:**

```sql
CALL core.load_inventory();
```

**–ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ–±–∞–≤–∏–ª–∞—Å—å –ª–∏ –∑–∞–ø–∏—Å—å –≤ `Core`:**

```sql
SELECT * FROM core.inventory WHERE inventory_id = 9999;
```

‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –∑–∞–ø–∏—Å—å **–¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è** –≤ `core.inventory`.

---

### **üîç –¢–µ—Å—Ç 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏**

**–û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ (`public.inventory`):**

```sql
UPDATE public.inventory 
SET film_id = 10, last_update = CURRENT_TIMESTAMP 
WHERE inventory_id = 9999;
```

- –¢–µ–ø–µ—Ä—å **`film_id = 10`** –≤–º–µ—Å—Ç–æ 5.

**–ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏ (`Staging` –∏ `Core`):**

```sql
CALL staging.load_inventory();
CALL core.load_inventory();
```

**–ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ `Core`:**

```sql
SELECT * FROM core.inventory WHERE inventory_id = 9999;
```

‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –∑–∞–ø–∏—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å **–æ–±–Ω–æ–≤–ª–µ–Ω–∞** ‚Äì `film_id = 10`.

---

### **üîç –¢–µ—Å—Ç 3: –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏**

**–ü–æ–º–µ—á–∞–µ–º –∑–∞–ø–∏—Å—å –∫–∞–∫ —É–¥–∞–ª—ë–Ω–Ω—É—é –≤ `public.inventory`:**

```sql
UPDATE public.inventory 
SET deleted_at = CURRENT_TIMESTAMP 
WHERE inventory_id = 9999;
```

**–ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏:**

```sql
CALL staging.load_inventory();
CALL core.load_inventory();
```

**–ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å—å –≤ `Core`:**

```sql
SELECT * FROM core.inventory WHERE inventory_id = 9999;
```

‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** **–∑–∞–ø–∏—Å—å –¥–æ–ª–∂–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å** –≤ `core.inventory`.

---

### **üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏**

–ï—Å–ª–∏ **–¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è**: ‚úî –ü—Ä–æ–≤–µ—Ä–∏—Ç—å **`last_update`** –≤ `staging.last_update`.  
‚úî –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ **–∑–∞–ø–∏—Å–∏ –Ω–µ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è** –∏–∑-–∑–∞ `last_update_dt`.

–ï—Å–ª–∏ **—É–¥–∞–ª—ë–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –Ω–µ –∏—Å—á–µ–∑–∞–µ—Ç**:  
‚úî –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, **–µ—Å—Ç—å –ª–∏ `deleted_at IS NOT NULL` –≤ `staging.inventory`**.  
‚úî –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ **–ø—Ä–æ—Ü–µ–¥—É—Ä–∞ `DELETE` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**.

---

### **‚úÖ –ò—Ç–æ–≥: —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏?**

‚úî **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç**.  
‚úî **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è**.  
‚úî **–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ**.  
‚úî **–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–æ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**.