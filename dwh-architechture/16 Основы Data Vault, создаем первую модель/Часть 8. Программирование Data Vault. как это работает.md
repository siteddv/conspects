### **üìå –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã —ç—Ç–æ–π —á–∞—Å—Ç–∏:**

- **–ö–∞–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å—Ö–µ–º—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏.**
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π (Hash Keys vs Integer Keys).**
- **–ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö.**
- **–†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã SQL-–∑–∞–ø—Ä–æ—Å–æ–≤.**

---

## **üîπ 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏**

üìå **–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Data Vault, –Ω—É–∂–Ω–æ:**

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –±–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏** (ID –æ–±—ä–µ–∫—Ç–æ–≤).
2. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–≤—è–∑–∏ –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏** (–∫–∞–∫–∏–µ –ø–æ–ª—è —Å–æ–µ–¥–∏–Ω—è—é—Ç —Ç–∞–±–ª–∏—Ü—ã).
3. **–í—ã–¥–µ–ª–∏—Ç—å –∏–∑–º–µ–Ω—è–µ–º—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã** (—á—Ç–æ –ø–æ–ø–∞–¥—ë—Ç –≤ Satellites).
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É** (–∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∏–ª–∏ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ).

üìå **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π:**

|Film_ID|Title|Genre|Rating|Release_Year|Actor_ID|Customer_ID|Payment_Amount|
|---|---|---|---|---|---|---|---|
|1001|"The Matrix"|Sci-Fi|R|1999|200|3001|4.99|
|1002|"Titanic"|Drama|PG-13|1997|201|3002|3.99|

üìå **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ Data Vault:**  
‚úÖ **Film_ID, Actor_ID, Customer_ID ‚Üí Hubs.**  
‚úÖ **–°–≤—è–∑–∏ –º–µ–∂–¥—É –Ω–∏–º–∏ (Film_Actor, Customer_Rental) ‚Üí Links.**  
‚úÖ **–ê—Ç—Ä–∏–±—É—Ç—ã (Title, Genre, Rating, Payment_Amount) ‚Üí Satellites.**

---

## **üîπ 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π (Hash Keys vs Integer Keys) üîë**

üìå **–ö–∞–∫–∏–µ –±—ã–≤–∞—é—Ç —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏?**

1. **Integer Keys (ID, Autoincrement)** ‚Äì —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–±—ã—Å—Ç—Ä—ã–π, –Ω–æ –Ω–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π).
2. **Hash Keys (MD5, SHA256)** ‚Äì –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ Data Vault 2.0 (–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å).

üìå **–ü–æ—á–µ–º—É –≤ Data Vault 2.0 –∏—Å–ø–æ–ª—å–∑—É—é—Ç Hash Keys?**  
‚úÖ **–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π.**  
‚úÖ **–ü–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º (–≥–¥–µ –Ω–µ—Ç –µ–¥–∏–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ID).**  
‚úÖ **–ù–µ —Ç—Ä–µ–±—É—é—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏.**  
‚úÖ **–û–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.**

üìå **–ü—Ä–∏–º–µ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Hash Key –≤ SQL:**

```sql
SELECT 
  MD5(CAST(Film_ID AS VARCHAR)) AS Film_HashKey,
  MD5(CAST(Actor_ID AS VARCHAR)) AS Actor_HashKey
FROM Source_Data;
```

üìå **–ü—Ä–∏–º–µ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Hash Key –¥–ª—è Links:**

```sql
SELECT 
  MD5(CONCAT(Film_HashKey, Actor_HashKey)) AS Film_Actor_HashKey
FROM Film_Actor_Link;
```

üìå **–ö–æ–≥–¥–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Integer Keys?**

- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è **–≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –±–∞–∑—ã** –∏ –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏.
- –ï—Å–ª–∏ **–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, ClickHouse).
- –ï—Å–ª–∏ **–∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —á–∏—Å–ª–æ–≤—ã–µ –∫–ª—é—á–∏ –∏ –æ–Ω–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã**.

---

## **üîπ 3. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Hubs, Links –∏ Satellites**

üìå **–û–±—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Data Vault:**

1. **–ó–∞–≥—Ä—É–∂–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏ –≤ Hubs.**
2. **–°–æ–∑–¥–∞—ë–º —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏ –≤ Links.**
3. **–ó–∞–≥—Ä—É–∂–∞–µ–º –∞—Ç—Ä–∏–±—É—Ç—ã –≤ Satellites (—Å —Ñ–∏–∫—Å–∞—Ü–∏–µ–π –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏).**

üìå **–ü—Ä–∏–º–µ—Ä SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Hub Film:**

```sql
INSERT INTO Hub_Film (Film_HashKey, Film_ID, Load_Date, Record_Source)
SELECT DISTINCT
  MD5(CAST(Film_ID AS VARCHAR)) AS Film_HashKey,
  Film_ID,
  NOW() AS Load_Date,
  'CRM_System' AS Record_Source
FROM Source_Films
WHERE NOT EXISTS (
  SELECT 1 FROM Hub_Film WHERE Hub_Film.Film_HashKey = MD5(CAST(Source_Films.Film_ID AS VARCHAR))
);
```

üìå **–†–∞–∑–±–æ—Ä –∑–∞–ø—Ä–æ—Å–∞:**  
‚úÖ **MD5(Film_ID)** ‚Äì —Å–æ–∑–¥–∞—ë–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á.  
‚úÖ **`DISTINCT`** ‚Äì –∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏.  
‚úÖ **`WHERE NOT EXISTS`** ‚Äì –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã.

üìå **–ü—Ä–∏–º–µ—Ä SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Link Film_Actor:**

```sql
INSERT INTO Link_Film_Actor (Film_Actor_HashKey, Film_HashKey, Actor_HashKey, Load_Date, Record_Source)
SELECT DISTINCT
  MD5(CONCAT(Film_HashKey, Actor_HashKey)) AS Film_Actor_HashKey,
  Film_HashKey,
  Actor_HashKey,
  NOW() AS Load_Date,
  'IMDB_API' AS Record_Source
FROM Source_Film_Actor
WHERE NOT EXISTS (
  SELECT 1 FROM Link_Film_Actor 
  WHERE Link_Film_Actor.Film_Actor_HashKey = MD5(CONCAT(Film_HashKey, Actor_HashKey))
);
```

üìå **–ü—Ä–∏–º–µ—Ä SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Satellite Film Attributes:**

```sql
INSERT INTO Sat_Film_Attributes (Film_HashKey, Load_Date, End_Date, Title, Genre, Rating, Hash_Diff, Record_Source)
SELECT 
  Film_HashKey,
  NOW() AS Load_Date,
  NULL AS End_Date,
  Title,
  Genre,
  Rating,
  MD5(CONCAT(Title, Genre, Rating)) AS Hash_Diff,
  'CRM_System' AS Record_Source
FROM Source_Films
WHERE NOT EXISTS (
  SELECT 1 FROM Sat_Film_Attributes 
  WHERE Sat_Film_Attributes.Film_HashKey = Source_Films.Film_HashKey
  AND Sat_Film_Attributes.Hash_Diff = MD5(CONCAT(Source_Films.Title, Source_Films.Genre, Source_Films.Rating))
);
```

üìå **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**  
‚úÖ **–ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –¥–∞–Ω–Ω—ã–µ (Hash_Diff).**  
‚úÖ **–ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –µ—Å—Ç—å ‚Äì —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å.**  
‚úÖ **–ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ—Ç ‚Äì –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã.**

---

## **üîπ 4. –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**

üìå **–ö–∞–∫ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∏–ª–∏ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ?**

- **–ò—Å–ø–æ–ª—å–∑—É–µ–º Load Date** ‚Äì –∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏.
- **–°—Ä–∞–≤–Ω–∏–≤–∞–µ–º Hash Diff** ‚Äì –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã.
- **–ó–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö (End Date).**

üìå **–ü—Ä–∏–º–µ—Ä –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏:**

```sql
UPDATE Sat_Film_Attributes
SET End_Date = NOW()
WHERE Film_HashKey IN (
  SELECT Film_HashKey FROM Source_Films
)
AND End_Date IS NULL
AND Hash_Diff <> MD5(CONCAT(Title, Genre, Rating));
```

üìå **–ß—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?**  
‚úÖ **–û–±–Ω–æ–≤–ª—è–µ–º End Date —É —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π, –µ—Å–ª–∏ –∞—Ç—Ä–∏–±—É—Ç—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å.**  
‚úÖ **–ó–∞—Ç–µ–º –∑–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é —Å –Ω–æ–≤—ã–º Load Date.**

---

### **üìå –í—ã–≤–æ–¥—ã –∏–∑ –≤–æ—Å—å–º–æ–π —á–∞—Å—Ç–∏:**

‚úÖ **Data Vault –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Hash Keys –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø–∏—Å–µ–π.**  
‚úÖ **Hubs —Ö—Ä–∞–Ω—è—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ –±–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏.**  
‚úÖ **Links —Å–≤—è–∑—ã–≤–∞—é—Ç Hubs –±–µ–∑ –∞—Ç—Ä–∏–±—É—Ç–æ–≤.**  
‚úÖ **Satellites —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Å Load Date –∏ Hash Diff.**  
‚úÖ **SQL-–∑–∞–ø—Ä–æ—Å—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ.**