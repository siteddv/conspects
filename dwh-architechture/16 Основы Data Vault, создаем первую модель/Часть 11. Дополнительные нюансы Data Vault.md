### **üìå –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã —ç—Ç–æ–π —á–∞—Å—Ç–∏:**

- **–ü–æ–ª–µ Last Seen Date (–∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏).**
- **–ü–æ—á–µ–º—É –≤–∞–∂–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Record Source.**
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Hash Diff –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö.**
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–∞–ª-—Ç–∞–π–º –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ Data Vault.**

---

## **üîπ 1. –ü–æ–ª–µ Last Seen Date ‚Äì –∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏?**

üìå **–ü—Ä–æ–±–ª–µ–º–∞:**

- –í Data Vault –º—ã **–Ω–µ —É–¥–∞–ª—è–µ–º** –∑–∞–ø–∏—Å–∏ (–≤—Å—ë –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞).
- –ù–æ –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, **–∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –æ–±—ä–µ–∫—Ç** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∏–µ–Ω—Ç –∏–ª–∏ —Ç–æ–≤–∞—Ä).
- –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –∏—Å—á–µ–∑ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –º—ã **–Ω–µ –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ –µ–≥–æ —É–¥–∞–ª–∏—Ç—å**.

üìå **–†–µ—à–µ–Ω–∏–µ: –ü–æ–ª–µ Last Seen Date**

- **Last Seen Date** ‚Äì —ç—Ç–æ –¥–∞—Ç–∞, –∫–æ–≥–¥–∞ –∑–∞–ø–∏—Å—å **–ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –±—ã–ª–∞ –∑–∞–º–µ—á–µ–Ω–∞** –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ.
- –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç **–Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∫–æ–µ-—Ç–æ –≤—Ä–µ–º—è**, –º—ã –º–æ–∂–µ–º –ø–æ–º–µ—Ç–∏—Ç—å –µ–≥–æ –∫–∞–∫ **"–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π"**.

üìå **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Last Seen Date:**

|Film_HashKey|Film_ID|Load_Date|Last_Seen_Date|
|---|---|---|---|
|`HASH(1001)`|1001|2025-02-02|2025-05-01|
|`HASH(1002)`|1002|2025-02-02|2025-07-15|

üìå **–ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å Last Seen Date?**

```sql
UPDATE Hub_Film
SET Last_Seen_Date = NOW()
WHERE Film_ID IN (SELECT Film_ID FROM Source_Films);
```

üìå **–ö–∞–∫ –Ω–∞—Ö–æ–¥–∏—Ç—å "–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ" –∑–∞–ø–∏—Å–∏?**

```sql
SELECT Film_ID 
FROM Hub_Film
WHERE Last_Seen_Date < NOW() - INTERVAL '6 months';
```

‚úÖ –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å **–Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–∞—Å—å 6 –º–µ—Å—è—Ü–µ–≤**, —Å—á–∏—Ç–∞–µ–º –µ—ë **—É—Å—Ç–∞—Ä–µ–≤—à–µ–π**.  
‚úÖ –≠—Ç–æ **–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É —É–¥–∞–ª–µ–Ω–∏—é** –∑–∞–ø–∏—Å–µ–π.

---

## **üîπ 2. –ü–æ—á–µ–º—É –≤–∞–∂–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Record Source?**

üìå **–ß—Ç–æ —Ç–∞–∫–æ–µ Record Source?**

- –≠—Ç–æ –ø–æ–ª–µ, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ **–∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** (–∏–∑ –∫–∞–∫–æ–π —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏—à–ª–∞ –∑–∞–ø–∏—Å—å).
- –ü–æ–∑–≤–æ–ª—è–µ—Ç **—Ä–∞–∑–¥–µ–ª—è—Ç—å** –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.
- –ü–æ–º–æ–≥–∞–µ—Ç **–æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏** –∏ **–∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö**.

üìå **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Record Source:**

|Film_HashKey|Film_ID|Load_Date|Record_Source|
|---|---|---|---|
|`HASH(1001)`|1001|2025-02-02|`CRM_System`|
|`HASH(1001)`|1001|2025-02-03|`IMDB_API`|

üìå **–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Record Source –≤ SQL?**

```sql
SELECT Film_ID, Title, Record_Source
FROM Sat_Film_Attributes
WHERE Record_Source = 'CRM_System';
```

‚úÖ **–ú–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.**  
‚úÖ **–ú–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—à–ª–∞ –æ—à–∏–±–∫–∞.**

üìå **–í–∞–∂–Ω–æ!**

- –ï—Å–ª–∏ **–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∏—Å—Ç–µ–º**, –º–æ–≥—É—Ç –±—ã—Ç—å **—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö**.
- –ù–∞–ø—Ä–∏–º–µ—Ä, **—Ä–∞–∑–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∏–ª—å–º–æ–≤** –≤ CRM –∏ IMDB.

üìå **–ö–∞–∫ –Ω–∞–π—Ç–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏?**

```sql
SELECT f1.Film_ID, f1.Title AS CRM_Title, f2.Title AS IMDB_Title
FROM Sat_Film_Attributes f1
JOIN Sat_Film_Attributes f2 ON f1.Film_HashKey = f2.Film_HashKey
WHERE f1.Record_Source = 'CRM_System' 
AND f2.Record_Source = 'IMDB_API'
AND f1.Title <> f2.Title;
```

‚úÖ –í–∏–¥–∏–º —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∏–∑ CRM –∏ IMDB.  
‚úÖ –ú–æ–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–µ.

---

## **üîπ 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Hash Diff –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö**

üìå **–ß—Ç–æ —Ç–∞–∫–æ–µ Hash Diff?**

- –≠—Ç–æ **–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞** (`MD5`, `SHA256`) –≤—Å–µ—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –≤ Satellite.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç **–±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –¥–∞–Ω–Ω—ã–µ**.

üìå **–ü—Ä–∏–º–µ—Ä Hash Diff:**

|Film_HashKey|Title|Genre|Rating|Load_Date|Hash_Diff|
|---|---|---|---|---|---|
|`HASH(1001)`|"The Matrix"|Sci-Fi|R|2025-02-02|`HASH(The Matrix, Sci-Fi, R)`|
|`HASH(1001)`|"The Matrix Reloaded"|Sci-Fi|R|2025-06-01|`HASH(The Matrix Reloaded, Sci-Fi, R)`|

üìå **–ö–∞–∫ –≤—ã—á–∏—Å–ª—è—Ç—å Hash Diff?**

```sql
SELECT 
  Film_HashKey,
  Title,
  Genre,
  Rating,
  NOW() AS Load_Date,
  MD5(CONCAT(Title, Genre, Rating)) AS Hash_Diff
FROM Source_Films;
```

üìå **–ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –¥–∞–Ω–Ω—ã–µ?**

```sql
SELECT *
FROM Sat_Film_Attributes
WHERE Hash_Diff <> MD5(CONCAT(Title, Genre, Rating));
```

‚úÖ –ï—Å–ª–∏ `Hash_Diff` –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Üí —Å–æ–∑–¥–∞—ë–º **–Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é** –∑–∞–ø–∏—Å–∏.  
‚úÖ –ï—Å–ª–∏ `Hash_Diff` –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Üí **–Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã**.

üìå **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Hash Diff:**  
‚úÖ –£–º–µ–Ω—å—à–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –±–∞–∑—É (–Ω–µ –Ω—É–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –≤—Å–µ –ø–æ–ª—è –≤—Ä—É—á–Ω—É—é).  
‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.  
‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö.

---

## **üîπ 4. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–∞–ª-—Ç–∞–π–º –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ Data Vault**

üìå **–ö–∞–∫ Data Vault —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –ø–æ—Ç–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏?**

- Data Vault **–ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è real-time –æ–±—Ä–∞–±–æ—Ç–∫–∏**, –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **CDC (Change Data Capture)** –∏–ª–∏ **Kafka** –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
- –ú–æ–∂–Ω–æ **–∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—Ä—Ü–∏—è–º–∏**, –æ–±–Ω–æ–≤–ª—è—è **—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–∏–≤—à–∏–µ—Å—è –∑–∞–ø–∏—Å–∏**.

üìå **–ü—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã –¥–ª—è —Ä–µ–∞–ª-—Ç–∞–π–º –∑–∞–≥—Ä—É–∑–∫–∏:**

```
[ Kafka / CDC ] ‚Üí [ Raw Data Vault ] ‚Üí [ Business Vault ] ‚Üí [ Data Marts ]
```

üìå **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ç–∞ —Å—Ö–µ–º–∞?**  
1Ô∏è‚É£ **Kafka –∏–ª–∏ CDC —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö.**  
2Ô∏è‚É£ **Raw Data Vault** –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (Hubs, Links, Satellites).  
3Ô∏è‚É£ **Business Vault** –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –æ—Ç—á—ë—Ç—ã.  
4Ô∏è‚É£ **Data Marts** –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º.

üìå **–ö–∞–∫ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Data Vault –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏?**

```sql
INSERT INTO Sat_Film_Attributes (Film_HashKey, Load_Date, Title, Genre, Rating, Hash_Diff, Record_Source)
SELECT 
  Film_HashKey,
  NOW(),
  Title,
  Genre,
  Rating,
  MD5(CONCAT(Title, Genre, Rating)) AS Hash_Diff,
  'RealTime_Source'
FROM Streaming_Film_Updates;
```

‚úÖ –ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—É–ø–∞—é—Ç **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ**.  
‚úÖ –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–∏–≤—à–∏–µ—Å—è –∑–∞–ø–∏—Å–∏**.  
‚úÖ –í—Å—è –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.

üìå **–ì–¥–µ —É–∂–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç —Ä–µ–∞–ª-—Ç–∞–π–º Data Vault?**  
‚úÖ –í –±–∞–Ω–∫–∞—Ö (–æ–Ω–ª–∞–π–Ω-–ø–ª–∞—Ç–µ–∂–∏).  
‚úÖ –í —Ä–∏—Ç–µ–π–ª–µ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω, —Å–∫–∏–¥–æ–∫).  
‚úÖ –í –ª–æ–≥–∏—Å—Ç–∏–∫–µ (–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤).

---

### **üìå –í—ã–≤–æ–¥—ã –∏–∑ –æ–¥–∏–Ω–Ω–∞–¥—Ü–∞—Ç–æ–π —á–∞—Å—Ç–∏:**

‚úÖ **Last Seen Date** –ø–æ–º–æ–≥–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏.  
‚úÖ **Record Source** –Ω—É–∂–µ–Ω –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º.  
‚úÖ **Hash Diff** —É—Å–∫–æ—Ä—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏–π.  
‚úÖ **Data Vault –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç real-time –∞–Ω–∞–ª–∏—Ç–∏–∫—É —á–µ—Ä–µ–∑ CDC / Kafka.**