### **7.1 –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ**

–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—Ç **–∑–∞–¥–∞–Ω–∏—è –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã**, —á—Ç–æ–±—ã –∑–∞–∫—Ä–µ–ø–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª:

#### **üìå 1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∑–∞–≥—Ä—É–∑–∫–∏ `fact_rental`**

- –ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π `fact_payment`, –Ω–æ:
    - –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ‚Äì `staging.rental`.
    - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å `core.dim_inventory` –∏ `core.dim_staff`.
    - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ `inventory_fk`, `staff_fk`, `rental_date`.
    - –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç —Å—É–º–º—ã –ø–ª–∞—Ç–µ–∂–µ–π (`amount`) –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ü–∏–π (`count`).

#### **üìå 2. –°–æ–∑–¥–∞—Ç—å SQL-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è `staging` –∏ `core`-—Å–ª–æ–µ–≤**

- –í —Ñ–∞–π–ª–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
    - **–£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä** (–µ—Å–ª–∏ –æ–Ω–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç).
    - **–°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –∑–∞–Ω–æ–≤–æ**.
    - **–°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä –∑–∞–Ω–æ–≤–æ**.
    - **–í—ã–∑–æ–≤ `full_load()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã**.

üí° **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**

- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–≥–æ—Ç–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–∑ –∑–∞–Ω—è—Ç–∏—è**.
- –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç —ç—Ç–æ—Ç SQL-—Å–∫—Ä–∏–ø—Ç, —É –Ω–µ–≥–æ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å–æ–∑–¥–∞–ª–æ—Å—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** –∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

#### **üìå 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∑–∞–≥—Ä—É–∑–∫–∏ (`full_load()`)**

- –î–æ–±–∞–≤–∏—Ç—å **–Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ `staging.rental`** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —Å –ø–æ–º–æ—â—å—é SQL-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞).
- –ó–∞–ø—É—Å—Ç–∏—Ç—å `full_load()`.
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ **–ø–æ—è–≤–∏–ª–∏—Å—å –≤ `fact_rental`**.

---

### **7.2 –û–±—Å—É–∂–¥–µ–Ω–∏–µ –±—É–¥—É—â–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ **–¥–∞–ª—å–Ω–µ–π—à–∏—Ö —à–∞–≥–∞—Ö** –≤ —Ä–∞–±–æ—Ç–µ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º:

1. **üìä –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤**
    
    - –í —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–Ω—è—Ç–∏–∏ —Å–æ–∑–¥–∞–¥–∏–º **–≤–∏—Ç—Ä–∏–Ω—É –¥–∞–Ω–Ω—ã—Ö (Data Mart)**.
    - –ü–æ–¥–≥–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.
    - **–°–¥–µ–ª–∞–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ Power BI).
2. **üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞**
    
    - –°–µ–π—á–∞—Å –ø–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ **–∑–∞–Ω–∏–º–∞–µ—Ç 9 —Å–µ–∫—É–Ω–¥**.
    - **–ü–æ—á–µ–º—É?** ‚Äì —Å–ª–æ–∂–Ω—ã–µ `JOIN`, –Ω–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤.
    - **–ö–∞–∫ —É—Å–∫–æ—Ä–∏—Ç—å?** ‚Äì —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º **—Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤, –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**.
3. **üîÑ –ü–µ—Ä–µ—Ö–æ–¥ –∫ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ**
    
    - –°–µ–π—á–∞—Å –º—ã **–∫–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–Ω–æ–≤–æ**.
    - –≠—Ç–æ **–Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º—É** –∏ **–ø–ª–æ—Ö–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**.
    - –ë—É–¥–µ–º **–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ** (–∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ).

---

### **7.3 –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã**

- –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç –≤—Å–µ—Ö –∑–∞ —Ä–∞–±–æ—Ç—É.
- –ù–∞–ø–æ–º–∏–Ω–∞–µ—Ç, —á—Ç–æ **–º–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã** –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏.
- –ó–∞–≤–µ—Ä—à–∞–µ—Ç –∑–∞–Ω—è—Ç–∏–µ —Å –ø–æ–∂–µ–ª–∞–Ω–∏–µ–º **—Ö–æ—Ä–æ—à–µ–π –Ω–µ–¥–µ–ª–∏**.

---

### **–í—ã–≤–æ–¥—ã –ø–æ —ç—Ç–æ–π —á–∞—Å—Ç–∏**

‚úÖ **–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–æ –¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ `fact_rental`, –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `full_load()`).**  
‚úÖ **–û–∑–≤—É—á–µ–Ω—ã –ø–ª–∞–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–Ω—è—Ç–∏—è: —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞.**  
‚úÖ **–ó–∞–Ω—è—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–æ–ª—É—á–∏–ª–∏ —á–µ—Ç–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.**