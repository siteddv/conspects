На этом этапе разрабатываются **стейджинг-таблицы** для загрузки данных перед их дальнейшей обработкой.

### 2.1 Анализ исходных таблиц

Прежде чем создавать стейджинг-таблицы, нужно понять, **какие поля** есть в исходных таблицах (`inventory`, `rental`, `payment`).

- Открываются **таблицы-источники** и анализируются их поля.
- Определяются **обязательные (NOT NULL) и необязательные** поля.
- Все поля в стейджинг-таблицах должны **соответствовать** полям исходных таблиц, но сохраняться отдельно.

### 2.2 Создание таблицы `staging_inventory`

- Выбираются **ключевые поля**:
    - `inventory_id` (идентификатор инвентаря)
    - `film_id` (идентификатор фильма)
    - `store_id` (идентификатор магазина)
- Определяется их **тип данных** и **обязательность**.
- Создается SQL-скрипт для **создания таблицы `staging_inventory`**.

### 2.3 Создание таблицы `staging_rental`

- Анализируются **ключевые поля** в таблице `rental`:
    - `rental_id` (идентификатор аренды)
    - `rental_date` (дата аренды)
    - `inventory_id` (идентификатор инвентаря)
    - `customer_id` (идентификатор клиента)
    - `return_date` (дата возврата, **может быть NULL**)
    - `staff_id` (идентификатор сотрудника)
- Создается SQL-скрипт для **создания таблицы `staging_rental`**.

### 2.4 Создание таблицы `staging_payment`

- Анализируются **ключевые поля** в таблице `payment`:
    - `payment_id` (идентификатор платежа)
    - `customer_id` (идентификатор клиента)
    - `staff_id` (идентификатор сотрудника)
    - `rental_id` (идентификатор аренды)
    - `amount` (сумма платежа)
    - `payment_date` (дата платежа)
- Создается SQL-скрипт для **создания таблицы `staging_payment`**.

### Итог

Теперь в базе данных **есть три стейджинг-таблицы**, которые будут использоваться для загрузки данных. Они полностью соответствуют структуре исходных таблиц, но предназначены **только для временного хранения данных** перед их обработкой.