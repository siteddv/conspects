## **üìå 7.1 –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–∏ DWH –ø–æ –ò–Ω–º–∞–Ω—É**

–í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ò–Ω–º–∞–Ω–∞ –¥–∞–Ω–Ω—ã–µ **–ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤**, –ø—Ä–µ–∂–¥–µ —á–µ–º —Å—Ç–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:

1Ô∏è‚É£ **Staging (—Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)**  
2Ô∏è‚É£ **ODS (–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏)**  
3Ô∏è‚É£ **Reference (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏)**  
4Ô∏è‚É£ **Integration (–¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ä–∞—Å—á–µ—Ç–æ–≤)**  
5Ô∏è‚É£ **DDS (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)**  
6Ô∏è‚É£ **Data Marts (–≤–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è BI –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏)**

üìå **–ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Å—Ö–µ–º–∞?**

```
[ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (ERP, CRM, API, —Ñ–∞–π–ª—ã) ]
        ‚Üì (ETL)
[ Staging Layer (—Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ) ]
        ‚Üì (ETL)
[ ODS Layer (–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ) ]
        ‚Üì (ETL)
[ Reference Layer (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤) ]
        ‚Üì (ETL)
[ Integration Layer (—Ä–∞—Å—á–µ—Ç—ã, –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ) ]
        ‚Üì (ETL)
[ DDS Layer (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ) ]
        ‚Üì (ETL)
[ Data Marts (—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã) ]
        ‚Üì
[ BI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: Power BI, Tableau, Looker ]
```

‚úÖ **–î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π, –æ—á–∏—â–∞—é—Ç—Å—è, –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —É–¥–æ–±–Ω—ã–º–∏ –¥–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏**.

---

## **üìå 7.2 Staging Layer ‚Äì ¬´–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö¬ª**

üìå **–ß—Ç–æ —ç—Ç–æ?**  
Staging ‚Äì —ç—Ç–æ **–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ª–æ–π**, –≤ –∫–æ—Ç–æ—Ä—ã–π **–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ** –∏–∑ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (ERP, CRM, API, —Ñ–∞–π–ª—ã).

üìä **–ü—Ä–∏–Ω—Ü–∏–ø—ã Staging Layer:**

- **–°—é–¥–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π**.
- **–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–æ** (–æ–±—ã—á–Ω–æ 1‚Äì2 –¥–Ω—è).
- **–í–æ–∑–º–æ–∂–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –æ—à–∏–±–∫–∏** ‚Äì –∑–¥–µ—Å—å –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è.

üìå **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Staging-—Å–ª–æ—è**

```sql
CREATE TABLE staging.sales_raw (
    id INT,
    date TIMESTAMP,
    product_id INT,
    amount DECIMAL(10,2),
    status VARCHAR(50)
);
```

‚úÖ **Staging = –ø—Ä–æ—Å—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö.**

---

## **üìå 7.3 ODS Layer ‚Äì ¬´–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ¬ª**

üìå **–ß—Ç–æ —ç—Ç–æ?**  
**ODS (Operational Data Store)** ‚Äì —ç—Ç–æ **—Å–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**.  
üí° **ODS ‚Äì —ç—Ç–æ ¬´–∑–µ—Ä–∫–∞–ª–æ¬ª —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.**

üìä **–ü—Ä–∏–Ω—Ü–∏–ø—ã ODS Layer:**

- **–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏** ‚Äì –¥–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π**.
- **–î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**.
- **ODS –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç–æ (–ø–æ—á—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏).**

üìå **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã ODS-—Å–ª–æ—è**

```sql
CREATE TABLE ods.sales (
    id INT PRIMARY KEY,
    date TIMESTAMP,
    product_id INT,
    amount DECIMAL(10,2),
    status VARCHAR(50)
);
```

‚úÖ **ODS = –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏.**

---

## **üìå 7.4 Reference Layer ‚Äì ¬´–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤¬ª**

üìå **–ß—Ç–æ —ç—Ç–æ?**  
Reference Layer ‚Äì —ç—Ç–æ **—Å–ª–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏, –≥–¥–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π**.  
üí° **–ï—Å–ª–∏ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª–∏–µ–Ω—Ç –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (CRM, ERP), Reference Layer –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –µ–º—É –µ–¥–∏–Ω—ã–π ID.**

üìä **–ü—Ä–∏–Ω—Ü–∏–ø—ã Reference Layer:**

- **–°–æ–∑–¥–∞—é—Ç—Å—è —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ (SK ‚Äì Surrogate Key).**
- **–°–≤—è–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –≤ –µ–¥–∏–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.**
- **–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏.**

üìå **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Reference-—Å–ª–æ—è**

```sql
CREATE TABLE ref.customers (
    customer_sk SERIAL PRIMARY KEY, -- –°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á
    customer_id_source INT,         -- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π ID –∏–∑ CRM
    customer_name VARCHAR(255)
);
```

‚úÖ **Reference = –µ–¥–∏–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö.**

---

## **üìå 7.5 Integration Layer ‚Äì ¬´–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ —Ä–∞—Å—á–µ—Ç—ã¬ª**

üìå **–ß—Ç–æ —ç—Ç–æ?**  
Integration Layer ‚Äì —ç—Ç–æ **—Å–ª–æ–π –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞—Å—á–µ—Ç–æ–≤**.  
üí° **–ó–¥–µ—Å—å –¥–∞–Ω–Ω—ã–µ —É–∂–µ –≥–æ—Ç–æ–≤—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞, –Ω–æ –µ—â–µ –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏.**

üìä **–ü—Ä–∏–Ω—Ü–∏–ø—ã Integration Layer:**

- **–û–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.**
- **–§–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏).**
- **–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Ä–∞—Å—á–µ—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.**

üìå **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Integration-—Å–ª–æ—è**

```sql
CREATE TABLE integration.sales_summary AS
SELECT
    c.customer_sk,
    s.product_id,
    SUM(s.amount) AS total_spent
FROM ods.sales s
JOIN ref.customers c ON s.customer_id = c.customer_id_source
GROUP BY c.customer_sk, s.product_id;
```

‚úÖ **Integration = —Ä–∞—Å—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤.**

---

## **üìå 7.6 DDS Layer ‚Äì ¬´–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ¬ª**

üìå **–ß—Ç–æ —ç—Ç–æ?**  
DDS (Detailed Data Store) ‚Äì —ç—Ç–æ **–∫–ª—é—á–µ–≤–æ–π —Å–ª–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö**.  
üí° **–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç ODS, DDS —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –≤–µ—Ä—Å–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö.**

üìä **–ü—Ä–∏–Ω—Ü–∏–ø—ã DDS Layer:**

- **–ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É**.
- **–î–∞–Ω–Ω—ã–µ –∏–º–µ—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ (SCD Type 2 ‚Äì Slowly Changing Dimensions).**
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.**

üìå **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã DDS-—Å–ª–æ—è**

```sql
CREATE TABLE dds.sales_history (
    id SERIAL PRIMARY KEY,
    customer_sk INT,
    product_id INT,
    amount DECIMAL(10,2),
    status VARCHAR(50),
    valid_from TIMESTAMP,
    valid_to TIMESTAMP
);
```

‚úÖ **DDS = –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π.**

---

## **üìå 7.7 Data Marts ‚Äì ¬´–í–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö¬ª**

üìå **–ß—Ç–æ —ç—Ç–æ?**  
Data Mart ‚Äì —ç—Ç–æ **—Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–ª–æ–π –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º–∏ –∏ BI-—Å–∏—Å—Ç–µ–º–∞–º–∏**.  
üí° **–ó–¥–µ—Å—å –¥–∞–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –¥–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏.**

üìä **–ü—Ä–∏–Ω—Ü–∏–ø—ã Data Mart:**

- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**.
- **–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã—Ä—É—á–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º).**
- **–î–∞–Ω–Ω—ã–µ –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã (–∑–≤–µ–∑–¥–Ω–∞—è —Å—Ö–µ–º–∞).**

üìå **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Data Mart:**

```sql
CREATE TABLE datamart.sales_report AS
SELECT
    d.date,
    p.category,
    SUM(s.amount) AS revenue
FROM dds.sales_history s
JOIN ref.products p ON s.product_id = p.product_id
JOIN ref.date d ON s.valid_from = d.date
GROUP BY d.date, p.category;
```

‚úÖ **Data Mart = –æ—Ç—á–µ—Ç—ã –¥–ª—è BI (Power BI, Tableau, Looker).**

---

## **üìå 7.8 –ò—Ç–æ–≥–∏**

üéØ **DWH –ø–æ –ò–Ω–º–∞–Ω—É –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–æ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤:**  
‚úÖ **Staging** ‚Äì —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ.  
‚úÖ **ODS** ‚Äì –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏.  
‚úÖ **Reference** ‚Äì –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤.  
‚úÖ **Integration** ‚Äì –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ —Ä–∞—Å—á–µ—Ç—ã.  
‚úÖ **DDS** ‚Äì —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.  
‚úÖ **Data Marts** ‚Äì —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤.