# Зачем нужна историчность данных?
- **Проблема перезаписи данных в источнике**: в операционной базе изменения часто вносят путём прямого обновления строк (старое значение затирается новым). История при этом **не сохраняется**.
- **Необходимость исторических записей в DWH**: в хранилище важно уметь отслеживать каждое «предыдущее» состояние. Иначе в аналитических отчётах будут искажённые результаты (например, если фильм на диске поменяли, а финансовые показатели привязаны к старому названию).

## Пример с фильмами на компакт-дисках
1. **Исходная ситуация**  
   - В таблице `inventory` (инвентарь) может быть запись: «Компакт-диск №1 содержит Фильм A».  
   - Соответствующие факты (прокаты, платежи) привязаны к этой записи.
2. **Изменение данных в источнике**  
   - Если на том же диске №1 переписали Фильм B вместо Фильма A, то в источнике просто обновится поле «film_id» (старый ID затирается).  
   - При построении отчёта без историчности будет казаться, что все прокаты относятся к Фильму B, даже если они фактически были по Фильму A ранее.
3. **Сохранение истории в DWH**  
   - Чтобы разделить периоды, когда диск был под Фильмом A и когда под Фильмом B, вводится отдельная логика:  
     - Первая запись (диск с Фильмом A) закрывается датой окончания актуальности.  
     - Создаётся вторая запись (диск с Фильмом B) с новой датой начала актуальности.  
   - При запросах (например, «Доход по Фильму A за предыдущий год») хранилище сможет корректно учитывать два разных периода для одного и того же диска.

## Ключевые моменты
- **SCD (Slow Changing Dimensions)**: это подход, позволяющий отслеживать изменения атрибутов в измерениях с течением времени.  
- **Отличие от обычного обновления**: вместо простой перезаписи старая строка в DWH не стирается, а **«закрывается»** (заполняется дата окончания), а новая версия записывается с новой датой начала.  
- **Практическая польза**: корректная историзация обеспечивает консистентную аналитику: мы видим, какой объект (диск) в какой период был связан с каким значением (фильм, рейтинг и т.д.).

## Итог
- Историчность в измерениях позволяет решать проблему «затирания» данных в операционной системе.  
- Пример с заменой фильма на одном компакт-диске наглядно демонстрирует, почему важно отслеживать «старые» и «новые» версии.  
- Следующим шагом станет рассмотрение того, **как** технически реализовать исторические изменения (SCD2) на примере `dim_inventory`.
