### Пересказ второй логической части: **Теоретическая часть: историчность измерений**

В этой части занятия подробно обсуждается концепция **историчности измерений** и её важность для хранилищ данных. Основная идея заключается в том, что данные в источниках могут изменяться, и эти изменения необходимо учитывать в хранилище для корректного анализа и отчетности.

#### Пример с фильмами на компакт-дисках
Рассматривается пример с компакт-дисками, на которых записаны фильмы. В базе данных источника может быть таблица **INVENTORY**, где каждый компакт-диск имеет уникальный идентификатор и записанный на нём фильм. Однако, если на один и тот же диск записывают новый фильм, старая информация о предыдущем фильме может быть перезаписана. В хранилище данных необходимо сохранить историю изменений, чтобы учитывать, какие фильмы были на диске в разные периоды времени.

Пример:
- На диске с идентификатором **1** сначала был записан фильм **"Kong House"**.
- Позже этот диск перезаписали, и на нём появился фильм **"Adventure"**.
- В хранилище данных нужно сохранить обе записи: одну для периода, когда на диске был фильм **"Kong House"**, и другую для периода с фильмом **"Adventure"**.

#### Проблема перезаписи данных в источниках
В источниках данных (например, операционных базах данных) изменения часто происходят путём перезаписи старых значений новыми. Это означает, что историчность данных в источниках может быть утеряна. Однако в хранилище данных историчность часто необходима для бизнеса, особенно если нужно строить отчёты, учитывающие изменения данных с течением времени.

#### Реализация историчности в хранилище данных
Для реализации историчности в хранилище данных используется подход **Slow Changing Dimension (SCD)**. В данном занятии рассматривается **SCD Type 2**, который предполагает добавление новых строк в измерение при изменении данных, с указанием периодов актуальности каждой строки.

##### Основные шаги реализации SCD Type 2:
1. **Добавление полей для историчности**:
   - **Effective Date From** — дата, с которой запись стала актуальной.
   - **Effective Date To** — дата, по которую запись была актуальной.
   - **Is Active** — флаг, указывающий, актуальна ли запись на текущий момент.

2. **Обработка изменений**:
   - При изменении данных в источнике (например, перезапись фильма на диске) в хранилище добавляется новая строка с обновлёнными данными.
   - У старой строки обновляется поле **Effective Date To**, указывающее, до какого момента она была актуальной.
   - Новая строка получает поле **Effective Date From**, равное дате изменения, и поле **Effective Date To**, равное "бесконечности" (например, 9999-12-31).

3. **Привязка фактов к измерениям**:
   - При загрузке фактов (например, фактов сдачи в аренду) необходимо учитывать, к какой строке измерения они относятся, исходя из даты факта и периодов актуальности строк измерения.

#### Пример с датами актуальности
- **Старая запись**:
  - **Effective Date From**: 1900-01-01
  - **Effective Date To**: 2022-08-10 10:00
  - **Is Active**: False
- **Новая запись**:
  - **Effective Date From**: 2022-08-10 10:00
  - **Effective Date To**: 9999-12-31
  - **Is Active**: True

Если факт сдачи в аренду произошёл до 10 августа 2022 года, он будет привязан к старой записи. Если после — к новой.

---

Эта часть занятия закладывает теоретическую основу для практической реализации историчности в измерении **DIM_INVENTORY**, которая будет рассмотрена в следующей части. Если готовы, перейдем к **Практической части: реализация историчности в измерении DIM_INVENTORY**. Дайте знать!