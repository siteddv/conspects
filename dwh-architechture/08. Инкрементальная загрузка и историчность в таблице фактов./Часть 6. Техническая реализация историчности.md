### **6.1. –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏ –∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏**

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏ –∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –±—ã–ª–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ **—Å–µ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤**, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---

### **6.2. –¢–µ—Å—Ç 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

**–°—Ü–µ–Ω–∞—Ä–∏–π:**

1. **–î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—á–Ω–∏–∫ (`staging.rental`) –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å:**

```sql
INSERT INTO staging.rental (rental_id, film_id, rental_date, return_date, last_update)
VALUES (200, 15, '2024-09-07 12:00:00', NULL, CURRENT_TIMESTAMP);
```

2. **–í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:**

```sql
CALL LoadRentals(CURRENT_TIMESTAMP);
```

3. **–ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—è–≤–∏–ª–∞—Å—å –ª–∏ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å –≤ `core.rental`:**

```sql
SELECT * FROM core.rental WHERE rental_id = 200;
```

üìå **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

- –ó–∞–ø–∏—Å—å **–ø–æ—è–≤–∏–ª–∞—Å—å –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**
- `is_active = TRUE`
- `valid_from` = –º–æ–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏
- `valid_to = '9999-12-31'` (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)

‚úÖ **–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω. –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.**

---

### **6.3. –¢–µ—Å—Ç 2: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ**

**–°—Ü–µ–Ω–∞—Ä–∏–π:**

1. **–ú–µ–Ω—è–µ–º –¥–∞—Ç—É –≤–æ–∑–≤—Ä–∞—Ç–∞ —É —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä–µ–Ω–¥—ã:**

```sql
UPDATE staging.rental
SET return_date = '2024-09-08 15:00:00', last_update = CURRENT_TIMESTAMP
WHERE rental_id = 200;
```

2. **–í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:**

```sql
CALL LoadRentals(CURRENT_TIMESTAMP);
```

3. **–ü—Ä–æ–≤–µ—Ä—è–µ–º `core.rental`, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–≤–µ –≤–µ—Ä—Å–∏–∏ –∑–∞–ø–∏—Å–∏:**

```sql
SELECT * FROM core.rental WHERE rental_id = 200;
```

üìå **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

|rental_id|film_id|rental_date|return_date|is_active|valid_from|valid_to|
|---|---|---|---|---|---|---|
|200|15|2024-09-07 12:00:00|NULL|FALSE|2024-09-07 12:00:00|2024-09-08 15:00:00|
|200|15|2024-09-07 12:00:00|2024-09-08 15:00:00|TRUE|2024-09-08 15:00:00|9999-12-31 00:00:00|

‚úÖ **–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω. –°—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–æ, –∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.**

---

### **6.4. –¢–µ—Å—Ç 3: –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ**

**–°—Ü–µ–Ω–∞—Ä–∏–π:**

1. **–ü–æ–º–µ—á–∞–µ–º –∑–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–Ω–æ–π –≤ `staging.rental`**

```sql
UPDATE staging.rental
SET deleted = CURRENT_TIMESTAMP
WHERE rental_id = 200;
```

2. **–ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:**

```sql
CALL LoadRentals(CURRENT_TIMESTAMP);
```

3. **–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–∞–ø–∏—Å—å –≤ `core.rental` —Å—Ç–∞–ª–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π:**

```sql
SELECT * FROM core.rental WHERE rental_id = 200;
```

üìå **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

|rental_id|film_id|rental_date|return_date|is_active|valid_from|valid_to|
|---|---|---|---|---|---|---|
|200|15|2024-09-07 12:00:00|2024-09-08 15:00:00|FALSE|2024-09-08 15:00:00|2024-09-09 10:00:00|

‚úÖ **–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω. –ó–∞–ø–∏—Å—å –Ω–µ —É–¥–∞–ª–µ–Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏, –Ω–æ —Ç–µ–ø–µ—Ä—å –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ `is_active = FALSE`.**

---

### **6.5. –¢–µ—Å—Ç 4: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (Full Load)**

**–°—Ü–µ–Ω–∞—Ä–∏–π:**

1. –í—ã–ø–æ–ª–Ω—è–µ–º **–ø–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É —Ö—Ä–∞–Ω–∏–ª–∏—â–∞** –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞–Ω–æ–≤–æ:

```sql
CALL FullLoad();
```

2. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ **–≤—Å–µ –∑–∞–ø–∏—Å–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞**.

‚úÖ **–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω. –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å –¥–∞–∂–µ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.**

---

### **6.6. –ò—Ç–æ–≥–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

üìå **–í—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:**  
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Äì **—Ä–∞–±–æ—Ç–∞–µ—Ç**  
‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö ‚Äì **–∏—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è**  
‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Äì **–ø–æ–º–µ—Ç–∫–∞ `is_active = FALSE`, —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è**  
‚úÖ –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ ‚Äì **–∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è**

---

### **–í—ã–≤–æ–¥ –ø–æ —à–µ—Å—Ç–æ–π —á–∞—Å—Ç–∏**

üöÄ **–ú–µ—Ö–∞–Ω–∏–∑–º –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤**  
üöÄ **–¢–µ–ø–µ—Ä—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**  
üöÄ **–î–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–∂–µ –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ**