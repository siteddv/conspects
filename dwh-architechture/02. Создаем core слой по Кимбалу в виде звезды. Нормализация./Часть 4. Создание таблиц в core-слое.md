### **1. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã Core –≤ PostgreSQL (01:02:08 ‚Äì 01:04:03)**

üìå **–®–∞–≥ 1: –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å—Ö–µ–º—É "core"**

- –í PostgreSQL —Å–æ–∑–¥–∞–µ—Ç—Å—è **–æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ "core"** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
- –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã:
    
    ```sql
    CREATE SCHEMA core;
    ```
    
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã **–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.

üìå **–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã –≤ pgAdmin**

- –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º—ã –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –µ–µ –≤ —Å–ø–∏—Å–∫–µ **—Å—Ö–µ–º PostgreSQL**.

---

### **2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏–π (dimension tables) (01:04:03 ‚Äì 01:11:52)**

üìå **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π `dim_inventory` (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª—å–º–∞—Ö –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ)**  
**–û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è "inventory" (–∫–æ–º–ø–∞–∫—Ç-–¥–∏—Å–∫–∏ –∏ —Ñ–∏–ª—å–º—ã):**  
‚úîÔ∏è **–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á (PK):**

- `inventory_pk` ‚Äì **—Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π) –∫–ª—é—á** –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã.
- `inventory_id` ‚Äì –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–∑ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (–±–∞–∑—ã –ø—Ä–æ–∫–∞—Ç–∞).
- `film_id` ‚Äì –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ñ–∏–ª—å–º–∞.

‚úîÔ∏è **–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è:**

- `title` ‚Äì –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞ (`VARCHAR(255)`).
- `rental_duration` ‚Äì –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞—Ä–µ–Ω–¥—ã (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ).
- `rental_rate` ‚Äì —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞—Ä–µ–Ω–¥—ã (`NUMERIC(8,2)`).
- `replacement_cost` ‚Äì —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–º–µ–Ω—ã (`NUMERIC(8,2)`).
- `rating` ‚Äì –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ (`VARCHAR(10)`).

üí° **–ü–æ—á–µ–º—É —Ö—Ä–∞–Ω–∏–º –¥–∞–Ω–Ω—ã–µ –æ —Ñ–∏–ª—å–º–µ –≤ `dim_inventory`?**

- –ß—Ç–æ–±—ã **–Ω–µ –¥–µ–ª–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Ñ–∏–ª—å–º–æ–≤** ‚Üí —É–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–µ–π.
- –í —Å—Ö–µ–º–µ "–∑–≤–µ–∑–¥–∞" **–∏–∑–º–µ—Ä–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã**.

**SQL-–∫–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã:**

```sql
CREATE TABLE core.dim_inventory (
    inventory_pk SERIAL PRIMARY KEY,
    inventory_id INT NOT NULL,
    film_id INT NOT NULL,
    title VARCHAR(255) NOT NULL,
    rental_duration INT NOT NULL,
    rental_rate NUMERIC(8,2) NOT NULL,
    replacement_cost NUMERIC(8,2) NOT NULL,
    rating VARCHAR(10) NOT NULL
);
```

üìå **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π `dim_staff` (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö)**

- –í —Ç–∞–±–ª–∏—Ü–µ `dim_staff` –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ **—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö –∏ –º–∞–≥–∞–∑–∏–Ω–∞—Ö**.
- –ü–æ–ª—è:
    - `staff_pk` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä).
    - `staff_id` (ID —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞).
    - `store_id` (ID –º–∞–≥–∞–∑–∏–Ω–∞).
    - `first_name`, `last_name` (–∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞).

üí° **–≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è ‚Äì –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –¥–æ–º–∞—à–Ω–µ–π —Ä–∞–±–æ—Ç—ã.**

---

### **3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —Ñ–∞–∫—Ç–æ–≤ (fact tables) (01:11:52 ‚Äì 01:19:04)**

üìå **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤ `fact_payment` (–æ–ø–ª–∞—Ç–∞ –∞—Ä–µ–Ω–¥—ã —Ñ–∏–ª—å–º–æ–≤)**  
**–ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∏—Ç—å?**  
‚úîÔ∏è **–ò–∑–º–µ—Ä–µ–Ω–∏—è:**

- `date_id` (–¥–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞).
- `inventory_pk` (—Å—Å—ã–ª–∫–∞ –Ω–∞ `dim_inventory`).
- `staff_pk` (—Å—Å—ã–ª–∫–∞ –Ω–∞ `dim_staff`).

‚úîÔ∏è **–§–∞–∫—Ç—ã (–º–æ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å):**

- `amount` (—Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞).
- `payment_count` (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç–µ–∂–µ–π).

**SQL-–∫–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã:**

```sql
CREATE TABLE core.fact_payment (
    payment_pk SERIAL PRIMARY KEY,
    date_id DATE NOT NULL,
    inventory_pk INT NOT NULL,
    staff_pk INT NOT NULL,
    amount NUMERIC(8,2) NOT NULL,
    payment_count INT NOT NULL,
    FOREIGN KEY (inventory_pk) REFERENCES core.dim_inventory (inventory_pk),
    FOREIGN KEY (staff_pk) REFERENCES core.dim_staff (staff_pk)
);
```

üìå **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∏ —Å —Ç–∞–±–ª–∏—Ü–µ–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (`dim_staff`)**

- –ü–æ–∫–∞ `staff_pk` –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è (—Ç–∞–∫ –∫–∞–∫ `dim_staff` –µ—â–µ –Ω–µ—Ç).
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è `dim_staff` –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á.

---

### **4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å—Ö–µ–º—ã (01:19:04 ‚Äì 01:21:16)**

üìå **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã —Å–≤—è–∑–µ–π**

- –í `pgAdmin` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ö–µ–º–∞ **"core"**.
- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è **—Å–≤—è–∑—å –º–µ–∂–¥—É `fact_payment` –∏ `dim_inventory`**.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- –¢–∞–±–ª–∏—Ü–∞ `fact_payment` —Å–≤—è–∑–∞–Ω–∞ —Å `dim_inventory`.
- `staff_pk` –ø–æ–∫–∞ –Ω–µ —Å–≤—è–∑–∞–Ω (–¥–æ–±–∞–≤–∏—Ç—Å—è –ø–æ–∑–∂–µ).
- –ù–∞—á–∏–Ω–∞–µ—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å—Å—è **—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–≤–µ–∑–¥—ã**.

---

### **–ò—Ç–æ–≥–∏ —á–µ—Ç–≤–µ—Ä—Ç–æ–π —á–∞—Å—Ç–∏**

‚úÖ **–°–æ–∑–¥–∞–ª–∏ —Å—Ö–µ–º—É "core"** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.  
‚úÖ **–°–æ–∑–¥–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—É –∏–∑–º–µ—Ä–µ–Ω–∏–π `dim_inventory`** (—Ñ–∏–ª—å–º—ã –∏ –¥–∏—Å–∫–∏).  
‚úÖ **–°–æ–∑–¥–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—É —Ñ–∞–∫—Ç–æ–≤ `fact_payment`** (–ø–ª–∞—Ç–µ–∂–∏).  
‚úÖ **–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ —Å—Ö–µ–º—É "–∑–≤–µ–∑–¥–∞"** —Å —Ñ–∞–∫—Ç–∞–º–∏ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏.  
‚úÖ **–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ:**

- –°–æ–∑–¥–∞—Ç—å `dim_staff` (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö).
- –°–æ–∑–¥–∞—Ç—å `fact_rental` (—Ñ–∞–∫—Ç—ã –∞—Ä–µ–Ω–¥—ã —Ñ–∏–ª—å–º–æ–≤).