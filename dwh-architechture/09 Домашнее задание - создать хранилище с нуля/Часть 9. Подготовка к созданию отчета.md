### **1. –¶–µ–ª—å –æ—Ç—á–µ—Ç–∞ –∏ –µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**

–ê–≤—Ç–æ—Ä –æ–±—ä—è—Å–Ω—è–µ—Ç, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ –æ—Ç—á–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∏ –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ–Ω –¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å.

üìå **–¶–µ–ª—å –æ—Ç—á–µ—Ç–∞:**

- –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ª–µ—Ç–æ–≤** –∏–∑ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ **–ø–æ –¥–∞—Ç–∞–º**.
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞–º** –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–∞–º** (—á—Ç–æ–±—ã –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–Ω–¥—ã –∏ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å).

üìä **–§–æ—Ä–º–∞—Ç –æ—Ç—á–µ—Ç–∞:**

|–ê—ç—Ä–æ–ø–æ—Ä—Ç|–ì–æ—Ä–æ–¥|01.01.2024|02.01.2024|03.01.2024|...|
|---|---|---|---|---|---|
|–®–µ—Ä–µ–º–µ—Ç—å–µ–≤–æ|–ú–æ—Å–∫–≤–∞|125|143|118|...|
|–í–Ω—É–∫–æ–≤–æ|–ú–æ—Å–∫–≤–∞|78|82|75|...|
|–î–æ–º–æ–¥–µ–¥–æ–≤–æ|–ú–æ—Å–∫–≤–∞|90|105|112|...|

üîπ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á–µ—Ç–∞:**

- **–°—Ç—Ä–æ–∫–∏:** –ê—ç—Ä–æ–ø–æ—Ä—Ç—ã (`dim_airports`).
- **–°—Ç–æ–ª–±—Ü—ã:** –î–∞—Ç—ã (`dim_date`).
- **–ó–Ω–∞—á–µ–Ω–∏—è:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ª–µ—Ç–æ–≤ (`COUNT(*)` –∏–∑ `fact_flights`).

üí° **–≠—Ç–æ—Ç –æ—Ç—á–µ—Ç –ø–æ–º–æ–∂–µ—Ç –≤—ã—è–≤–∏—Ç—å —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏** ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–∞–∫–∏–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ –∏ –≤ –∫–∞–∫–∏–µ –º–µ—Å—è—Ü—ã –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ä–µ–π—Å–æ–≤.

---

### **2. –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã –¥–ª—è –æ—Ç—á–µ—Ç–∞?**

–ß—Ç–æ–±—ã –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å **–¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞**.

üìå **–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**

1. **`fact_flights`** ‚Äì –¥–∞–Ω–Ω—ã–µ –æ –≤—ã–ª–µ—Ç–∞—Ö (—Ñ–∞–∫—Ç—ã).
2. **`dim_airports`** ‚Äì —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ (–∏–∑–º–µ—Ä–µ–Ω–∏—è).
3. **`dim_date`** ‚Äì —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –¥–∞—Ç (–∏–∑–º–µ—Ä–µ–Ω–∏—è).

üìå **–ö–∞–∫–∏–µ –ø–æ–ª—è –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è?**

|–¢–∞–±–ª–∏—Ü–∞|–ü–æ–ª—è|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|---|
|`fact_flights`|`flight_id`|–£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Ä–µ–π—Å–∞.|
||`departure_airport_id`|–°—Å—ã–ª–∫–∞ –Ω–∞ `dim_airports`.|
||`date_id`|–°—Å—ã–ª–∫–∞ –Ω–∞ `dim_date`.|
|`dim_airports`|`airport_id`|–£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞.|
||`airport_name`|–ù–∞–∑–≤–∞–Ω–∏–µ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞.|
||`city`|–ì–æ—Ä–æ–¥, –≥–¥–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –∞—ç—Ä–æ–ø–æ—Ä—Ç.|
|`dim_date`|`date_id`|–£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–∞—Ç—ã.|
||`full_date`|–ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞ (`YYYY-MM-DD`).|

üí° **–ü–æ—á–µ–º—É –≤–∞–∂–Ω—ã –≤—Å–µ —Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã?**

- **`fact_flights`** —Å–æ–¥–µ—Ä–∂–∏—Ç **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ª–µ—Ç–æ–≤**.
- **`dim_airports`** –ø–æ–º–æ–≥–∞–µ—Ç **–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞–º**.
- **`dim_date`** –ø–æ–∑–≤–æ–ª—è–µ—Ç **—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç—á–µ—Ç –ø–æ –¥–∞—Ç–∞–º** (–∫–æ–ª–æ–Ω–∫–∞–º).

---

### **3. SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**

–ü–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–æ—Å–Ω–æ–≤–Ω–æ–π SQL-–∑–∞–ø—Ä–æ—Å** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

üìå **–®–∞–≥ 1: –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞–º –∏ –¥–∞—Ç–∞–º)**

```sql
SELECT 
    a.airport_name,
    a.city,
    d.full_date,
    COUNT(f.flight_id) AS num_flights
FROM fact_flights f
JOIN dim_airports a ON f.departure_airport_id = a.airport_id
JOIN dim_date d ON f.date_id = d.date_id
GROUP BY a.airport_name, a.city, d.full_date
ORDER BY a.airport_name, d.full_date;
```

üîπ **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å?**

- –°–æ–µ–¥–∏–Ω—è–µ—Ç **—Ñ–∞–∫—Ç—ã (`fact_flights`) —Å –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏ (`dim_airports` –∏ `dim_date`)**.
- **–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ** –ø–æ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞–º –∏ –¥–∞—Ç–∞–º.
- **–°—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–π—Å–æ–≤** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞ –≤ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.

üìå **–®–∞–≥ 2: –ü–æ–≤–æ—Ä–æ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç –æ—Ç—á–µ—Ç–∞**  
–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å **—Ñ–æ—Ä–º–∞—Ç –æ—Ç—á–µ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏ –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö**, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `crosstab()`.

```sql
SELECT * FROM crosstab(
    'SELECT a.airport_name, a.city, d.full_date, COUNT(f.flight_id)
     FROM fact_flights f
     JOIN dim_airports a ON f.departure_airport_id = a.airport_id
     JOIN dim_date d ON f.date_id = d.date_id
     GROUP BY a.airport_name, a.city, d.full_date
     ORDER BY a.airport_name, d.full_date',
    'SELECT DISTINCT full_date FROM dim_date ORDER BY full_date'
) 
AS pivot_table (
    airport_name TEXT,
    city TEXT,
    "2024-01-01" INT,
    "2024-01-02" INT,
    "2024-01-03" INT,
    "2024-01-04" INT
);
```

üîπ **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å?**

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `crosstab()` –¥–ª—è **—Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ –¥–∞—Ç –≤ —Å—Ç–æ–ª–±—Ü—ã**.
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç **—Å–ø–∏—Å–æ–∫ –¥–∞—Ç** –∏–∑ `dim_date`.
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–π—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞ –ø–æ –¥–Ω—è–º**.

üí° **–≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –≤ —Ç–æ–º –∂–µ –≤–∏–¥–µ, –∫–∞–∫ –≤ Excel –∏–ª–∏ BI-—Å–∏—Å—Ç–µ–º–∞—Ö.**

---

### **4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞**

–ê–≤—Ç–æ—Ä –æ–±—Å—É–∂–¥–∞–µ—Ç, **–∫–∞–∫ —É—Å–∫–æ—Ä–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞**, –µ—Å–ª–∏ –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö –±–æ–ª—å—à–æ–π.

üìå **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–µ–º—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**

1. **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã**

```sql
CREATE INDEX idx_fact_flights_date ON fact_flights(date_id);
CREATE INDEX idx_fact_flights_airport ON fact_flights(departure_airport_id);
```

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (materialized views)**

```sql
CREATE MATERIALIZED VIEW airport_flights_summary AS
SELECT 
    departure_airport_id,
    date_id,
    COUNT(flight_id) AS num_flights
FROM fact_flights
GROUP BY departure_airport_id, date_id;
```

3. **–ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã**

- BI-—Å–∏—Å—Ç–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Power BI) –º–æ–≥—É—Ç –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å **—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–∞**.

üí° **–≠—Ç–∏ –º–µ—Ç–æ–¥—ã –ø–æ–º–æ–≥–∞—é—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –±—ã—Å—Ç—Ä–µ–µ** –∏ –¥–µ–ª–∞—é—Ç –æ—Ç—á–µ—Ç –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º.

---

### **5. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ BI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É (Power BI, Tableau, Metabase)**

–ê–≤—Ç–æ—Ä —É–ø–æ–º–∏–Ω–∞–µ—Ç, —á—Ç–æ –æ—Ç—á–µ—Ç –º–æ–∂–Ω–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤ **BI-—Å–∏—Å—Ç–µ–º–∞—Ö**.

üìå **–®–∞–≥–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è PostgreSQL –∫ Power BI:**

1. **–û—Ç–∫—Ä—ã—Ç—å Power BI** ‚Üí –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ‚Üí PostgreSQL.
2. **–£–∫–∞–∑–∞—Ç—å —Å–µ—Ä–≤–µ—Ä (`localhost` –∏–ª–∏ IP), –±–∞–∑—É (`DWH`), –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å.**
3. –í—ã–±—Ä–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã (`fact_flights`, `dim_airports`, `dim_date`).
4. –°–æ–∑–¥–∞—Ç—å **—Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É** —Å `airport_name` –≤ —Å—Ç—Ä–æ–∫–∞—Ö –∏ `full_date` –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö.
5. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å **–≥—Ä–∞—Ñ–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–π—Å–æ–≤ –ø–æ –¥–Ω—è–º**.

üí° **–≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –ø–æ–¥–∫–ª—é—á–∏–≤ BI-—Å–∏—Å—Ç–µ–º—É –∫ PostgreSQL.**

---

### **–í—ã–≤–æ–¥ –¥–µ–≤—è—Ç–æ–π –ª–æ–≥–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏**

- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á–µ—Ç–∞:** —Å—Ç—Ä–æ–∫–∏ ‚Äì –∞—ç—Ä–æ–ø–æ—Ä—Ç—ã, —Å—Ç–æ–ª–±—Ü—ã ‚Äì –¥–∞—Ç—ã, –∑–Ω–∞—á–µ–Ω–∏—è ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ª–µ—Ç–æ–≤.
- **–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã:** `fact_flights`, `dim_airports`, `dim_date`.
- **–°–æ–∑–¥–∞–Ω SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö –ø–æ–≤–æ—Ä–æ—Ç–∞ (`crosstab()`).**
- **–î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.**
- **BI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (Power BI, Tableau) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞.**