## üéØ **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã –±–ª–æ–∫–∞**

üîπ **–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –≤–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã–º–∏?**  
üîπ **–ö–∞–∫–∏–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏?**  
üîπ **–ö–∞–∫ —É–¥–∞–ª—è—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–æ–≤—ã—Ö?**  
üîπ **–ö–∞–∫ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ?**  
üîπ **–ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ?**

---

## üèó **–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –≤–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã–º–∏?**

üéØ **–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏—Ç—Ä–∏–Ω—ã?**  
1Ô∏è‚É£ **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã –≤ –æ—Ç—á–µ—Ç–µ** (–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏, —Ñ–∏–ª—å—Ç—Ä—ã, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞).  
2Ô∏è‚É£ **–í—ã–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–ª–æ—è DDS** ‚Äì –∏–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü —Å –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å—é.  
3Ô∏è‚É£ **–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–æ–≤—ã—Ö** ‚Äì –µ—Å–ª–∏ –≤–∏—Ç—Ä–∏–Ω–∞ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é.  
4Ô∏è‚É£ **–ó–∞–ø—É—Å—Ç–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π**.  
5Ô∏è‚É£ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏**, —á—Ç–æ–±—ã –æ–Ω —Ä–∞–±–æ—Ç–∞–ª –±—ã—Å—Ç—Ä–æ.

‚úÖ **–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–≤—É—Ö —Ç–∏–ø–æ–≤:**

- **–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å (Full Load)** ‚Äì —É–¥–∞–ª—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –∑–∞–Ω–æ–≤–æ –∑–∞–≥—Ä—É–∂–∞–µ–º.
- **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (Incremental Load)** ‚Äì –∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

üìå **–í—ã–≤–æ–¥:**  
‚úÖ –ü–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å **—Ç–∏–ø –≤–∏—Ç—Ä–∏–Ω—ã** –∏ **–∫–∞–∫ –æ–Ω–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è**.

---

## üìå **–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–æ–≤—ã—Ö**

üéØ **–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?**

- –ï—Å–ª–∏ –≤ –≤–∏—Ç—Ä–∏–Ω–µ –æ—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ, –º–æ–≥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è **–¥—É–±–ª–∏**.
- –ï—Å–ª–∏ –º—ã –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –º–æ–∂–µ—Ç –±—ã—Ç—å **—Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö**.

‚úÖ **SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π**

```sql
DELETE FROM report.sales_by_date;
```

üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å?**

- –ü–æ–ª–Ω–æ—Å—Ç—å—é **–æ—á–∏—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –≤–∏—Ç—Ä–∏–Ω—ã**, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å —Ç—É–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –º—ã **–ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –≤–∏—Ç—Ä–∏–Ω—É —Ü–µ–ª–∏–∫–æ–º**.

‚ö†Ô∏è **–ö–æ–≥–¥–∞ –Ω–µ –Ω—É–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ?**

- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**, —É–¥–∞–ª—è—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ **–Ω–µ –Ω—É–∂–Ω–æ** ‚Äì —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏.

üìå **–í—ã–≤–æ–¥:**  
‚úÖ **–ü–µ—Ä–µ–¥ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –≤–∏—Ç—Ä–∏–Ω—ã —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –ª—É—á—à–µ —É–¥–∞–ª—è—Ç—å**.

---

## üìå **SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∏—Ç—Ä–∏–Ω—ã**

üéØ **–ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞–µ–º –≤ –≤–∏—Ç—Ä–∏–Ω—É "–ü—Ä–æ–¥–∞–∂–∏ –ø–æ –¥–Ω—è–º"?**

- –î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏ (sales_date).
- –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –∑–∞ –¥–µ–Ω—å (amount).

‚úÖ **SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–Ω—è–º**

```sql
INSERT INTO report.sales_by_date (sales_date, amount)
SELECT 
    c.date_actual AS sales_date,
    SUM(p.amount) AS amount
FROM dds.payment p
JOIN report.calendar c ON p.payment_date::date = c.date_actual
WHERE p.deleted_at IS NULL
GROUP BY c.date_actual;
```

üìå **–†–∞–∑–±–æ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

- –ë–µ—Ä–µ–º **–¥–∞—Ç—ã –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –¥–∞—Ç** (`calendar`).
- –ë–µ—Ä–µ–º **–ø–ª–∞—Ç–µ–∂–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã DDS** (`dds.payment`).
- –§–∏–ª—å—Ç—Ä—É–µ–º **—Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏** (`p.deleted_at IS NULL`).
- **–ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ**, —á—Ç–æ–±—ã –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É –ø—Ä–æ–¥–∞–∂ –∑–∞ –¥–µ–Ω—å.

üìå **–í—ã–≤–æ–¥:**  
‚úÖ **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–∏—Ç—Ä–∏–Ω—ã –Ω—É–∂–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ–±—ã –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –ª–∏—à–Ω—é—é –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é.**

---

## üìå **–ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏—Ç—Ä–∏–Ω–∞—Ö?**

üéØ **–ü—Ä–æ–±–ª–µ–º–∞:**

- –ï—Å–ª–∏ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ø–ª–∞—Ç–µ–∂ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã, –¥–∞–Ω–Ω—ã–µ **–¥—É–±–ª–∏—Ä—É—é—Ç—Å—è**.
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ **–Ω–µ–≤–µ—Ä–Ω—ã–º —Ä–∞—Å—á–µ—Ç–∞–º** –≤ –æ—Ç—á–µ—Ç–∞—Ö.

‚úÖ **–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–∏—Ç—å **—Ñ–∏–ª—å—Ç—Ä –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (`deleted_at IS NULL`)**.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **UNIQUE-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ** –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª—è—Ö.
- –ü—Ä–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ **–æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏**.

üìå **–í—ã–≤–æ–¥:**  
‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.**

---

## üîë **–í—ã–≤–æ–¥**

‚úÖ –ü–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤–∏—Ç—Ä–∏–Ω—ã –Ω—É–∂–Ω–æ **—É–¥–∞–ª—è—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ Full Load)**.  
‚úÖ –î–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ **—Å–ª–æ—è DDS**, –≥–¥–µ –æ–Ω–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –∏—Å—Ç–æ—Ä–∏—á–Ω—ã.  
‚úÖ –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏—Ç—Ä–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **JOIN'—ã —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º –∏ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏**.  
‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (`deleted_at IS NULL`) –ø–æ–º–æ–≥–∞–µ—Ç **–∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**.