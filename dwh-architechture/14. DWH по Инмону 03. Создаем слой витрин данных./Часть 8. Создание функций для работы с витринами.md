## üéØ **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã –±–ª–æ–∫–∞**

üîπ **–ß—Ç–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: —Ö—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏?**  
üîπ **–ö–∞–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–º–æ–≥–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–∏—Ç—Ä–∏–Ω–∞–º–∏?**  
üîπ **–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å SQL-—Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–∏—Ç—Ä–∏–Ω–æ–π?**  
üîπ **–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ —Ñ—É–Ω–∫—Ü–∏—é?**

---

## ‚ùì **–ß—Ç–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: —Ö—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏?**

‚úÖ **–§—É–Ω–∫—Ü–∏–∏**

- –í—Å–µ–≥–¥–∞ **–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ**.
- –ú–æ–≥—É—Ç **–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ SELECT-–∑–∞–ø—Ä–æ—Å–∞—Ö**.
- –£–¥–æ–±–Ω—ã –¥–ª—è **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á–µ—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π**.
- –ë—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –Ω–æ **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**.

‚úÖ **–•—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã**

- –ú–æ–≥—É—Ç **–Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–∞–Ω–Ω—ã—Ö**, –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω—è—è –æ–ø–µ—Ä–∞—Ü–∏–∏.
- –ù–µ–ª—å–∑—è **–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ SELECT**, –Ω—É–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ `CALL`.
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–¥–ª—è —Å–ª–æ–∂–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏**.

üìå **–ß—Ç–æ –≤—ã–±—Ä–∞—Ç—å –¥–ª—è –≤–∏—Ç—Ä–∏–Ω?**  
‚úÖ **–§—É–Ω–∫—Ü–∏–∏ –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–∏—Ç—Ä–∏–Ω**.  
‚úÖ **–ü—Ä–æ—Ü–µ–¥—É—Ä—ã —É–¥–æ–±–Ω—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏—Ç—Ä–∏–Ω—ã**.

---

## üèó **–ö–∞–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–º–æ–≥–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–∏—Ç—Ä–∏–Ω–∞–º–∏?**

üéØ **–ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∏—Ç—Ä–∏–Ω?**

- –ü–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—É—á–∞—Ç—å **–≥–æ—Ç–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö SQL-–∑–∞–ø—Ä–æ—Å–æ–≤**.
- –ú–æ–∂–Ω–æ **–ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç)**.
- –ü–æ–∑–≤–æ–ª—è—é—Ç **—Å–∫—Ä—ã—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –±–∞–∑—ã**.

üéØ **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –≤ DWH?**

- –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç **SELECT-–∑–∞–ø—Ä–æ—Å –∫ –≤–∏—Ç—Ä–∏–Ω–µ**.
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å **—Ñ–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É**.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø **—Ç–æ–ª—å–∫–æ –∫ —Ñ—É–Ω–∫—Ü–∏–∏**, –∞ –Ω–µ –∫ –≤–∏—Ç—Ä–∏–Ω–µ –Ω–∞–ø—Ä—è–º—É—é.

üìå **–í—ã–≤–æ–¥:**  
‚úÖ **–§—É–Ω–∫—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –≥–∏–±–∫–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–∏—Ç—Ä–∏–Ω–∞–º–∏, –¥–æ–±–∞–≤–ª—è—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é.**

---

## üìå **–ü—Ä–∏–º–µ—Ä SQL-—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–∏—Ç—Ä–∏–Ω–æ–π**

üéØ **–ó–∞–¥–∞—á–∞:**

- –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–¥–∞–Ω–Ω—ã–µ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º –ø–æ –¥–Ω—è–º**.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ **–ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –¥–∞—Ç**.

‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

```sql
CREATE OR REPLACE FUNCTION report.get_sales_by_date(start_date DATE, end_date DATE)
RETURNS TABLE (sales_date DATE, amount FLOAT) AS
$$
BEGIN
    RETURN QUERY
    SELECT sales_date, amount
    FROM report.sales_by_date
    WHERE sales_date BETWEEN start_date AND end_date
    ORDER BY sales_date;
END;
$$ LANGUAGE plpgsql;
```

üìå **–†–∞–∑–±–æ—Ä –∫–æ–¥–∞:**

- –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç **–¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞**: `start_date` –∏ `end_date`.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å **–¥–≤—É–º—è –ø–æ–ª—è–º–∏**: –¥–∞—Ç–∞ –∏ —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `RETURN QUERY`, —á—Ç–æ–±—ã **–≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç SELECT-–∑–∞–ø—Ä–æ—Å–∞**.
- –î–æ–±–∞–≤–ª–µ–Ω–∞ **—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ**.

‚úÖ **–ö–∞–∫ –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é?**

```sql
SELECT * FROM report.get_sales_by_date('2023-01-01', '2023-01-31');
```

üìå **–ß—Ç–æ –≤–µ—Ä–Ω—ë—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å?**

- –î–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö **—Å 1 –ø–æ 31 —è–Ω–≤–∞—Ä—è 2023 –≥–æ–¥–∞**.

üìå **–í—ã–≤–æ–¥:**  
‚úÖ –§—É–Ω–∫—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å **–≥–æ—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –¥–∞—Ç** –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö SQL-–∑–∞–ø—Ä–æ—Å–æ–≤.

---

## üìå **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ —Ñ—É–Ω–∫—Ü–∏—é**

üéØ **–î–æ–ø—É—Å—Ç–∏–º, –Ω–∞–º –Ω—É–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ –¥–∞—Ç–∞–º, –Ω–æ –∏ –ø–æ —Ç–∏–ø—É –ø—Ä–æ–¥—É–∫—Ç–∞.**  
‚úÖ **–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –¥–æ–±–∞–≤–ª—è—è —Ñ–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ñ–∏–ª—å–º–∞:**

```sql
CREATE OR REPLACE FUNCTION report.get_sales_by_film(start_date DATE, end_date DATE, film_name TEXT)
RETURNS TABLE (sales_date DATE, film_title TEXT, amount FLOAT) AS
$$
BEGIN
    RETURN QUERY
    SELECT s.sales_date, f.film_title, SUM(s.amount)
    FROM report.sales_by_date s
    JOIN dds.film f ON s.film_id = f.film_id
    WHERE s.sales_date BETWEEN start_date AND end_date
      AND f.film_title = film_name
    GROUP BY s.sales_date, f.film_title
    ORDER BY s.sales_date;
END;
$$ LANGUAGE plpgsql;
```

üìå **–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?**

- –î–æ–±–∞–≤–ª–µ–Ω **—Ç—Ä–µ—Ç–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä (`film_name`)**.
- –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–¥–∞–∂–∏ **–ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ñ–∏–ª—å–º—É**.

‚úÖ **–ö–∞–∫ –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é?**

```sql
SELECT * FROM report.get_sales_by_film('2023-01-01', '2023-01-31', '–ò–Ω—Ç–µ—Ä—Å—Ç–µ–ª–ª–∞—Ä');
```

üìå **–ß—Ç–æ –≤–µ—Ä–Ω—ë—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å?**

- –î–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö —Ñ–∏–ª—å–º–∞ **"–ò–Ω—Ç–µ—Ä—Å—Ç–µ–ª–ª–∞—Ä"** –∑–∞ —è–Ω–≤–∞—Ä—å 2023 –≥–æ–¥–∞.

üìå **–í—ã–≤–æ–¥:**  
‚úÖ **–§—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã, –¥–µ–ª–∞—è –æ—Ç—á–µ—Ç—ã –±–æ–ª–µ–µ –≥–∏–±–∫–∏–º–∏.**

---

## üîë **–í—ã–≤–æ–¥**

‚úÖ **–§—É–Ω–∫—Ü–∏–∏ —É–¥–æ–±–Ω—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–∏—Ç—Ä–∏–Ω —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π.**  
‚úÖ **–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∞ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äì –¥–ª—è –≤—ã–±–æ—Ä–∫–∏.**  
‚úÖ **–§—É–Ω–∫—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∞—Ç—ã, –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∏–ª—å–º–æ–≤).**  
‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π —É–ø—Ä–æ—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –∏ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤.**