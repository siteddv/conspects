### **1. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö (SCD - Slowly Changing Dimensions)** _(1:22:50 - 1:30:30)_

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞–ø–∏—Å–µ–π, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –¥–∏–Ω–∞–º–∏–∫–µ.

üìå **–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö:**

- **SCD Type 1 (–∑–∞–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏).**
- **SCD Type 2 (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π –∑–∞–ø–∏—Å–µ–π —Å –¥–∞—Ç–∞–º–∏ –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏).**
- **SCD Type 3 (—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∏ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ).**

üëâ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SCD Type 2 –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è BI-–∞–Ω–∞–ª–∏–∑–∞.**

---

### **2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π** _(1:30:30 - 1:38:15)_

‚ö° **–ó–∞–¥–∞—á–∞:** –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ?

‚úÖ **–†–µ—à–µ–Ω–∏–µ: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ö–µ—à–µ–π**

- –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Å–æ–∑–¥–∞–µ–º **MD5/SHA-—Ö–µ—à** –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤.
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–æ–≤—ã–π —Ö–µ—à —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.

üîπ **–ü—Ä–∏–º–µ—Ä —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –≤ ClickHouse:**

```sql
SELECT md5(concat(toString(product_id), category, price, description)) AS row_hash
FROM raw_data.products;
```

‚úÖ **–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ DWH —Å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º:**  
1Ô∏è‚É£ **–°—á–∏—Ç–∞–µ–º —Ö–µ—à–∏ —É –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å DDS.**  
2Ô∏è‚É£ **–ï—Å–ª–∏ —Ö–µ—à–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Äì –∑–∞–ø–∏—Å—å –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º.**  
3Ô∏è‚É£ **–ï—Å–ª–∏ —Ö–µ—à–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è ‚Äì —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –∑–∞–ø–∏—Å–∏.**

---

### **3. –†–∞–±–æ—Ç–∞ —Å —É–¥–∞–ª–µ–Ω–∏—è–º–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∏ –≤—Å—Ç–∞–≤–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ DDS** _(1:38:15 - 1:45:20)_

üìå **–ö–∞–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ?**

### **3.1. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —É–¥–∞–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö?**

‚úÖ **–ü–æ–º–µ—á–∞–µ–º —Å—Ç—Ä–æ–∫–∏ –∫–∞–∫ —É–¥–∞–ª–µ–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è.**

- –≠—Ç–æ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.
- –î–æ–±–∞–≤–ª—è–µ–º —Ñ–ª–∞–≥ `is_deleted = 1`.

üîπ **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–º–µ—Ç–∫–∏ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫:**

```sql
UPDATE dds.products
SET is_deleted = 1
WHERE product_id NOT IN (SELECT product_id FROM raw_data.products);
```

---

### **3.2. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –¥–∞–Ω–Ω—ã—Ö?**

‚úÖ **–°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ö–µ—à–∏ —Ç–µ–∫—É—â–∏—Ö –∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.**  
‚úÖ **–ï—Å–ª–∏ —Ö–µ—à –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Äì –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –∑–∞–ø–∏—Å–∏.**

üîπ **–ü—Ä–∏–º–µ—Ä –≤—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –∑–∞–ø–∏—Å–∏ –≤ DDS:**

```sql
INSERT INTO dds.products (product_id, category, price, description, version_start, version_end, is_deleted)
SELECT p.product_id, p.category, p.price, p.description, now(), '9999-12-31', 0
FROM raw_data.products p
LEFT JOIN dds.products d ON p.product_id = d.product_id
WHERE md5(concat(toString(p.product_id), p.category, p.price, p.description)) 
   != md5(concat(toString(d.product_id), d.category, d.price, d.description));
```

‚úÖ **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ —É —Å—Ç–∞—Ä–æ–π –∑–∞–ø–∏—Å–∏.**

```sql
UPDATE dds.products
SET version_end = now()
WHERE product_id IN (SELECT product_id FROM raw_data.products)
AND version_end = '9999-12-31';
```

---

### **4. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å—é** _(1:45:20 - 1:50:00)_

üìå **–ö–∞–∫ —É—Å–∫–æ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π?**

‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤.**  
‚úÖ **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è).**  
‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä.**

üí° **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ Airflow –∏–ª–∏ dbt:**

- **–ò—Å–ø–æ–ª—å–∑—É–µ–º DAG-–∏ –≤ Airflow** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ ETL.
- **–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—É–º–º—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏.**

üîπ **–ü—Ä–∏–º–µ—Ä DAG –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Airflow (Python):**

```python
from airflow import DAG
from airflow.operators.python_operator import PythonOperator
from datetime import datetime

def load_incremental():
    # SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    sql = "INSERT INTO dds.products SELECT * FROM raw_data.products WHERE updated_at >= now() - INTERVAL 1 DAY"
    execute_sql(sql)

with DAG('incremental_load', start_date=datetime(2024, 1, 1), schedule_interval='@daily') as dag:
    task = PythonOperator(task_id='load_incremental', python_callable=load_incremental)
```

---

### **5. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤** _(1:50:00 - 2:00:00)_

üìå **–†–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**  
‚úÖ **–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–∏–º–∞ –≤ BI –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ.**  
‚úÖ **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –≤ –Ø–Ω–¥–µ–∫—Å –ú–µ—Ç—Ä–∏–∫–µ, Google Analytics.**  
‚úÖ **–í –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö DWH —Ç–∞–∫–∞—è —Å—Ö–µ–º–∞ —É–ø—Ä–æ—â–∞–µ—Ç –∞—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π.**

üí° **–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ:**  
1Ô∏è‚É£ **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –≤ DDS.**  
2Ô∏è‚É£ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ.**  
3Ô∏è‚É£ **–°–æ–∑–¥–∞—Ç—å SQL-—Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å—é.**