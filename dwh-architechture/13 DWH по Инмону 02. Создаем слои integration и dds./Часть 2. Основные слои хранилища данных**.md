## **üîπ 1. –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö (01:14 ‚Äì 05:30)**

üìå –í –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ **–ò–Ω–º–æ–Ω–∞** —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (DWH) —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Å–ª–æ—ë–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —Ñ—É–Ω–∫—Ü–∏—é.

### **üìå –ì–ª–∞–≤–Ω—ã–µ —Å–ª–æ–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö:**

1Ô∏è‚É£ **Stage Layer (–°–ª–æ–π —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö)**  
2Ô∏è‚É£ **Integration Layer (–°–ª–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)**  
3Ô∏è‚É£ **Detail Data Store (DDS, –°–ª–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö)**  
4Ô∏è‚É£ **Data Marts (–í–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö)**

üîπ –í —ç—Ç–æ–º –∑–∞–Ω—è—Ç–∏–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è **–ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ —Å–ª–æ—è**, –ø–æ—Å–∫–æ–ª—å–∫—É –≤–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö –±—É–¥—É—Ç –∏–∑—É—á–∞—Ç—å—Å—è –ø–æ–∑–∂–µ.

---

## **üîπ 2. –°–ª–æ–π —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Stage Layer)**

üìå **–ó–∞–¥–∞—á–∏ —ç—Ç–æ–≥–æ —Å–ª–æ—è:**  
‚úî –ü—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö –∏–∑ **—Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** (–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Ñ–∞–π–ª—ã, API).  
‚úî –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ **–Ω–µ–∏–∑–º–µ–Ω—ë–Ω–Ω–æ–º –≤–∏–¥–µ** (–±–µ–∑ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π).  
‚úî –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ **–∂—É—Ä–Ω–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è** (–ª–æ–≥ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π).

üìå **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –î–∞–Ω–Ω—ã–µ **–∫–æ–ø–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π** ‚Äì –æ–Ω–∏ –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è –∏ –Ω–µ –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ Integration Layer.
- –û–±—ã—á–Ω–æ —Ö—Ä–∞–Ω–∏—Ç **–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–Ω–µ–π –¥–æ –ø–∞—Ä—ã –Ω–µ–¥–µ–ª—å).

üîπ **–ü—Ä–∏–º–µ—Ä:**  
üîπ –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ‚Üí Stage Layer

- **CRM-—Å–∏—Å—Ç–µ–º–∞:** –≤—ã–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö.
- **ERP-—Å–∏—Å—Ç–µ–º–∞:** –ø–µ—Ä–µ–¥–∞—ë—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–∫–∞–∑–∞—Ö.
- **–õ–æ–≥-—Ñ–∞–π–ª—ã:** —Ö—Ä–∞–Ω—è—Ç —Å–æ–±—ã—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã.

üìå **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

- –í —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –°–£–ë–î (PostgreSQL, MS SQL) ‚Äî –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã**.
- –í —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö DWH (ClickHouse, BigQuery) ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ **—Å—Ç–µ–π–¥–∂–∏–Ω–≥-—Å–ª–æ–∏**.

---

## **üîπ 3. –°–ª–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (Integration Layer)**

üìå **–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:**  
–î–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ **–æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è, –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –∏ –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ –µ–¥–∏–Ω–æ–º—É –≤–∏–¥—É**.

üìå **–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:**  
‚úî **–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö** ‚Äì —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫.  
‚úî **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∞–º.  
‚úî **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** ‚Äì —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.  
‚úî **–û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** ‚Äì –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤.  
‚úî **–ò—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** ‚Äì —Ñ–∏–∫—Å–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (SCD-–º–µ—Ç–æ–¥—ã).

üìå **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –î–∞–Ω–Ω—ã–µ –∑–¥–µ—Å—å —É–∂–µ **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã**.
- –û–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è **–≤ 3NF (—Ç—Ä–µ—Ç—å–µ–π –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ)**.
- –≠—Ç–æ—Ç —Å–ª–æ–π –º–æ–∂–µ—Ç –±—ã—Ç—å **—Ç—è–∂–µ–ª–æ–≤–µ—Å–Ω—ã–º**, —Ç–∞–∫ –∫–∞–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.

üìå **–ü—Ä–∏–º–µ—Ä:**  
**–ó–∞–¥–∞—á–∞:** –°–æ–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö –∏–∑ CRM –∏ ERP-—Å–∏—Å—Ç–µ–º.

|customer_id|name|phone|email|registration_date|source|
|---|---|---|---|---|---|
|101|–ò–≤–∞–Ω|+79991112233|[ivan@mail.com](mailto:ivan@mail.com)|2023-01-10|CRM|
|102|–û–ª—å–≥–∞|NULL|[olga@company.com](mailto:olga@company.com)|2023-02-15|ERP|
|103|–ü—ë—Ç—Ä|+79223334455|[petrov@gmail.com](mailto:petrov@gmail.com)|2023-03-01|CRM|

üìå **–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**

- –î—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª—è—é—Ç—Å—è.
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ø–æ–ª–Ω—è—é—Ç—Å—è.
- –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ –µ–¥–∏–Ω–æ–º—É –≤–∏–¥—É.

---

## **üîπ 4. –°–ª–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (DDS ‚Äì Detail Data Store)**

üìå **–ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?**  
DDS ‚Äì —ç—Ç–æ **—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –≤ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ.

üìå **–ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç Integration Layer?**

- **Integration Layer** —Å–æ–¥–µ—Ä–∂–∏—Ç **—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (1 –≤–µ—Ä—Å–∏—è –æ–±—ä–µ–∫—Ç–∞).
- **DDS** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç **–≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π** –≤ —Ñ–æ—Ä–º–∞—Ç–µ SCD (Slowly Changing Dimensions).

üìå **–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:**  
‚úî –•—Ä–∞–Ω–µ–Ω–∏–µ **–ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏** –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö.  
‚úî –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **—Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–∏–∫ SCD**.  
‚úî –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º –¥–∞–Ω–Ω—ã–º.

üìå **–ú–µ—Ç–æ–¥—ã –∏—Å—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (SCD):**  
1Ô∏è‚É£ **SCD Type 1** ‚Äì –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏.  
2Ô∏è‚É£ **SCD Type 2** ‚Äì —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π –≤–µ—Ä—Å–∏–∏ –∑–∞–ø–∏—Å–∏ —Å –¥–∞—Ç–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏—è.  
3Ô∏è‚É£ **SCD Type 3** ‚Äì —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ–ª–µ.

üìå **–ü—Ä–∏–º–µ—Ä SCD Type 2:**

|customer_id|name|phone|email|valid_from|valid_to|is_active|
|---|---|---|---|---|---|---|
|101|–ò–≤–∞–Ω|+79991112233|[ivan@mail.com](mailto:ivan@mail.com)|2023-01-10|2023-06-30|FALSE|
|101|–ò–≤–∞–Ω|+79994445566|[ivan@mail.com](mailto:ivan@mail.com)|2023-07-01|NULL|TRUE|

üìå **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- **–í—Å—è –∏—Å—Ç–æ—Ä–∏—è –∑–∞–ø–∏—Å–µ–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** (–Ω–µ—Ç —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö).
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–¥–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ —Å—Ç—Ä–æ–∫** (`valid_from` –∏ `valid_to`).
- –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å –≤—Å–µ–≥–¥–∞ –∏–º–µ–µ—Ç `valid_to = NULL`.

---

## **üîπ 5. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞**

|–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞|Stage Layer|Integration Layer|Detail Data Store (DDS)|
|---|---|---|---|
|**–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**|‚ùå –ù–µ—Ç|‚úÖ –î–∞|‚úÖ –î–∞|
|**–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**|‚ùå –ù–µ—Ç|‚úÖ –î–∞ (3NF)|‚úÖ –î–∞ (3NF)|
|**–ò—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å**|‚ùå –ù–µ—Ç|‚ùå –ù–µ—Ç|‚úÖ –î–∞ (SCD)|
|**–£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**|‚úÖ –î–∞ (—á–µ—Ä–µ–∑ N –¥–Ω–µ–π)|‚úÖ –î–∞ (—Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏)|‚ùå –ù–µ—Ç (–≤—Å—è –∏—Å—Ç–æ—Ä–∏—è)|
|**–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å**|–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ|–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö|–î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ|

---

## **üîπ 6. –ò—Ç–æ–≥–∏ —á–∞—Å—Ç–∏**

üéØ **–ì–ª–∞–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:**  
‚úî **Stage Layer** ‚Äì —Ö—Ä–∞–Ω–∏—Ç —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç.  
‚úî **Integration Layer** ‚Äì –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ.  
‚úî **DDS (Detail Data Store)** ‚Äì —Ö—Ä–∞–Ω–∏—Ç –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.