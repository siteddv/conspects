## **üîπ –û–±–∑–æ—Ä —Å–ª–æ–µ–≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö**

üìå –í —ç—Ç–æ–π —á–∞—Å—Ç–∏ –∑–∞–Ω—è—Ç–∏—è **—Ä–∞–∑–±–∏—Ä–∞—é—Ç—Å—è –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–∏** —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö, –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

---

### **üìå 1. –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö**

–í –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ **–ò–Ω–º–æ–Ω–∞** (Inmon) —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö **–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Å–ª–æ–µ–≤**:

1Ô∏è‚É£ **Staging Layer (–°–ª–æ–π —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö)** ‚Äì –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.  
2Ô∏è‚É£ **ODS (Operational Data Store, –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö)** ‚Äì –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ª–æ–π –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö.  
3Ô∏è‚É£ **Reference Layer (–°–ø—Ä–∞–≤–æ—á–Ω—ã–π —Å–ª–æ–π)** ‚Äì —Ö—Ä–∞–Ω–∏—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã.  
4Ô∏è‚É£ **Integration Layer (–°–ª–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)** ‚Äì –æ—á–∏—â–µ–Ω–Ω—ã–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏ –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.  
5Ô∏è‚É£ **DDS (Detail Data Store, –°–ª–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏)** ‚Äì –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Slowly Changing Dimensions (SCD).

---

### **üìå 2. Staging Layer (–°–ª–æ–π —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö)**

üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**  
‚úî –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö **–∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** (–ë–î, —Ñ–∞–π–ª–æ–≤, API, –ª–æ–≥–æ–≤).  
‚úî **–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–æ–±—ã—á–Ω–æ 1-7 –¥–Ω–µ–π).  
‚úî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤ **Integration Layer**.

üìå **–ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:**

- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ **–∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ**, –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π.
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã** –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ö–µ–º—ã –≤ –ë–î.
- –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è **–ø–æ–ª–Ω–æ—Ç–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö**.

üìå **–ü—Ä–∏–º–µ—Ä:**  
–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ‚Üí Staging Layer

- **CRM:** –≤—ã–≥—Ä—É–∂–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤.
- **ERP:** –≤—ã–≥—Ä—É–∂–∞–µ—Ç –∑–∞–∫–∞–∑—ã.
- **–õ–æ–≥-—Ñ–∞–π–ª—ã:** —Ö—Ä–∞–Ω—è—Ç –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

### **üìå 3. ODS (Operational Data Store, –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö)**

üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**  
‚úî **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ª–æ–π**, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ **–±–µ–∑ –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏**.  
‚úî –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å **–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É**.  
‚úî –í ODS –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–∞–Ω–Ω—ã—Ö** (–±–µ–∑ –¥—É–±–ª–µ–π).

üìå **–ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:**

- –î–∞–Ω–Ω—ã–µ **–æ—á–∏—â–∞—é—Ç—Å—è –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è**.
- **–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏**, —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç **—É—Å–∫–æ—Ä–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã**, –Ω–µ –Ω–∞–≥—Ä—É–∂–∞—è –æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.

üìå **–ü—Ä–∏–º–µ—Ä:**

|customer_id|name|phone|email|last_update|
|---|---|---|---|---|
|101|–ò–≤–∞–Ω|+79991112233|[ivan@mail.com](mailto:ivan@mail.com)|2024-02-01|
|102|–û–ª—å–≥–∞|+79221113344|[olga@mail.com](mailto:olga@mail.com)|2024-02-01|

---

### **üìå 4. Reference Layer (–°–ø—Ä–∞–≤–æ—á–Ω—ã–π —Å–ª–æ–π)**

üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**  
‚úî –•—Ä–∞–Ω–µ–Ω–∏–µ **—Å–ø—Ä–∞–≤–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ä–µ–≥–∏–æ–Ω—ã, —Å—Ç—Ä–∞–Ω—ã, –∫–æ–¥—ã).  
‚úî –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ **–µ–¥–∏–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏** –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö.  
‚úî –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö** –≤ Integration Layer.

üìå **–ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:**

- –í —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞—Ö –¥–∞–Ω–Ω—ã–µ **–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è**.
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–∫–æ–¥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** (ID) –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π.
- –ü—Ä–∏–º–µ—Ä: —Å–ø–∏—Å–æ–∫ **–∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤**, **—Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω**, **–∫—É—Ä—Å—ã –≤–∞–ª—é—Ç**.

üìå **–ü—Ä–∏–º–µ—Ä:**

|category_id|category_name|parent_category_id|
|---|---|---|
|1|–ë—É–ª–æ—á–∫–∞|2|
|2|–ö–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∏–µ –∏–∑–¥–µ–ª–∏—è|3|
|3|–•–ª–µ–±–æ–±—É–ª–æ—á–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è|NULL|

---

### **üìå 5. Integration Layer (–°–ª–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)**

üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**  
‚úî –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö **–∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** –≤ –µ–¥–∏–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É.  
‚úî **–û—á–∏—Å—Ç–∫–∞, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**.  
‚úî –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ **3–ù–§ (—Ç—Ä–µ—Ç—å–µ–π –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ)**.  
‚úî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ DDS.

üìå **–ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:**

- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **—Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏** –≤–º–µ—Å—Ç–æ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö.
- –î–∞–Ω–Ω—ã–µ **—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ**.
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **SCD Type 1** (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏).

üìå **–ü—Ä–∏–º–µ—Ä:**

|integration_id|customer_id|name|phone|email|registration_date|
|---|---|---|---|---|---|
|1|101|–ò–≤–∞–Ω|+79991112233|[ivan@mail.com](mailto:ivan@mail.com)|2023-01-10|
|2|102|–û–ª—å–≥–∞|+79221113344|[olga@mail.com](mailto:olga@mail.com)|2023-02-15|

---

### **üìå 6. DDS (Detail Data Store, –°–ª–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏)**

üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**  
‚úî –•—Ä–∞–Ω–µ–Ω–∏–µ **–ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö**.  
‚úî –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **–º–µ—Ç–æ–¥–æ–≤ SCD** (Slowly Changing Dimensions).  
‚úî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è **–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**.

üìå **–ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:**

- –í—Å—è –∏—Å—Ç–æ—Ä–∏—è **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö**.
- –î–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∞—é—Ç **–¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏** (`valid_from`, `valid_to`).
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **SCD Type 2** (—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö).

üìå **–ü—Ä–∏–º–µ—Ä SCD Type 2:**

|customer_id|name|phone|email|valid_from|valid_to|is_active|
|---|---|---|---|---|---|---|
|101|–ò–≤–∞–Ω|+79991112233|[ivan@mail.com](mailto:ivan@mail.com)|2023-01-10|2023-06-30|FALSE|
|101|–ò–≤–∞–Ω|+79994445566|[ivan@mail.com](mailto:ivan@mail.com)|2023-07-01|NULL|TRUE|

---

### **üìå 7. –ò—Ç–æ–≥–∏ —á–∞—Å—Ç–∏**

üéØ **–ì–ª–∞–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:**  
‚úî **Staging Layer** ‚Äì —Ö—Ä–∞–Ω–∏—Ç —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ.  
‚úî **ODS** ‚Äì –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –±–µ–∑ –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏.  
‚úî **Reference Layer** ‚Äì —Å–ø—Ä–∞–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã.  
‚úî **Integration Layer** ‚Äì –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–µ –∫ 3–ù–§.  
‚úî **DDS** ‚Äì –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å, SCD Type 2, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.