### **1. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —É–¥–∞–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö** _(2:00:00 - 2:07:30)_

üìå **–£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ DWH –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ª–æ–≥–∏—á–µ—Å–∫–∏–º, –∞ –Ω–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º.**

‚úÖ **–ü–æ—á–µ–º—É –Ω–µ —É–¥–∞–ª—è–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–∏?**

- –ü–æ—Ç–µ—Ä—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –û—à–∏–±–∫–∏ –≤ –æ—Ç—á–µ—Ç–∞—Ö –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

‚úÖ **–ö–∞–∫ –ø–æ–º–µ—á–∞–µ–º —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏?**

- –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ `is_deleted` (1 ‚Äî —É–¥–∞–ª–µ–Ω–æ, 0 ‚Äî –∞–∫—Ç–∏–≤–Ω–æ).
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ (`version_end`).

üîπ **SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–º–µ—Ç–∫–∏ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –≤ DDS:**

```sql
UPDATE dds.products
SET is_deleted = 1, version_end = now()
WHERE product_id NOT IN (SELECT product_id FROM raw_data.products);
```

---

### **2. –†–∞–±–æ—Ç–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ö–µ—à–µ–π** _(2:07:30 - 2:15:45)_

üìå **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏–∏ (MD5/SHA-256).**

‚úÖ **–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã:**  
1Ô∏è‚É£ **–í—ã—á–∏—Å–ª—è–µ–º —Ö–µ—à–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å DDS.**  
2Ô∏è‚É£ **–ï—Å–ª–∏ —Ö–µ—à–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è ‚Äî —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –∑–∞–ø–∏—Å–∏.**  
3Ô∏è‚É£ **–û–±–Ω–æ–≤–ª—è–µ–º `version_end` —É —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏.**

üîπ **SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ö–µ—à–µ–π –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:**

```sql
UPDATE dds.products
SET version_end = now()
WHERE product_id IN (SELECT product_id FROM raw_data.products)
AND version_end = '9999-12-31'
AND md5(concat(toString(category), toString(price), description)) 
    != (SELECT md5(concat(toString(category), toString(price), description)) 
        FROM raw_data.products WHERE dds.products.product_id = raw_data.products.product_id);
```

---

### **3. –í—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫ —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏** _(2:15:45 - 2:25:00)_

üìå **–ù–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ –∑–∞–ø–∏—Å–µ–π –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å `version_start = now()` –∏ `version_end = '9999-12-31'`.**

‚úÖ **–ü—Ä–æ—Ü–µ—Å—Å –≤—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**  
1Ô∏è‚É£ –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ DDS.  
2Ô∏è‚É£ –í—Å—Ç–∞–≤–ª—è–µ–º –∏—Ö —Å –Ω–∞—á–∞–ª—å–Ω–æ–π –¥–∞—Ç–æ–π –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏.

üîπ **SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ DDS:**

```sql
INSERT INTO dds.products (product_id, category, price, description, version_start, version_end, is_deleted)
SELECT product_id, category, price, description, now(), '9999-12-31', 0
FROM raw_data.products p
LEFT JOIN dds.products d ON p.product_id = d.product_id
WHERE d.product_id IS NULL;
```

---

### **4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π** _(2:25:00 - 2:30:00)_

üìå **–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö?**  
‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫  
‚úÖ –ù–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–µ–π –±–µ–∑ `version_end`  
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ñ–ª–∞–≥–∞ `is_deleted`

üîπ **SQL –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö:**

```sql
SELECT COUNT(*) AS errors FROM dds.products WHERE version_start IS NULL OR version_end IS NULL;
```