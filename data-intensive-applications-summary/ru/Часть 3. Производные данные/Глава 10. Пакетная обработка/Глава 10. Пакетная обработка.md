# Глава 10. Пакетная обработка

В настоящей главе мы рассмотрели тему пакетной обработки. Мы начали с изучения инструментов Unix, таких как awk, grep и sort, и увидели, как философия этих инструментов переносится в MapReduce и более современные системы потоковой обработки данных.

## Основные темы главы

### Философия Unix и пакетная обработка

Пакетная обработка — очень старая форма вычислений. MapReduce необыкновенно похожа на электромеханические перфокартные машины IBM, которые широко применялись для обработки бизнес-данных в 1940-х и 1950-х годах.

Основные принципы проектирования:
- Входные данные неизменяемы
- Выходные предназначены служить входными для другой (пока неизвестной) программы
- Для решения сложных задач создаются небольшие инструменты, которые «хорошо делают что-то одно»

### MapReduce и распределенные файловые системы

Модель программирования MapReduce подобна инструментам Unix, но распространяется на много компьютеров — потенциально на тысячи. Задача MapReduce принимает один или несколько потоков ввода и производит один или несколько потоков вывода. Вместо использования стандартного ввода и вывода, задачи MapReduce читают и записывают файлы в распределенной файловой системе (HDFS).

### За пределами MapReduce

MapReduce — это всего лишь одна из многих возможных моделей программирования распределенных систем. Для устранения проблем с MapReduce было разработано несколько новых механизмов: Spark, Tez и Flink. Эти подсистемы потока данных рассматривают весь рабочий процесс как одну задачу, без разделения на независимые подзадачи.

## Две основные проблемы распределенных систем пакетной обработки

### Секционирование

В MapReduce функции сопоставления размещаются в секциях в соответствии с входными файловыми блоками. Выходные данные переупорядочиваются, сортируются и объединяются в разделы сжатия. Цель этого процесса — разместить все связанные данные, например все записи с одинаковым ключом, в одной секции.

### Отказоустойчивость

MapReduce часто записывает данные на диск, что упрощает восстановление после неудачно совершенной операции без повторного выполнения всей задачи, но замедляет выполнение при отсутствии сбоев. Системы потоковой обработки данных реже используют материализацию промежуточных состояний и держат больше данных в памяти.

## Алгоритмы объединения

Мы обсудили несколько алгоритмов объединения в MapReduce:
- Объединение с сортировкой слияния
- Широковещательное объединение по хешу
- Секционированные хеш-объединения

## Модель программирования

Распределенные системы пакетной обработки имеют преднамеренно ограниченную модель программирования: функции обратного вызова (сопоставления и сжатия) считаются не меняющими состояния и не имеющими внешних видимых побочных эффектов, кроме генерируемых ими выходных данных. Это ограничение позволяет системе скрыть некоторые проблемы жестких распределенных систем за абстракцией.

## Подтемы главы

- [[10.1. Пакетная обработка средствами Unix]] — изучение инструментов Unix и философии, лежащей в основе пакетной обработки
- [[10.2. MapReduce и распределенные файловые системы]] — модель программирования MapReduce, распределенные файловые системы и выполнение задач
- [[10.3. За пределами MapReduce]] — альтернативы MapReduce, подсистемы потока данных, графы и итеративная обработка, API высокого уровня
- [[10.4. Резюме]] — краткое резюме основных тем главы

