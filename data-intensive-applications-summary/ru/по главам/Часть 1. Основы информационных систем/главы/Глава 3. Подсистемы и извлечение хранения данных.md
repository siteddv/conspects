# Глава 3. Подсистемы и извлечение хранения данных

Две ключевые задачи БД: сохранение данных и их поиск. Две категории подсистем: OLTP (транзакции) и OLAP (аналитика).

## [[3.1. Базовые структуры данных БД]] [3.1. Базовые структуры данных БД](../../../полный/Часть 1. Основы информационных систем/Глава 3. Подсистемы и извлечение хранения данных/подтемы/3.1. Базовые структуры данных БД.md)

Индексы ускоряют чтение, но замедляют запись. **Хеш-индексы:** хеш-карта в памяти указывает на смещения в файле. Сегментация журнала и уплотнение решают проблему исчерпания места. Ограничения: требуется память для всей карты, неэффективны для запросов по диапазону.

**SS-таблицы и LSM-деревья:** данные упорядочены по ключам. Эффективное объединение сегментов, разреженный индекс в памяти. MemTable в памяти → запись в SS-таблицу при превышении порога. Фоновое уплотнение объединяет сегменты. Используется в LevelDB, RocksDB, Cassandra, HBase.

**B-деревья:** фиксированные страницы (обычно 4 КБ), иерархия страниц. Глубина O(log n), обычно 3-4 уровня. WAL для надежности, защелки для конкурентного доступа. Улучшения: копирование при записи, сокращенные ключи, дополнительные указатели.

**Сравнение:** B-деревья быстрее при чтении, LSM-деревья — при записи (меньше усиление записи, лучше сжатие). LSM-деревья могут влиять на производительность из-за уплотнения.

**Другие индексы:** вторичные индексы (неуникальные ключи), кластеризованные индексы (строки в индексе), составные индексы, многомерные индексы (R-деревья для геоданных), полнотекстовый поиск (Lucene).

**In-memory БД:** исключают накладные расходы дисковых систем, обеспечивают высокую производительность. Redis, VoltDB, Oracle TimesTen.

## [[3.2. Обработка транзакций или аналитика?]] [3.2. Обработка транзакций или аналитика?](3.2. Обработка транзакций или аналитика?.md)

**OLTP vs OLAP:** OLTP — поиск небольшого количества записей по ключу, низкая задержка. OLAP — анализ больших объемов, агрегирование, сводные статистики.

**Склады данных:** отдельные БД с копиями данных из OLTP-систем. ETL (извлечение, преобразование, загрузка). Схема «звезда»: таблица фактов в центре, окружена таблицами измерений.

## [[3.3. Столбцовое хранилище]] [3.3. Столбцовое хранилище](../../../полный/Часть 1. Основы информационных систем/Глава 3. Подсистемы и извлечение хранения данных/подтемы/3.3. Столбцовое хранилище.md)

Данные хранятся по столбцам, а не по строкам. Чтение только необходимых столбцов ускоряет запросы. **Сжатие:** битовые карты для повторяющихся значений, эффективны для запросов WHERE. Векторизованная обработка повышает эффективность CPU.

**Сортировка:** порядок строк оптимизируется под частые запросы. Улучшает сжатие. LSM-деревья решают проблему записи: данные в памяти → объединение и запись на диск.

**Материализованные представления:** сохраняют результаты запросов на диске, ускоряют агрегирование. OLAP-кубы организуют сводные показатели по измерениям, но менее гибки, чем запросы к исходным данным.

## [[3.4. Резюме]] [3.4. Резюме](../../../полный/Часть 1. Основы информационных систем/Глава 3. Подсистемы и извлечение хранения данных/подтемы/3.4. Резюме.md)

OLTP-системы: журналированный подход (LSM-деревья) или обновление на месте (B-деревья). OLAP-системы: столбцовое хранилище для эффективной аналитики. Знание внутреннего устройства помогает выбирать инструменты и настраивать БД.

---

**Подробнее:** [[Глава 3. Подсистемы и извлечение хранения данных]] [Глава 3. Подсистемы и извлечение хранения данных](Глава 3. Подсистемы и извлечение хранения данных.md)

